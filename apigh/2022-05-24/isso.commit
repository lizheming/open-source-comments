{
  "sha": "89024deb5ac488b3b299096e23ce22da7c6983cd",
  "node_id": "C_kwDOAF-mA9oAKDg5MDI0ZGViNWFjNDg4YjNiMjk5MDk2ZTIzY2UyMmRhN2M2OTgzY2Q",
  "commit": {
    "author": {
      "name": "ix5",
      "email": "ix5@users.noreply.github.com",
      "date": "2022-05-24T00:12:58Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2022-05-24T00:12:58Z"
    },
    "message": "Merge pull request #880 from ix5/config-endpoint\n\n[server] Add /config endpoint",
    "tree": {
      "sha": "f29c765031cb4f1acdd90ba2966d7ce2713a6537",
      "url": "https://api.github.com/repos/posativ/isso/git/trees/f29c765031cb4f1acdd90ba2966d7ce2713a6537"
    },
    "url": "https://api.github.com/repos/posativ/isso/git/commits/89024deb5ac488b3b299096e23ce22da7c6983cd",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJijCMKCRBK7hj4Ov3rIwAA1zwIAI6qFv+PsHsxga0OsDpFl3Yq\nO3jAuMI+nTvK6P8VvtNzwtq4sYihqRb8ZJer4nWEG9Syf9mb9zZ+w8dNHnUt9UoV\nNjG5nM/NbFUaPzn5CPuyqBxrutekGcsh6tVQ115MgFX0HhGU0ybDCaO3SJdmcdrp\nyCL3JJXwqNE6EyB658MrQTbQz2yShcQlK0KajnWEEyv2pBoiqu7nS/TDDbykQdR6\nF6iZiy770eYWQFvTdZBQv50+ayh4Tl3PtcFp6t73Py3cLOcgBvqtYRTf2Jy2gUyL\n6tNeMfUfcfZChnIZkFvxiZJwKycKBrzYA8S2Cij1R00JMXThl5ODFY55nyVqKSU=\n=PFMp\n-----END PGP SIGNATURE-----\n",
      "payload": "tree f29c765031cb4f1acdd90ba2966d7ce2713a6537\nparent 53183ab6c5a8c4d50445e903bbd6dda5b073101d\nparent d0bd9a228f9f23d664f72e58a772da085b8bde8e\nauthor ix5 <ix5@users.noreply.github.com> 1653351178 +0200\ncommitter GitHub <noreply@github.com> 1653351178 +0200\n\nMerge pull request #880 from ix5/config-endpoint\n\n[server] Add /config endpoint"
    }
  },
  "url": "https://api.github.com/repos/posativ/isso/commits/89024deb5ac488b3b299096e23ce22da7c6983cd",
  "html_url": "https://github.com/posativ/isso/commit/89024deb5ac488b3b299096e23ce22da7c6983cd",
  "comments_url": "https://api.github.com/repos/posativ/isso/commits/89024deb5ac488b3b299096e23ce22da7c6983cd/comments",
  "author": {
    "login": "ix5",
    "id": 10212877,
    "node_id": "MDQ6VXNlcjEwMjEyODc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/10212877?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ix5",
    "html_url": "https://github.com/ix5",
    "followers_url": "https://api.github.com/users/ix5/followers",
    "following_url": "https://api.github.com/users/ix5/following{/other_user}",
    "gists_url": "https://api.github.com/users/ix5/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ix5/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ix5/subscriptions",
    "organizations_url": "https://api.github.com/users/ix5/orgs",
    "repos_url": "https://api.github.com/users/ix5/repos",
    "events_url": "https://api.github.com/users/ix5/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ix5/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "53183ab6c5a8c4d50445e903bbd6dda5b073101d",
      "url": "https://api.github.com/repos/posativ/isso/commits/53183ab6c5a8c4d50445e903bbd6dda5b073101d",
      "html_url": "https://github.com/posativ/isso/commit/53183ab6c5a8c4d50445e903bbd6dda5b073101d"
    },
    {
      "sha": "d0bd9a228f9f23d664f72e58a772da085b8bde8e",
      "url": "https://api.github.com/repos/posativ/isso/commits/d0bd9a228f9f23d664f72e58a772da085b8bde8e",
      "html_url": "https://github.com/posativ/isso/commit/d0bd9a228f9f23d664f72e58a772da085b8bde8e"
    }
  ],
  "stats": {
    "total": 40,
    "additions": 39,
    "deletions": 1
  },
  "files": [
    {
      "sha": "23e3453c54e02d7b0db1f507ecda74b9c0dcd548",
      "filename": ".github/workflows/python-tests.yml",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/posativ/isso/blob/89024deb5ac488b3b299096e23ce22da7c6983cd/.github%2Fworkflows%2Fpython-tests.yml",
      "raw_url": "https://github.com/posativ/isso/raw/89024deb5ac488b3b299096e23ce22da7c6983cd/.github%2Fworkflows%2Fpython-tests.yml",
      "contents_url": "https://api.github.com/repos/posativ/isso/contents/.github%2Fworkflows%2Fpython-tests.yml?ref=89024deb5ac488b3b299096e23ce22da7c6983cd",
      "patch": "@@ -15,7 +15,7 @@ on:\n       - \"setup.py\"\n       - \"setup.cfg\"\n       - \"contrib/**.py\"\n-      - \"isso/js/**.py\"\n+      - \"isso/**.py\"\n       - \".github/workflows/python-tests.yml\"\n \n jobs:"
    },
    {
      "sha": "5d1cf9634d495f3aa297e07de1a5d4d5d70ee44f",
      "filename": "CHANGES.rst",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/posativ/isso/blob/89024deb5ac488b3b299096e23ce22da7c6983cd/CHANGES.rst",
      "raw_url": "https://github.com/posativ/isso/raw/89024deb5ac488b3b299096e23ce22da7c6983cd/CHANGES.rst",
      "contents_url": "https://api.github.com/repos/posativ/isso/contents/CHANGES.rst?ref=89024deb5ac488b3b299096e23ce22da7c6983cd",
      "patch": "@@ -22,6 +22,8 @@ Changelog for Isso\n   to style comments and replies made by the page's author(s).\n - Add Ukrainian localisation (`#878`_, okawo80085)\n - Enable Turkish localisation (`#879`_, okawo80085)\n+- Add ``/config`` endpoint for fetching server configuration options that\n+  affect the client\n \n .. _Gravatar: Image requests: http://en.gravatar.com/site/implement/images/\n .. _879: https://github.com/posativ/isso/pull/879"
    },
    {
      "sha": "9e7d76eb96040587db4e45bd0cb8d3eac44dd857",
      "filename": "isso/views/comments.py",
      "status": "modified",
      "additions": 36,
      "deletions": 0,
      "changes": 36,
      "blob_url": "https://github.com/posativ/isso/blob/89024deb5ac488b3b299096e23ce22da7c6983cd/isso%2Fviews%2Fcomments.py",
      "raw_url": "https://github.com/posativ/isso/raw/89024deb5ac488b3b299096e23ce22da7c6983cd/isso%2Fviews%2Fcomments.py",
      "contents_url": "https://api.github.com/repos/posativ/isso/contents/isso%2Fviews%2Fcomments.py?ref=89024deb5ac488b3b299096e23ce22da7c6983cd",
      "patch": "@@ -107,6 +107,7 @@ class API(object):\n         ('dislike', ('POST', '/id/<int:id>/dislike')),\n         ('demo', ('GET', '/demo')),\n         ('preview', ('POST', '/preview')),\n+        ('config', ('GET', '/config')),\n         ('login', ('POST', '/login')),\n         ('admin', ('GET', '/admin'))\n     ]\n@@ -1115,6 +1116,41 @@ def preview(self, environment, request):\n \n         return JSON({'text': self.isso.render(data[\"text\"])}, 200)\n \n+    \"\"\"\n+    @api {get} /config fetch client config\n+    @apiGroup Thread\n+    @apiDescription\n+        Returns only the client configuration parameters that depend on server settings. The following settings are sent as a `config` object from the server to the client:\n+\n+            reply-to-self\n+            require-author\n+            require-email\n+            reply-notifications\n+            gravatar\n+            avatar  # if gravatar==true\n+\n+    @apiSuccess {Object[]} config\n+        The client configuration object.\n+\n+    @apiExample {curl} get the client config:\n+        curl 'https://comments.example.com/config'\n+\n+    @apiSuccessExample Client config:\n+        {\n+          \"config\": {\n+            \"reply-to-self\": false,\n+            \"require-email\": false,\n+            \"require-author\": false,\n+            \"reply-notifications\": false,\n+            \"gravatar\": true\n+            \"avatar\": false\n+          }\n+        }\n+    \"\"\"\n+    def config(self, environment, request):\n+        rv = {'config': self.public_conf}\n+        return JSON(rv, 200)\n+\n     def demo(self, env, req):\n         return redirect(\n             get_current_url(env, strip_querystring=True) + '/index.html'"
    }
  ]
}
