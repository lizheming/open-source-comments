{
  "sha": "5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
  "node_id": "C_kwDOAKEu-toAKDVjMDZjZWU0NDlhMmJkYWE1MmUyZTNlZWRmODdjMzhmZWEzMmE1YTg",
  "commit": {
    "author": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2022-11-20T21:02:26Z"
    },
    "committer": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2022-11-20T21:02:26Z"
    },
    "message": "Merge v0.2022.20 into 'release'.",
    "tree": {
      "sha": "3d6b12989480db0940dfbb30aae9a3e96f0724be",
      "url": "https://api.github.com/repos/debiki/talkyard/git/trees/3d6b12989480db0940dfbb30aae9a3e96f0724be"
    },
    "url": "https://api.github.com/repos/debiki/talkyard/git/commits/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/debiki/talkyard/commits/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
  "html_url": "https://github.com/debiki/talkyard/commit/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
  "comments_url": "https://api.github.com/repos/debiki/talkyard/commits/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8/comments",
  "author": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d0cf83cc8a72ca904240a1ed2a647198bf4002cf",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/d0cf83cc8a72ca904240a1ed2a647198bf4002cf",
      "html_url": "https://github.com/debiki/talkyard/commit/d0cf83cc8a72ca904240a1ed2a647198bf4002cf"
    },
    {
      "sha": "45a1e95870200768dce09e6390fdc8aa6cfc5c53",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/45a1e95870200768dce09e6390fdc8aa6cfc5c53",
      "html_url": "https://github.com/debiki/talkyard/commit/45a1e95870200768dce09e6390fdc8aa6cfc5c53"
    }
  ],
  "stats": {
    "total": 23,
    "additions": 18,
    "deletions": 5
  },
  "files": [
    {
      "sha": "438fc7cd9f68bd0daf214139161b19b094ed9bcf",
      "filename": "appsv/server/debiki/MailerActor.scala",
      "status": "modified",
      "additions": 16,
      "deletions": 3,
      "changes": 19,
      "blob_url": "https://github.com/debiki/talkyard/blob/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8/appsv%2Fserver%2Fdebiki%2FMailerActor.scala",
      "raw_url": "https://github.com/debiki/talkyard/raw/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8/appsv%2Fserver%2Fdebiki%2FMailerActor.scala",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv%2Fserver%2Fdebiki%2FMailerActor.scala?ref=5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
      "patch": "@@ -483,6 +483,8 @@ class MailerActor(\n \n     apacheCommonsEmail.setSSLCheckServerIdentity(checkServerIdentity)\n \n+    // ----- To, from who\n+\n     apacheCommonsEmail.addTo(email.sentTo)\n \n     // The 'From:' SMTP header, e.g. \"Our Forum <our-email@example.com>\".\n@@ -494,9 +496,14 @@ class MailerActor(\n         apacheCommonsEmail.setFrom(fromAddr, fromName, \"UTF-8\")\n     }\n \n+    // ----- Email threading\n+\n     // (We generate these message ids ourselves; they don't include any weird chars.)\n-    email.smtpMsgId.foreach(id => apacheCommonsEmail.addHeader(\"Message-ID\", s\"<$id>\"))\n+    // Skip, this gets overwritten by javax.mail anyway. Fixed elsewhere: [msg_id_overwritten].\n+    // email.smtpMsgId.foreach(id => apacheCommonsEmail.addHeader(\"Message-ID\", s\"<$id>\"))\n+\n     email.inReplyToSmtpMsgId.foreach(id => apacheCommonsEmail.addHeader(\"In-Reply-To\", s\"<$id>\"))\n+\n     if (email.referencesSmtpMsgIds.nonEmpty) {\n       // There's a max header length: 998 chars, see https://www.rfc-editor.org/rfc/rfc5322\n       // from year 2008:\n@@ -512,6 +519,8 @@ class MailerActor(\n       apacheCommonsEmail.addHeader(\"References\", refSt)\n     }\n \n+    // ----- Reply and Bounce\n+\n     // The address a human (hens email client) should reply to.  This is different\n     // from the address the SMTP servers would return the email to, if there are\n     // problems: they instead return the email to the 'MAIL FROM:some@addr.ess'\n@@ -538,9 +547,13 @@ class MailerActor(\n     // the intermediate SMTP servers use their own email addresses anyway?\n     bounceAddress foreach apacheCommonsEmail.setBounceAddress\n \n+    // ----- Email contents\n+\n     apacheCommonsEmail.setSubject(email.subject)\n     apacheCommonsEmail.setHtmlMsg(email.bodyHtmlText)\n \n+    // ----- Security\n+\n     // This applies all props set above; calling more setNnn(..) below, in most cases will do nothing?\n     // (but some setNnn() still works â€“ look at the getMailSession() and buildMimeMessage() source)\n     val session = apacheCommonsEmail.getMailSession\n@@ -611,8 +624,8 @@ class SensibleHtmlEmail(val anySmtpMsgId: Opt[St]) extends acm.HtmlEmail {\n         anySmtpMsgId foreach { id =>\n           // I hope this removes all headers javax.mail might have added or overwritten:\n           removeHeader(\"Message-ID\")\n-          // And the one we want:\n-          setHeader(\"Message-ID\", id)\n+          // And the one we want: (it's generated by us; there're no weird chars like '>' or '\\n')\n+          setHeader(\"Message-ID\", s\"<$id>\")\n         }\n       }\n     }"
    },
    {
      "sha": "c454a041a8e9edae1c66d6fc4c640b7a19826450",
      "filename": "relchans/tyse-v0-dev",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/relchans%2Ftyse-v0-dev?ref=5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
      "patch": "@@ -1 +1 @@\n-Subproject commit 85b31b67ef64a74a9b572f6a71b4321169d57e4b\n+Subproject commit c454a041a8e9edae1c66d6fc4c640b7a19826450"
    },
    {
      "sha": "8d3e22630788a12bb42d0541ea9ed815ecae6cd6",
      "filename": "version.txt",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8/version.txt",
      "raw_url": "https://github.com/debiki/talkyard/raw/5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8/version.txt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/version.txt?ref=5c06cee449a2bdaa52e2e3eedf87c38fea32a5a8",
      "patch": "@@ -1 +1 @@\n-v0.2022.19\n+v0.2022.20"
    }
  ]
}
