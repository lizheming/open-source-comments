{
  "sha": "7fe536871873c911a1a5a6f006408c1579909563",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo3ZmU1MzY4NzE4NzNjOTExYTFhNWE2ZjAwNjQwOGMxNTc5OTA5NTYz",
  "commit": {
    "author": {
      "name": "Jordan Vidrine",
      "email": "30537603+jordanvidrine@users.noreply.github.com",
      "date": "2021-02-12T22:24:13Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2021-02-12T22:24:13Z"
    },
    "message": "UX: Second Factor + Alert Display (#12071)\n\n* UX: Second Factor + Alert Display\r\n\r\nThis commit removes JS edits of the modal-alert and uses CSS instead. This commit also adds some styling to the 2FA login when using a key instead of a 2FA authenticator.",
    "tree": {
      "sha": "d71f43d5fb27e3310ae02bc0f3f387eab4142cbf",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/d71f43d5fb27e3310ae02bc0f3f387eab4142cbf"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/7fe536871873c911a1a5a6f006408c1579909563",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgJwANCRBK7hj4Ov3rIwAAdHIIAHTCE22+zt/ATUOtefgeueWd\nT03R1U6PZgBb01Ovt7ujfZhrz/XdL14/VgPzHYOeTGg/ZqwDibmHrH6KiCYDgMMf\nA7oAApLszJU+WgfUArg/P4LCWxVrxHyC++VpLQQMDO4IycGeOuhr2yp7mbevUHwn\nSCqyIDjs+FMepNxbqo6CMDngsK2LrC/5wguSCDwX2iFBJGZFzGgbglFKoVNM5sVE\nFEyPkUiqBXz3tt3lAOvqbH1jR0g6yE52wnuF63rAdM+zKN5CAK+pD3qDlcrU/0L8\nusWLHXtQ4oALLT5jBLxO+HenqG+FiZ092rw/ZOZJxK6EWH3bQJhS71OKF6ZZ3yU=\n=0Tj3\n-----END PGP SIGNATURE-----\n",
      "payload": "tree d71f43d5fb27e3310ae02bc0f3f387eab4142cbf\nparent 70050a8ba365628394fbf7597daf75891328d991\nauthor Jordan Vidrine <30537603+jordanvidrine@users.noreply.github.com> 1613168653 -0600\ncommitter GitHub <noreply@github.com> 1613168653 -0600\n\nUX: Second Factor + Alert Display (#12071)\n\n* UX: Second Factor + Alert Display\r\n\r\nThis commit removes JS edits of the modal-alert and uses CSS instead. This commit also adds some styling to the 2FA login when using a key instead of a 2FA authenticator."
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/7fe536871873c911a1a5a6f006408c1579909563",
  "html_url": "https://github.com/discourse/discourse/commit/7fe536871873c911a1a5a6f006408c1579909563",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/7fe536871873c911a1a5a6f006408c1579909563/comments",
  "author": {
    "login": "jordanvidrine",
    "id": 30537603,
    "node_id": "MDQ6VXNlcjMwNTM3NjAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/30537603?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jordanvidrine",
    "html_url": "https://github.com/jordanvidrine",
    "followers_url": "https://api.github.com/users/jordanvidrine/followers",
    "following_url": "https://api.github.com/users/jordanvidrine/following{/other_user}",
    "gists_url": "https://api.github.com/users/jordanvidrine/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jordanvidrine/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jordanvidrine/subscriptions",
    "organizations_url": "https://api.github.com/users/jordanvidrine/orgs",
    "repos_url": "https://api.github.com/users/jordanvidrine/repos",
    "events_url": "https://api.github.com/users/jordanvidrine/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jordanvidrine/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "70050a8ba365628394fbf7597daf75891328d991",
      "url": "https://api.github.com/repos/discourse/discourse/commits/70050a8ba365628394fbf7597daf75891328d991",
      "html_url": "https://github.com/discourse/discourse/commit/70050a8ba365628394fbf7597daf75891328d991"
    }
  ],
  "stats": {
    "total": 36,
    "additions": 30,
    "deletions": 6
  },
  "files": [
    {
      "sha": "c175d7a647ef168b56ac5f177a14c44081ef33ca",
      "filename": "app/assets/javascripts/discourse/app/controllers/login.js",
      "status": "modified",
      "additions": 8,
      "deletions": 5,
      "changes": 13,
      "blob_url": "https://github.com/discourse/discourse/blob/7fe536871873c911a1a5a6f006408c1579909563/app/assets/javascripts/discourse/app/controllers/login.js",
      "raw_url": "https://github.com/discourse/discourse/raw/7fe536871873c911a1a5a6f006408c1579909563/app/assets/javascripts/discourse/app/controllers/login.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/app/controllers/login.js?ref=7fe536871873c911a1a5a6f006408c1579909563",
      "patch": "@@ -83,24 +83,29 @@ export default Controller.extend(ModalFunctionality, {\n     \"awaitingApproval\",\n     \"hasAtLeastOneLoginButton\",\n     \"showSecondFactor\",\n-    \"canLoginLocal\"\n+    \"canLoginLocal\",\n+    \"showSecurityKey\"\n   )\n   modalBodyClasses(\n     awaitingApproval,\n     hasAtLeastOneLoginButton,\n     showSecondFactor,\n-    canLoginLocal\n+    canLoginLocal,\n+    showSecurityKey\n   ) {\n     const classes = [\"login-modal\"];\n     if (awaitingApproval) {\n       classes.push(\"awaiting-approval\");\n     }\n-    if (hasAtLeastOneLoginButton && !showSecondFactor) {\n+    if (hasAtLeastOneLoginButton && !showSecondFactor && !showSecurityKey) {\n       classes.push(\"has-alt-auth\");\n     }\n     if (!canLoginLocal) {\n       classes.push(\"no-local-login\");\n     }\n+    if (showSecondFactor || showSecurityKey) {\n+      classes.push(\"second-factor\");\n+    }\n     return classes.join(\" \");\n   },\n \n@@ -166,8 +171,6 @@ export default Controller.extend(ModalFunctionality, {\n               (result.security_key_enabled || result.totp_enabled) &&\n               !this.secondFactorRequired\n             ) {\n-              document.getElementById(\"modal-alert\").style.display = \"none\";\n-\n               this.setProperties({\n                 otherMethodAllowed: result.multiple_second_factor_methods,\n                 secondFactorRequired: true,"
    },
    {
      "sha": "8b8cf5ace168980d771f5efb07f79cad04af43b7",
      "filename": "app/assets/stylesheets/common/base/login.scss",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/discourse/discourse/blob/7fe536871873c911a1a5a6f006408c1579909563/app/assets/stylesheets/common/base/login.scss",
      "raw_url": "https://github.com/discourse/discourse/raw/7fe536871873c911a1a5a6f006408c1579909563/app/assets/stylesheets/common/base/login.scss",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/stylesheets/common/base/login.scss?ref=7fe536871873c911a1a5a6f006408c1579909563",
      "patch": "@@ -27,6 +27,18 @@\n   }\n }\n \n+.d-modal.login-modal {\n+  #modal-alert:empty {\n+    display: none;\n+  }\n+\n+  #modal-alert:not(:empty) {\n+    display: flex;\n+    flex-direction: column;\n+    justify-content: center;\n+  }\n+}\n+\n // Create Account + Login\n .d-modal.create-account,\n .d-modal.login-modal {"
    },
    {
      "sha": "49d3654be080061bca80ffe68787a7d9fe433a56",
      "filename": "app/assets/stylesheets/desktop/login.scss",
      "status": "modified",
      "additions": 10,
      "deletions": 1,
      "changes": 11,
      "blob_url": "https://github.com/discourse/discourse/blob/7fe536871873c911a1a5a6f006408c1579909563/app/assets/stylesheets/desktop/login.scss",
      "raw_url": "https://github.com/discourse/discourse/raw/7fe536871873c911a1a5a6f006408c1579909563/app/assets/stylesheets/desktop/login.scss",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/stylesheets/desktop/login.scss?ref=7fe536871873c911a1a5a6f006408c1579909563",
      "patch": "@@ -55,7 +55,7 @@\n   #modal-alert {\n     max-width: 100%;\n     margin-bottom: 0;\n-    padding: 8px 40px 8px 16px;\n+    padding: 8px 50px 8px 16px;\n     min-height: 35px;\n   }\n \n@@ -101,6 +101,15 @@\n   }\n }\n \n+.login-modal.modal-body:not(.hidden).second-factor {\n+  .login-left-side {\n+    max-width: 350px;\n+  }\n+  .modal-footer {\n+    margin-top: 1em;\n+  }\n+}\n+\n // styles used on\n // login modal only\n .login-modal:not(.hidden) {"
    }
  ]
}
