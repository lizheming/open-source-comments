{
  "sha": "9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6OWQwMjM5MTA2MjUxYTQ0YjBkOTIxZDY3ZTk3YmNmNjBmNGY3ZmI3YQ==",
  "commit": {
    "author": {
      "name": "Wyatt Johnson",
      "email": "wyattjoh@gmail.com",
      "date": "2020-08-04T18:24:31Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-08-04T18:24:31Z"
    },
    "message": "[CORL-1239] Swap setTimeout for setLongTimeout (#3071)\n\n* fix: ensure user editable time use setLongTimeout\n\n* fix: fixed wrong type\n\n* fix: fixed snapshots\n\nCo-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>",
    "tree": {
      "sha": "f6fec0c65b4df0878a3ab7825c862d2351cbe8c0",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/f6fec0c65b4df0878a3ab7825c862d2351cbe8c0"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfKaffCRBK7hj4Ov3rIwAAdHIIAIiA3uk83Ykdq4WEAMYquvP6\n7AQQXYFh4/Xpus0jG9l90Y3fxVWR0T5nY2UQDwyjUtx+SlJL3l5/3goUXudxaxmd\n0eXXT8cG3FZoqp53lKYxOBsoatCW9KnYx7hbG26tOIDmtKjEeArNIsZxmMZOhyZP\nF4uL0HGyNoWmZM598Wghysqn42XupxiMkuVguumH7lByjT7f3BnhXi/Y7MBQxY4c\n/zvUagkVVsz1VM2yFTnZh+4FO3eTXSoxjGQ2XUlvMuusKLVtj6v0oG8L4vz4LbG4\njYadePwKmlsxWq9oIk/9dkUIJQXYEXh29tBNxtrcSyJHh3BntSMIBxr2BPPMJsk=\n=dJgg\n-----END PGP SIGNATURE-----\n",
      "payload": "tree f6fec0c65b4df0878a3ab7825c862d2351cbe8c0\nparent 8aac2d33fc1401c0a6104f7eb04538d3b7312fa9\nauthor Wyatt Johnson <wyattjoh@gmail.com> 1596565471 -0600\ncommitter GitHub <noreply@github.com> 1596565471 +0000\n\n[CORL-1239] Swap setTimeout for setLongTimeout (#3071)\n\n* fix: ensure user editable time use setLongTimeout\n\n* fix: fixed wrong type\n\n* fix: fixed snapshots\n\nCo-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
  "html_url": "https://github.com/coralproject/talk/commit/9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/comments",
  "author": {
    "login": "wyattjoh",
    "id": 633002,
    "node_id": "MDQ6VXNlcjYzMzAwMg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/633002?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wyattjoh",
    "html_url": "https://github.com/wyattjoh",
    "followers_url": "https://api.github.com/users/wyattjoh/followers",
    "following_url": "https://api.github.com/users/wyattjoh/following{/other_user}",
    "gists_url": "https://api.github.com/users/wyattjoh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wyattjoh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wyattjoh/subscriptions",
    "organizations_url": "https://api.github.com/users/wyattjoh/orgs",
    "repos_url": "https://api.github.com/users/wyattjoh/repos",
    "events_url": "https://api.github.com/users/wyattjoh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wyattjoh/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8aac2d33fc1401c0a6104f7eb04538d3b7312fa9",
      "url": "https://api.github.com/repos/coralproject/talk/commits/8aac2d33fc1401c0a6104f7eb04538d3b7312fa9",
      "html_url": "https://github.com/coralproject/talk/commit/8aac2d33fc1401c0a6104f7eb04538d3b7312fa9"
    }
  ],
  "stats": {
    "total": 115,
    "additions": 55,
    "deletions": 60
  },
  "files": [
    {
      "sha": "2fb34d770a9f5a81cac4a2047faf75742671cd41",
      "filename": "src/core/client/admin/App/DecisionHistory/__snapshots__/DecisionHistoryLoading.spec.tsx.snap",
      "status": "modified",
      "additions": 1,
      "deletions": 3,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/App/DecisionHistory/__snapshots__/DecisionHistoryLoading.spec.tsx.snap",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/App/DecisionHistory/__snapshots__/DecisionHistoryLoading.spec.tsx.snap",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/App/DecisionHistory/__snapshots__/DecisionHistoryLoading.spec.tsx.snap?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -11,9 +11,7 @@ exports[`renders correctly 1`] = `\n       className=\"DecisionHistoryLoading-container\"\n       justifyContent=\"center\"\n     >\n-      <Delay\n-        ms={500}\n-      >\n+      <Delay>\n         <withPropsOnChange(Spinner)\n           size=\"sm\"\n         />"
    },
    {
      "sha": "c66a354fa0935ef0f65d02889cfd7aa825a2715a",
      "filename": "src/core/client/admin/App/GlobalNotification/useNotification.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/App/GlobalNotification/useNotification.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/App/GlobalNotification/useNotification.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/App/GlobalNotification/useNotification.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,4 +1,5 @@\n import { useRouter } from \"found\";\n+import { setLongTimeout } from \"long-settimeout\";\n import { ReactNode, useContext } from \"react\";\n \n import { NotificationContext } from \"./GlobalNotificationContext\";\n@@ -17,7 +18,7 @@ function useNotification() {\n   const setMessage = (message: ReactNode, timeout?: number) => {\n     dispatch({ type: \"SET_MESSAGE\", message });\n     if (timeout) {\n-      setTimeout(() => {\n+      setLongTimeout(() => {\n         dispatch({ type: \"CLEAR_MESSAGE\" });\n       }, timeout);\n     }"
    },
    {
      "sha": "57981d098deb9dea788ff03e3ebf3805e175c111",
      "filename": "src/core/client/admin/routes/AuthCheck/RestrictedContainer.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/routes/AuthCheck/RestrictedContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/admin/routes/AuthCheck/RestrictedContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/AuthCheck/RestrictedContainer.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -3,7 +3,7 @@ import React, { Component } from \"react\";\n import { graphql } from \"react-relay\";\n \n import { SetRedirectPathMutation } from \"coral-admin/mutations\";\n-import { timeout } from \"coral-common/utils\";\n+import { waitFor } from \"coral-common/helpers\";\n import {\n   MutationProp,\n   withFragmentContainer,\n@@ -31,7 +31,7 @@ class RestrictedContainer extends Component<Props> {\n   private handleSignInAs = async () => {\n     await this.props.signOut();\n     // Wait for new context to propagate.\n-    await timeout();\n+    await waitFor();\n     void this.props.setRedirectPath({\n       path: location.pathname + location.search + location.hash,\n     });"
    },
    {
      "sha": "b10592836f72714a592cefffb400affcf2b34732",
      "filename": "src/core/client/stream/local/initLocalState.spec.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/local/initLocalState.spec.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/local/initLocalState.spec.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/local/initLocalState.spec.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,6 +1,6 @@\n import { Environment, RecordSource } from \"relay-runtime\";\n \n-import { timeout } from \"coral-common/utils\";\n+import { waitFor } from \"coral-common/helpers\";\n import { CoralContext } from \"coral-framework/lib/bootstrap\";\n import { LOCAL_ID } from \"coral-framework/lib/relay\";\n import { createPromisifiedStorage } from \"coral-framework/lib/storage\";\n@@ -27,7 +27,7 @@ it(\"init local state\", async () => {\n     localStorage: createPromisifiedStorage(),\n   };\n   await initLocalState(environment, context as any);\n-  await timeout();\n+  await waitFor();\n   expect(JSON.stringify(source.toJSON(), null, 2)).toMatchSnapshot();\n });\n "
    },
    {
      "sha": "c6dfcafc66ee34febcfe3b621cddf72f1f889084",
      "filename": "src/core/client/stream/mutations/SetCommentIDMutation.spec.ts",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/mutations/SetCommentIDMutation.spec.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/mutations/SetCommentIDMutation.spec.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/mutations/SetCommentIDMutation.spec.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,7 +1,8 @@\n import { Environment, RecordSource } from \"relay-runtime\";\n import sinon from \"sinon\";\n \n-import { parseQuery, timeout } from \"coral-common/utils\";\n+import { waitFor } from \"coral-common/helpers\";\n+import { parseQuery } from \"coral-common/utils\";\n import { LOCAL_ID } from \"coral-framework/lib/relay\";\n import { createRelayEnvironment } from \"coral-framework/testHelpers\";\n \n@@ -39,7 +40,7 @@ it(\"Should call setCommentID in pym\", async () => {\n     },\n   };\n   await commit(environment, { id }, context as any);\n-  await timeout();\n+  await waitFor();\n   expect(source.get(LOCAL_ID)!.commentID).toEqual(id);\n   context.pym.sendMessage.verify();\n });\n@@ -51,7 +52,7 @@ it(\"Should call setCommentID in pym with empty id\", async () => {\n     },\n   };\n   await commit(environment, { id: null }, context as any);\n-  await timeout();\n+  await waitFor();\n   expect(source.get(LOCAL_ID)!.commentID).toEqual(null);\n   expect(parseQuery(location.search).commentID).toBeUndefined();\n   context.pym.sendMessage.verify();"
    },
    {
      "sha": "b456b989a63bcfbce6006544da594df26ea7c1e2",
      "filename": "src/core/client/stream/tabs/Comments/Comment/CommentContainer.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/CommentContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/CommentContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Comment/CommentContainer.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,6 +1,7 @@\n import { Localized } from \"@fluent/react/compat\";\n import cn from \"classnames\";\n import { EventEmitter2 } from \"eventemitter2\";\n+import { setLongTimeout } from \"long-settimeout\";\n import React, { Component, MouseEvent } from \"react\";\n import { graphql } from \"react-relay\";\n \n@@ -179,7 +180,7 @@ export class CommentContainer extends Component<Props, State> {\n       new Date(this.props.comment.editing.editableUntil!).getTime() -\n       Date.now();\n     if (ms > 0) {\n-      return setTimeout(() => this.setState({ editable: false }), ms);\n+      return setLongTimeout(() => this.setState({ editable: false }), ms);\n     }\n     return;\n   }"
    },
    {
      "sha": "d8be0237ca7d3a0f8aa270e0d990da94b782a4a0",
      "filename": "src/core/client/stream/tabs/Comments/Comment/EditCommentForm/EditCommentFormContainer.tsx",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/EditCommentForm/EditCommentFormContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/EditCommentForm/EditCommentFormContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Comment/EditCommentForm/EditCommentFormContainer.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,4 +1,5 @@\n import { CoralRTE } from \"@coralproject/rte\";\n+import { setLongTimeout } from \"long-settimeout\";\n import React, { Component } from \"react\";\n import { graphql } from \"react-relay\";\n \n@@ -15,6 +16,7 @@ import CLASSES from \"coral-stream/classes\";\n import { EditCommentFormContainer_comment as CommentData } from \"coral-stream/__generated__/EditCommentFormContainer_comment.graphql\";\n import { EditCommentFormContainer_settings as SettingsData } from \"coral-stream/__generated__/EditCommentFormContainer_settings.graphql\";\n import { EditCommentFormContainer_story as StoryData } from \"coral-stream/__generated__/EditCommentFormContainer_story.graphql\";\n+\n import {\n   getSubmitStatus,\n   shouldTriggerSettingsRefresh,\n@@ -99,7 +101,7 @@ export class EditCommentFormContainer extends Component<Props, State> {\n       new Date(this.props.comment.editing.editableUntil!).getTime() -\n       Date.now();\n     if (ms > 0) {\n-      return setTimeout(() => this.setState({ expired: true }), ms);\n+      return setLongTimeout(() => this.setState({ expired: true }), ms);\n     }\n     return;\n   }"
    },
    {
      "sha": "1f0739c5cbe15d29f136ea6a9788fa07c0f9ee88",
      "filename": "src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.spec.tsx",
      "status": "modified",
      "additions": 11,
      "deletions": 10,
      "changes": 21,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.spec.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -4,7 +4,8 @@ import React from \"react\";\n import { createRenderer } from \"react-test-renderer/shallow\";\n import sinon from \"sinon\";\n \n-import { pureMerge, timeout } from \"coral-common/utils\";\n+import { waitFor } from \"coral-common/helpers\";\n+import { pureMerge } from \"coral-common/utils\";\n import { createPromisifiedStorage } from \"coral-framework/lib/storage\";\n import { removeFragmentRefs, wait } from \"coral-framework/testHelpers\";\n import { DeepPartial, PropTypesOf } from \"coral-framework/types\";\n@@ -75,7 +76,7 @@ it(\"renders correctly\", async () => {\n \n   const renderer = createRenderer();\n   renderer.render(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   expect(renderer.getRenderOutput()).toMatchSnapshot();\n });\n \n@@ -89,7 +90,7 @@ it(\"renders with initialValues\", async () => {\n \n   const renderer = createRenderer();\n   renderer.render(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   expect(renderer.getRenderOutput()).toMatchSnapshot();\n });\n \n@@ -102,7 +103,7 @@ it(\"save values\", async () => {\n   );\n \n   const wrapper = shallow(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   wrapper.update();\n   wrapper\n     .first()\n@@ -131,7 +132,7 @@ it(\"creates a comment\", async () => {\n   );\n \n   const wrapper = shallow(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   wrapper.update();\n   wrapper.first().props().onSubmit(input, form);\n   expect(\n@@ -145,7 +146,7 @@ it(\"creates a comment\", async () => {\n       ...input,\n     })\n   ).toBeTruthy();\n-  await timeout();\n+  await waitFor();\n   expect(onCloseStub.calledOnce).toBe(true);\n });\n \n@@ -161,7 +162,7 @@ it(\"closes on cancel\", async () => {\n   );\n \n   const wrapper = shallow(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   wrapper.update();\n   wrapper.findWhere((w) => !!w.prop(\"onCancel\")).prop(\"onCancel\")();\n \n@@ -183,7 +184,7 @@ it(\"autofocuses\", async () => {\n   });\n \n   const wrapper = shallow(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   wrapper.update();\n   wrapper\n     .findWhere((n) => n.prop(\"rteRef\"))\n@@ -206,7 +207,7 @@ it(\"renders when story has been closed\", async () => {\n \n   const renderer = createRenderer();\n   renderer.render(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   expect(renderer.getRenderOutput()).toMatchSnapshot();\n });\n \n@@ -221,6 +222,6 @@ it(\"renders when commenting has been disabled\", async () => {\n   });\n   const renderer = createRenderer();\n   renderer.render(<ReplyCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n   expect(renderer.getRenderOutput()).toMatchSnapshot();\n });"
    },
    {
      "sha": "6998c6ffe7c08f4043eef867d0c9e6d0d137bb03",
      "filename": "src/core/client/stream/tabs/Comments/PermalinkView/__snapshots__/PermalinkViewQuery.spec.tsx.snap",
      "status": "modified",
      "additions": 1,
      "deletions": 3,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/PermalinkView/__snapshots__/PermalinkViewQuery.spec.tsx.snap",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/PermalinkView/__snapshots__/PermalinkViewQuery.spec.tsx.snap",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/PermalinkView/__snapshots__/PermalinkViewQuery.spec.tsx.snap?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -7,9 +7,7 @@ exports[`renders error 1`] = `\n `;\n \n exports[`renders loading 1`] = `\n-<Delay\n-  ms={500}\n->\n+<Delay>\n   <withPropsOnChange(Spinner) />\n </Delay>\n `;"
    },
    {
      "sha": "440156c613cdcfa3307e2ef4a1a400d16f8544de",
      "filename": "src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "status": "modified",
      "additions": 9,
      "deletions": 8,
      "changes": 17,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -3,7 +3,8 @@ import { noop } from \"lodash\";\n import React from \"react\";\n import sinon from \"sinon\";\n \n-import { pureMerge, timeout } from \"coral-common/utils\";\n+import { waitFor } from \"coral-common/helpers\";\n+import { pureMerge } from \"coral-common/utils\";\n import { createPromisifiedStorage } from \"coral-framework/lib/storage\";\n import { act, removeFragmentRefs, wait } from \"coral-framework/testHelpers\";\n import { DeepPartial, PropTypesOf } from \"coral-framework/types\";\n@@ -110,7 +111,7 @@ it(\"save values\", async () => {\n   await props.sessionStorage.setItem(contextKey, \"Hello World!\");\n \n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.update();\n@@ -151,7 +152,7 @@ it(\"creates a comment\", async () => {\n   });\n \n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.update();\n@@ -190,7 +191,7 @@ it(\"renders when story has been closed (collapsing)\", async () => {\n     },\n   });\n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.update();\n@@ -211,7 +212,7 @@ it(\"renders when commenting has been disabled (collapsing)\", async () => {\n     },\n   });\n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.update();\n@@ -244,7 +245,7 @@ it(\"renders when story has been closed (non-collapsing)\", async () => {\n     },\n   });\n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.setProps(nextProps);\n@@ -273,7 +274,7 @@ it(\"renders when commenting has been disabled (non-collapsing)\", async () => {\n     },\n   });\n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   act(() => {\n     wrapper.setProps(nextProps);\n@@ -291,7 +292,7 @@ it(\"renders when user is scheduled to be deleted\", async () => {\n     },\n   });\n   const wrapper = shallow(<PostCommentFormContainerN {...props} />);\n-  await timeout();\n+  await waitFor();\n \n   await act(async () => {\n     await wait(() => expect(wrapper).toMatchSnapshot());"
    },
    {
      "sha": "0bb596fae14f5f771cb77276e89286d1818ccceb",
      "filename": "src/core/client/stream/tabs/Comments/Stream/StoryClosedTimeout/StoryClosedTimeoutContainer.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Stream/StoryClosedTimeout/StoryClosedTimeoutContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Comments/Stream/StoryClosedTimeout/StoryClosedTimeoutContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/StoryClosedTimeout/StoryClosedTimeoutContainer.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,3 +1,4 @@\n+import { setLongTimeout } from \"long-settimeout\";\n import React from \"react\";\n import { graphql } from \"react-relay\";\n \n@@ -18,7 +19,7 @@ interface Props {\n function createTimeout(callback: () => void, closedAt: string) {\n   const diff = new Date(closedAt).valueOf() - Date.now();\n   if (diff > 0) {\n-    return setTimeout(callback, diff);\n+    return setLongTimeout(callback, diff);\n   }\n   return null;\n }"
    },
    {
      "sha": "2b2083c009b003f62f6cddacc64e00671bb6ff9f",
      "filename": "src/core/client/stream/tabs/Configure/ConfigureQuery.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Configure/ConfigureQuery.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Configure/ConfigureQuery.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Configure/ConfigureQuery.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -24,7 +24,7 @@ const loadConfigureContainer = () =>\n   );\n // (cvle) For some reason without `setTimeout` this request will block other requests.\n const preloadConfigureContainer = once(() =>\n-  setTimeout(loadConfigureContainer)\n+  setTimeout(loadConfigureContainer, 0)\n );\n \n const LazyConfigureContainer = React.lazy(loadConfigureContainer);"
    },
    {
      "sha": "e2959f1d4eeb6e54d25b3c8127b414aac68cf5fb",
      "filename": "src/core/client/stream/tabs/Discussions/DiscussionsQuery.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Discussions/DiscussionsQuery.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Discussions/DiscussionsQuery.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Discussions/DiscussionsQuery.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -25,7 +25,7 @@ const loadDiscussionsContainer = () =>\n   );\n // (cvle) For some reason without `setTimeout` this request will block other requests.\n const preloadDiscussionsContainer = once(() =>\n-  setTimeout(loadDiscussionsContainer)\n+  setTimeout(loadDiscussionsContainer, 0)\n );\n \n const LazyDiscussionsContainer = React.lazy(loadDiscussionsContainer);"
    },
    {
      "sha": "3b36dc18304e92391aacfa097cf0f5cbf9f7df4f",
      "filename": "src/core/client/stream/tabs/Profile/ProfileQuery.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Profile/ProfileQuery.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/stream/tabs/Profile/ProfileQuery.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Profile/ProfileQuery.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -22,7 +22,7 @@ const loadProfileContainer = () =>\n     return x;\n   });\n // (cvle) For some reason without `setTimeout` this request will block other requests.\n-const preloadProfileContainer = once(() => setTimeout(loadProfileContainer));\n+const preloadProfileContainer = once(() => setTimeout(loadProfileContainer, 0));\n \n const LazyProfileContainer = React.lazy(loadProfileContainer);\n "
    },
    {
      "sha": "e65eb22ed73761b5a824516b5bfff181508b6620",
      "filename": "src/core/client/ui/components/v2/Delay/Delay.tsx",
      "status": "modified",
      "additions": 4,
      "deletions": 7,
      "changes": 11,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/ui/components/v2/Delay/Delay.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/client/ui/components/v2/Delay/Delay.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/ui/components/v2/Delay/Delay.tsx?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,18 +1,19 @@\n+import { clearLongTimeout, setLongTimeout } from \"long-settimeout\";\n import React, { FunctionComponent, useEffect, useState } from \"react\";\n \n interface Props {\n   ms?: number;\n   children: React.ReactNode;\n }\n \n-const Delay: FunctionComponent<Props> = ({ ms, children }) => {\n+const Delay: FunctionComponent<Props> = ({ ms = 500, children }) => {\n   const [render, setRender] = useState<boolean>(false);\n   useEffect(() => {\n-    const timeout = setTimeout(() => {\n+    const timeout = setLongTimeout(() => {\n       setRender(true);\n     }, ms);\n     return () => {\n-      clearTimeout(timeout);\n+      clearLongTimeout(timeout);\n     };\n   }, [ms]);\n   if (!render) {\n@@ -21,8 +22,4 @@ const Delay: FunctionComponent<Props> = ({ ms, children }) => {\n   return <>{children}</>;\n };\n \n-Delay.defaultProps = {\n-  ms: 500,\n-};\n-\n export default Delay;"
    },
    {
      "sha": "9802f8a421e9a2a57f2404779983ac4f79c71e9a",
      "filename": "src/core/common/helpers/waitFor.ts",
      "status": "modified",
      "additions": 5,
      "deletions": 6,
      "changes": 11,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/common/helpers/waitFor.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/common/helpers/waitFor.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/helpers/waitFor.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,7 +1,6 @@\n-export default function waitFor(timeout: number): Promise<void> {\n-  return new Promise((resolve) => {\n-    setTimeout(() => {\n-      resolve();\n-    }, timeout);\n-  });\n+import { setLongTimeout } from \"long-settimeout\";\n+\n+/** A promisified timeout. */\n+export default function waitFor(ms = 0): Promise<void> {\n+  return new Promise((resolve) => setLongTimeout(resolve, ms));\n }"
    },
    {
      "sha": "c822d84d109825ed25593393be4b3534aa2b94ef",
      "filename": "src/core/common/utils/index.ts",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/common/utils/index.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/common/utils/index.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/utils/index.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,4 +1,3 @@\n-export { default as timeout } from \"./timeout\";\n export { default as animationFrame } from \"./animationFrame\";\n export { default as pascalCase } from \"./pascalCase\";\n export { default as oncePerFrame } from \"./oncePerFrame\";"
    },
    {
      "sha": "1978aa485a9a829ec27a41396e303baf066ae7cd",
      "filename": "src/core/common/utils/timeout.ts",
      "status": "removed",
      "additions": 0,
      "deletions": 6,
      "changes": 6,
      "blob_url": "https://github.com/coralproject/talk/blob/8aac2d33fc1401c0a6104f7eb04538d3b7312fa9/src/core/common/utils/timeout.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/8aac2d33fc1401c0a6104f7eb04538d3b7312fa9/src/core/common/utils/timeout.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/utils/timeout.ts?ref=8aac2d33fc1401c0a6104f7eb04538d3b7312fa9",
      "patch": "@@ -1,6 +0,0 @@\n-import { setLongTimeout } from \"long-settimeout\";\n-\n-/** A promisified timeout. */\n-export default function timeout(ms = 0) {\n-  return new Promise((resolve) => setLongTimeout(resolve, ms));\n-}"
    },
    {
      "sha": "d07b601be6363da3ebf0b5eeb73ae795bc505798",
      "filename": "src/core/server/services/fetch/abortAfter.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/server/services/fetch/abortAfter.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/server/services/fetch/abortAfter.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/services/fetch/abortAfter.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,8 +1,9 @@\n import AbortController from \"abort-controller\";\n+import { setLongTimeout } from \"long-settimeout\";\n \n function abortAfter(ms: number) {\n   const controller = new AbortController();\n-  const timeout = setTimeout(() => {\n+  const timeout = setLongTimeout(() => {\n     controller.abort();\n   }, ms);\n "
    },
    {
      "sha": "dcc8e112e785d9c5193d3e152592b10ee57d6754",
      "filename": "src/core/server/services/fetch/fetch.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/server/services/fetch/fetch.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9d0239106251a44b0d921d67e97bcf60f4f7fb7a/src/core/server/services/fetch/fetch.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/services/fetch/fetch.ts?ref=9d0239106251a44b0d921d67e97bcf60f4f7fb7a",
      "patch": "@@ -1,6 +1,7 @@\n import http from \"http\";\n import https from \"https\";\n import { capitalize } from \"lodash\";\n+import { clearLongTimeout } from \"long-settimeout\";\n import fetch, { RequestInit, Response } from \"node-fetch\";\n import { URL } from \"url\";\n \n@@ -119,7 +120,7 @@ export const createFetch = ({\n \n       return res;\n     } finally {\n-      clearTimeout(abort.timeout);\n+      clearLongTimeout(abort.timeout);\n     }\n   };\n };"
    }
  ]
}
