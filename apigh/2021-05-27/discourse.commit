{
  "sha": "723d7de18c8dda9889ad65ea58dd5df691bc91cc",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo3MjNkN2RlMThjOGRkYTk4ODlhZDY1ZWE1OGRkNWRmNjkxYmM5MWNj",
  "commit": {
    "author": {
      "name": "Dan Ungureanu",
      "email": "dan@ungureanu.me",
      "date": "2021-05-27T09:38:42Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2021-05-27T09:38:42Z"
    },
    "message": "Various GitHub Onebox improvements (#13163)\n\n* FIX: Improve GitHub folder regexp in Onebox\r\n\r\nIt used to match any GitHub URL that was not matched by the other GitHub\r\nOneboxes and it did not do a good job at handling those. With this\r\nchange, the generic Onebox will handle the remaining URLs.\r\n\r\n* FEATURE: Add Onebox for GitHub Actions\r\n\r\n* FEATURE: Add Onebox for PR check runs\r\n\r\n* FIX: Remove image from GitHub folder Oneboxes\r\n\r\nIt is a generic, auto-generated image which does not provide any value.\r\n\r\n* DEV: Add tests\r\n\r\n* FIX: Strip HTML comments from PR body",
    "tree": {
      "sha": "28edc292330b789f4870b7de78c54c849a575cbf",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/28edc292330b789f4870b7de78c54c849a575cbf"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/723d7de18c8dda9889ad65ea58dd5df691bc91cc",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgr2iiCRBK7hj4Ov3rIwAAFAYIACJIUBK07z4F6HyYdWa+YijX\n71CHgKaYGyqCUxHJQjcLlNX1km1AeWI4RAOry+zR/48q2hwb/RRoDxV03UqXFf1A\np3aQ9BSdXxzEi1+ZYZiKSTHDCSg4s8HL6F2m6GzBkfGpaEEGDAgAbrlGpTbbr1C2\n8D8j4Ok8t6recHgiZHcYfmZVUDSP/GorwOrkQWroI2Ad4t9XQQDxSnt1uANyskmm\njxOj5CMLJpEryoFSU7pyiKCOQpt3uG9/CS0uxPNX24wIsSA6an8wdzR9/s29j6dB\nu/sABhkHw6Ueq4O+3sWqrklLulft6YaqzHrMMIH87rTJTZxXdsC+K9eJExBZMfo=\n=64pi\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 28edc292330b789f4870b7de78c54c849a575cbf\nparent 2f12c0f5bd3e5ab64dbfabc354ad7c798ea991e7\nauthor Dan Ungureanu <dan@ungureanu.me> 1622108322 +0300\ncommitter GitHub <noreply@github.com> 1622108322 +0300\n\nVarious GitHub Onebox improvements (#13163)\n\n* FIX: Improve GitHub folder regexp in Onebox\r\n\r\nIt used to match any GitHub URL that was not matched by the other GitHub\r\nOneboxes and it did not do a good job at handling those. With this\r\nchange, the generic Onebox will handle the remaining URLs.\r\n\r\n* FEATURE: Add Onebox for GitHub Actions\r\n\r\n* FEATURE: Add Onebox for PR check runs\r\n\r\n* FIX: Remove image from GitHub folder Oneboxes\r\n\r\nIt is a generic, auto-generated image which does not provide any value.\r\n\r\n* DEV: Add tests\r\n\r\n* FIX: Strip HTML comments from PR body"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/723d7de18c8dda9889ad65ea58dd5df691bc91cc",
  "html_url": "https://github.com/discourse/discourse/commit/723d7de18c8dda9889ad65ea58dd5df691bc91cc",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/723d7de18c8dda9889ad65ea58dd5df691bc91cc/comments",
  "author": {
    "login": "udan11",
    "id": 4147664,
    "node_id": "MDQ6VXNlcjQxNDc2NjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4147664?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/udan11",
    "html_url": "https://github.com/udan11",
    "followers_url": "https://api.github.com/users/udan11/followers",
    "following_url": "https://api.github.com/users/udan11/following{/other_user}",
    "gists_url": "https://api.github.com/users/udan11/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/udan11/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/udan11/subscriptions",
    "organizations_url": "https://api.github.com/users/udan11/orgs",
    "repos_url": "https://api.github.com/users/udan11/repos",
    "events_url": "https://api.github.com/users/udan11/events{/privacy}",
    "received_events_url": "https://api.github.com/users/udan11/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2f12c0f5bd3e5ab64dbfabc354ad7c798ea991e7",
      "url": "https://api.github.com/repos/discourse/discourse/commits/2f12c0f5bd3e5ab64dbfabc354ad7c798ea991e7",
      "html_url": "https://github.com/discourse/discourse/commit/2f12c0f5bd3e5ab64dbfabc354ad7c798ea991e7"
    }
  ],
  "stats": {
    "total": 906,
    "additions": 886,
    "deletions": 20
  },
  "files": [
    {
      "sha": "b425a81a2e637d966fcc70d2e28c84e4db093d56",
      "filename": "app/assets/javascripts/discourse/app/initializers/post-decorations.js",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/app/assets/javascripts/discourse/app/initializers/post-decorations.js",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/app/assets/javascripts/discourse/app/initializers/post-decorations.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/app/initializers/post-decorations.js?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -88,6 +88,7 @@ export default {\n \n       const oneboxTypes = {\n         amazon: \"discourse-amazon\",\n+        githubactions: \"fab-github\",\n         githubblob: \"fab-github\",\n         githubcommit: \"fab-github\",\n         githubpullrequest: \"fab-github\","
    },
    {
      "sha": "ef88ca7ee8022c30a4fe4756dada69d2d8c8a2a3",
      "filename": "app/assets/stylesheets/common/base/onebox.scss",
      "status": "modified",
      "additions": 43,
      "deletions": 0,
      "changes": 43,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/app/assets/stylesheets/common/base/onebox.scss",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/app/assets/stylesheets/common/base/onebox.scss",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/stylesheets/common/base/onebox.scss?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -507,6 +507,49 @@ pre.onebox code {\n   }\n }\n \n+.onebox.githubactions {\n+  h4 {\n+    margin-top: 5px;\n+    margin-bottom: 5px;\n+  }\n+\n+  .github-row {\n+    display: flex;\n+  }\n+\n+  .github-icon-container {\n+    display: flex;\n+    align-items: flex-start;\n+    margin-right: 5px;\n+  }\n+\n+  .github-icon {\n+    fill: var(--primary-medium);\n+    width: var(--font-up-3);\n+    height: var(--font-up-3);\n+  }\n+\n+  .github-icon-success {\n+    fill: var(--success);\n+  }\n+\n+  .github-icon-failure {\n+    fill: var(--danger);\n+  }\n+\n+  .github-icon-pending {\n+    fill: #dbab0a;\n+  }\n+\n+  .github-info {\n+    color: var(--primary-high);\n+  }\n+\n+  .github-run-number {\n+    color: var(--primary-medium);\n+  }\n+}\n+\n //Onebox - Github - Pull request\n .onebox-body .github-commit-status {\n   background: #f5f5f5;"
    },
    {
      "sha": "cdb7e16378fffeda3aa8b5202a9742f79a06d7a5",
      "filename": "lib/onebox/engine/github_actions_onebox.rb",
      "status": "added",
      "additions": 87,
      "deletions": 0,
      "changes": 87,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/engine/github_actions_onebox.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/engine/github_actions_onebox.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/onebox/engine/github_actions_onebox.rb?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,87 @@\n+# frozen_string_literal: true\n+\n+require_relative '../mixins/github_body'\n+\n+module Onebox\n+  module Engine\n+    class GithubActionsOnebox\n+      include Engine\n+      include LayoutSupport\n+      include JSON\n+\n+      matches_regexp(/^https?:\\/\\/(?:www\\.)?(?:(?:\\w)+\\.)?github\\.com\\/(?<org>.+)\\/(?<repo>.+)\\/(actions\\/runs\\/[[:digit:]]+|pull\\/[[:digit:]]*\\/checks\\?check_run_id=[[:digit:]]+)/)\n+      always_https\n+\n+      def url\n+        if type == :actions_run\n+          \"https://api.github.com/repos/#{match[:org]}/#{match[:repo]}/actions/runs/#{match[:run_id]}\"\n+        elsif type == :pr_run\n+          \"https://api.github.com/repos/#{match[:org]}/#{match[:repo]}/check-runs/#{match[:check_run_id]}\"\n+        end\n+      end\n+\n+      def self.priority\n+        90 # overlaps with GithubPullRequestOnebox\n+      end\n+\n+      private\n+\n+      def match_url\n+        return if defined?(@match) && defined?(@type)\n+\n+        if match = @url.match(/^https?:\\/\\/(?:www\\.)?(?:(?:\\w)+\\.)?github\\.com\\/(?<org>.+)\\/(?<repo>.+)\\/actions\\/runs\\/(?<run_id>[[:digit:]]+)/)\n+          @match = match\n+          @type = :actions_run\n+        end\n+\n+        if match = @url.match(/^https?:\\/\\/(?:www\\.)?(?:(?:\\w)+\\.)?github\\.com\\/(?<org>.+)\\/(?<repo>.+)\\/pull\\/(?<pr_id>[[:digit:]]*)\\/checks\\?check_run_id=(?<check_run_id>[[:digit:]]+)/)\n+          @match = match\n+          @type = :pr_run\n+        end\n+      end\n+\n+      def match\n+        return @match if defined?(@match)\n+\n+        match_url\n+        @match\n+      end\n+\n+      def type\n+        return @type if defined?(@type)\n+\n+        match_url\n+        @type\n+      end\n+\n+      def data\n+        status = \"unknown\"\n+        if raw[\"status\"] == \"completed\"\n+          if raw[\"conclusion\"] == \"success\"\n+            status = \"success\"\n+          elsif raw[\"conclusion\"] == \"failure\"\n+            status = \"failure\"\n+          elsif raw[\"conclusion\"] == \"cancelled\"\n+          end\n+        elsif raw[\"status\"] == \"in_progress\"\n+          status = \"pending\"\n+        end\n+\n+        title = if type == :actions_run\n+          raw[\"head_commit\"][\"message\"].lines.first\n+        elsif type == :pr_run\n+          pr_url = \"https://api.github.com/repos/#{match[:org]}/#{match[:repo]}/pulls/#{match[:pr_id]}\"\n+          ::MultiJson.load(URI.open(pr_url, read_timeout: timeout))[\"title\"]\n+        end\n+\n+        {\n+          link: @url,\n+          title: title,\n+          name: raw[\"name\"],\n+          run_number: raw[\"run_number\"],\n+          status => true,\n+        }\n+      end\n+    end\n+  end\n+end"
    },
    {
      "sha": "fb8bbe1e204c8f2b30a4ddaccda557bf551e87f3",
      "filename": "lib/onebox/engine/github_folder_onebox.rb",
      "status": "modified",
      "additions": 1,
      "deletions": 7,
      "changes": 8,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/engine/github_folder_onebox.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/engine/github_folder_onebox.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/onebox/engine/github_folder_onebox.rb?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -7,14 +7,9 @@ class GithubFolderOnebox\n       include StandardEmbed\n       include LayoutSupport\n \n-      matches_regexp(/^https?:\\/\\/(?:www\\.)?(?:(?:\\w)+\\.)?(github)\\.com[\\:\\d]*(\\/[^\\/]+){2}/)\n+      matches_regexp(/^https?:\\/\\/(?:www\\.)?(?:(?:\\w)+\\.)?(github)\\.com[\\:\\d]*(\\/[^\\/]+){2}\\/tree/)\n       always_https\n \n-      def self.priority\n-        # This engine should have lower priority than the other Github engines\n-        150\n-      end\n-\n       private\n \n       def data\n@@ -46,7 +41,6 @@ def data\n \n         {\n           link: url,\n-          image: og.image,\n           title: Onebox::Helpers.truncate(title, 250),\n           path: display_path,\n           description: display_description,"
    },
    {
      "sha": "f6c1e8435616ed8d51c93880d1b1cb4a8b3ff85c",
      "filename": "lib/onebox/mixins/github_body.rb",
      "status": "modified",
      "additions": 10,
      "deletions": 9,
      "changes": 19,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/mixins/github_body.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/mixins/github_body.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/onebox/mixins/github_body.rb?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -9,17 +9,18 @@ def self.included(klass)\n       end\n \n       module InstanceMethods\n-        GITHUB_COMMENT_REGEX = /(<!--.*?-->\\r\\n)/\n+        GITHUB_COMMENT_REGEX = /<!--.*?-->/\n         MAX_BODY_LENGTH = 80\n-        def compute_body(body)\n-          body = body.dup\n-          excerpt = nil\n \n-          body = (body || '').gsub(GITHUB_COMMENT_REGEX, '')\n-          body = body.length > 0 ? body : nil\n-          if body && body.length > MAX_BODY_LENGTH\n-            excerpt = body[MAX_BODY_LENGTH..body.length].rstrip\n-            body = body[0..MAX_BODY_LENGTH - 1]\n+        def compute_body(body)\n+          if body\n+            body = body.gsub(GITHUB_COMMENT_REGEX, '').strip\n+            if body.length == 0\n+              body = nil\n+            elsif body.length > MAX_BODY_LENGTH\n+              excerpt = body[MAX_BODY_LENGTH..body.length].rstrip\n+              body = body[0..MAX_BODY_LENGTH - 1]\n+            end\n           end\n \n           [body, excerpt]"
    },
    {
      "sha": "e8ddaaae2ecf87471f113922ccba058f61d7f164",
      "filename": "lib/onebox/templates/githubactions.mustache",
      "status": "added",
      "additions": 31,
      "deletions": 0,
      "changes": 31,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/templates/githubactions.mustache",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/templates/githubactions.mustache",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/onebox/templates/githubactions.mustache?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,31 @@\n+<div class=\"github-row\">\n+  <div class=\"github-icon-container\" title=\"Commit\">\n+    {{#success}}\n+      <svg width=\"24\" height=\"24\" class=\"github-icon github-icon-success\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm16.28-2.72a.75.75 0 00-1.06-1.06l-5.97 5.97-2.47-2.47a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l6.5-6.5z\"></path></svg>\n+    {{/success}}\n+\n+    {{#pending}}\n+      <svg width=\"24\" height=\"24\" class=\"github-icon github-icon-pending\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M12 18a6 6 0 100-12 6 6 0 000 12z\"></path></svg>\n+    {{/pending}}\n+\n+    {{#failure}}\n+      <svg width=\"24\" height=\"24\" class=\"github-icon github-icon-failure\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm8.036-4.024a.75.75 0 00-1.06 1.06L10.939 12l-2.963 2.963a.75.75 0 101.06 1.06L12 13.06l2.963 2.964a.75.75 0 001.061-1.06L13.061 12l2.963-2.964a.75.75 0 10-1.06-1.06L12 10.939 9.036 7.976z\"></path></svg>\n+    {{/failure}}\n+\n+    {{#unknown}}\n+      <svg width=\"24\" height=\"24\" class=\"github-icon\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M12 18a6 6 0 100-12 6 6 0 000 12z\"></path></svg>\n+    {{/unknown}}\n+  </div>\n+\n+  <div class=\"github-info-container\">\n+    <h4>\n+      <a href=\"{{link}}\" target=\"_blank\" rel=\"noopener\">{{title}}</a>\n+    </h4>\n+\n+    {{#run_number}}\n+      <div class=\"github-info\">\n+        {{name}} <span class=\"github-run-number\">#{{run_number}}</span>\n+      </div>\n+    {{/run_number}}\n+  </div>\n+</div>"
    },
    {
      "sha": "152167731db384ae8ddf7b53bd627257a8d7c05d",
      "filename": "lib/onebox/templates/githubfolder.mustache",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/templates/githubfolder.mustache",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/lib/onebox/templates/githubfolder.mustache",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/onebox/templates/githubfolder.mustache?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -1,5 +1,3 @@\n-{{#image}}<img src=\"{{image}}\" class=\"thumbnail\"/>{{/image}}\n-\n <h3><a href=\"{{link}}\" target=\"_blank\" rel=\"noopener\">{{title}}</a></h3>\n \n {{#path}}"
    },
    {
      "sha": "56a881f13ecc0580a6037cd13ffe8fdd3296e700",
      "filename": "spec/fixtures/onebox/githubactions_actions_run.response",
      "status": "added",
      "additions": 176,
      "deletions": 0,
      "changes": 176,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_actions_run.response",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_actions_run.response",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/fixtures/onebox/githubactions_actions_run.response?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,176 @@\n+{\n+  \"id\": 873214216,\n+  \"name\": \"Linting\",\n+  \"node_id\": \"WFR_lAHOADEiqs4Ac4CqzjQMMQg\",\n+  \"head_branch\": \"simplify-deleted-post-copy\",\n+  \"head_sha\": \"929e4ee5e93e53f45c7be78fcf81b734120af9c0\",\n+  \"run_number\": 2687,\n+  \"event\": \"pull_request\",\n+  \"status\": \"completed\",\n+  \"conclusion\": \"success\",\n+  \"workflow_id\": 5947272,\n+  \"check_suite_id\": 2820222471,\n+  \"check_suite_node_id\": \"MDEwOkNoZWNrU3VpdGUyODIwMjIyNDcx\",\n+  \"url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216\",\n+  \"html_url\": \"https://github.com/discourse/discourse/actions/runs/873214216\",\n+  \"pull_requests\": [\n+\n+  ],\n+  \"created_at\": \"2021-05-25T01:10:28Z\",\n+  \"updated_at\": \"2021-05-25T01:15:56Z\",\n+  \"jobs_url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216/jobs\",\n+  \"logs_url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216/logs\",\n+  \"check_suite_url\": \"https://api.github.com/repos/discourse/discourse/check-suites/2820222471\",\n+  \"artifacts_url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216/artifacts\",\n+  \"cancel_url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216/cancel\",\n+  \"rerun_url\": \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216/rerun\",\n+  \"workflow_url\": \"https://api.github.com/repos/discourse/discourse/actions/workflows/5947272\",\n+  \"head_commit\": {\n+    \"id\": \"929e4ee5e93e53f45c7be78fcf81b734120af9c0\",\n+    \"tree_id\": \"3d8f1301a94fd5bad68684e2fe1212ad890dcd79\",\n+    \"message\": \"Remove deleted_by_author key\\n\\nThis has to be done to avoid errors because the old translation\\nhad a one and many key, whereas the new one has no count.\",\n+    \"timestamp\": \"2021-05-25T01:09:40Z\",\n+    \"author\": {\n+      \"name\": \"Martin Brennan\",\n+      \"email\": \"martin@discourse.org\"\n+    },\n+    \"committer\": {\n+      \"name\": \"Martin Brennan\",\n+      \"email\": \"martin@discourse.org\"\n+    }\n+  },\n+  \"repository\": {\n+    \"id\": 7569578,\n+    \"node_id\": \"MDEwOlJlcG9zaXRvcnk3NTY5NTc4\",\n+    \"name\": \"discourse\",\n+    \"full_name\": \"discourse/discourse\",\n+    \"private\": false,\n+    \"owner\": {\n+      \"login\": \"discourse\",\n+      \"id\": 3220138,\n+      \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+      \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+      \"gravatar_id\": \"\",\n+      \"url\": \"https://api.github.com/users/discourse\",\n+      \"html_url\": \"https://github.com/discourse\",\n+      \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+      \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+      \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+      \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+      \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+      \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+      \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+      \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+      \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+      \"type\": \"Organization\",\n+      \"site_admin\": false\n+    },\n+    \"html_url\": \"https://github.com/discourse/discourse\",\n+    \"description\": \"A platform for community discussion. Free, open, simple.\",\n+    \"fork\": false,\n+    \"url\": \"https://api.github.com/repos/discourse/discourse\",\n+    \"forks_url\": \"https://api.github.com/repos/discourse/discourse/forks\",\n+    \"keys_url\": \"https://api.github.com/repos/discourse/discourse/keys{/key_id}\",\n+    \"collaborators_url\": \"https://api.github.com/repos/discourse/discourse/collaborators{/collaborator}\",\n+    \"teams_url\": \"https://api.github.com/repos/discourse/discourse/teams\",\n+    \"hooks_url\": \"https://api.github.com/repos/discourse/discourse/hooks\",\n+    \"issue_events_url\": \"https://api.github.com/repos/discourse/discourse/issues/events{/number}\",\n+    \"events_url\": \"https://api.github.com/repos/discourse/discourse/events\",\n+    \"assignees_url\": \"https://api.github.com/repos/discourse/discourse/assignees{/user}\",\n+    \"branches_url\": \"https://api.github.com/repos/discourse/discourse/branches{/branch}\",\n+    \"tags_url\": \"https://api.github.com/repos/discourse/discourse/tags\",\n+    \"blobs_url\": \"https://api.github.com/repos/discourse/discourse/git/blobs{/sha}\",\n+    \"git_tags_url\": \"https://api.github.com/repos/discourse/discourse/git/tags{/sha}\",\n+    \"git_refs_url\": \"https://api.github.com/repos/discourse/discourse/git/refs{/sha}\",\n+    \"trees_url\": \"https://api.github.com/repos/discourse/discourse/git/trees{/sha}\",\n+    \"statuses_url\": \"https://api.github.com/repos/discourse/discourse/statuses/{sha}\",\n+    \"languages_url\": \"https://api.github.com/repos/discourse/discourse/languages\",\n+    \"stargazers_url\": \"https://api.github.com/repos/discourse/discourse/stargazers\",\n+    \"contributors_url\": \"https://api.github.com/repos/discourse/discourse/contributors\",\n+    \"subscribers_url\": \"https://api.github.com/repos/discourse/discourse/subscribers\",\n+    \"subscription_url\": \"https://api.github.com/repos/discourse/discourse/subscription\",\n+    \"commits_url\": \"https://api.github.com/repos/discourse/discourse/commits{/sha}\",\n+    \"git_commits_url\": \"https://api.github.com/repos/discourse/discourse/git/commits{/sha}\",\n+    \"comments_url\": \"https://api.github.com/repos/discourse/discourse/comments{/number}\",\n+    \"issue_comment_url\": \"https://api.github.com/repos/discourse/discourse/issues/comments{/number}\",\n+    \"contents_url\": \"https://api.github.com/repos/discourse/discourse/contents/{+path}\",\n+    \"compare_url\": \"https://api.github.com/repos/discourse/discourse/compare/{base}...{head}\",\n+    \"merges_url\": \"https://api.github.com/repos/discourse/discourse/merges\",\n+    \"archive_url\": \"https://api.github.com/repos/discourse/discourse/{archive_format}{/ref}\",\n+    \"downloads_url\": \"https://api.github.com/repos/discourse/discourse/downloads\",\n+    \"issues_url\": \"https://api.github.com/repos/discourse/discourse/issues{/number}\",\n+    \"pulls_url\": \"https://api.github.com/repos/discourse/discourse/pulls{/number}\",\n+    \"milestones_url\": \"https://api.github.com/repos/discourse/discourse/milestones{/number}\",\n+    \"notifications_url\": \"https://api.github.com/repos/discourse/discourse/notifications{?since,all,participating}\",\n+    \"labels_url\": \"https://api.github.com/repos/discourse/discourse/labels{/name}\",\n+    \"releases_url\": \"https://api.github.com/repos/discourse/discourse/releases{/id}\",\n+    \"deployments_url\": \"https://api.github.com/repos/discourse/discourse/deployments\"\n+  },\n+  \"head_repository\": {\n+    \"id\": 7569578,\n+    \"node_id\": \"MDEwOlJlcG9zaXRvcnk3NTY5NTc4\",\n+    \"name\": \"discourse\",\n+    \"full_name\": \"discourse/discourse\",\n+    \"private\": false,\n+    \"owner\": {\n+      \"login\": \"discourse\",\n+      \"id\": 3220138,\n+      \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+      \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+      \"gravatar_id\": \"\",\n+      \"url\": \"https://api.github.com/users/discourse\",\n+      \"html_url\": \"https://github.com/discourse\",\n+      \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+      \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+      \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+      \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+      \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+      \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+      \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+      \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+      \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+      \"type\": \"Organization\",\n+      \"site_admin\": false\n+    },\n+    \"html_url\": \"https://github.com/discourse/discourse\",\n+    \"description\": \"A platform for community discussion. Free, open, simple.\",\n+    \"fork\": false,\n+    \"url\": \"https://api.github.com/repos/discourse/discourse\",\n+    \"forks_url\": \"https://api.github.com/repos/discourse/discourse/forks\",\n+    \"keys_url\": \"https://api.github.com/repos/discourse/discourse/keys{/key_id}\",\n+    \"collaborators_url\": \"https://api.github.com/repos/discourse/discourse/collaborators{/collaborator}\",\n+    \"teams_url\": \"https://api.github.com/repos/discourse/discourse/teams\",\n+    \"hooks_url\": \"https://api.github.com/repos/discourse/discourse/hooks\",\n+    \"issue_events_url\": \"https://api.github.com/repos/discourse/discourse/issues/events{/number}\",\n+    \"events_url\": \"https://api.github.com/repos/discourse/discourse/events\",\n+    \"assignees_url\": \"https://api.github.com/repos/discourse/discourse/assignees{/user}\",\n+    \"branches_url\": \"https://api.github.com/repos/discourse/discourse/branches{/branch}\",\n+    \"tags_url\": \"https://api.github.com/repos/discourse/discourse/tags\",\n+    \"blobs_url\": \"https://api.github.com/repos/discourse/discourse/git/blobs{/sha}\",\n+    \"git_tags_url\": \"https://api.github.com/repos/discourse/discourse/git/tags{/sha}\",\n+    \"git_refs_url\": \"https://api.github.com/repos/discourse/discourse/git/refs{/sha}\",\n+    \"trees_url\": \"https://api.github.com/repos/discourse/discourse/git/trees{/sha}\",\n+    \"statuses_url\": \"https://api.github.com/repos/discourse/discourse/statuses/{sha}\",\n+    \"languages_url\": \"https://api.github.com/repos/discourse/discourse/languages\",\n+    \"stargazers_url\": \"https://api.github.com/repos/discourse/discourse/stargazers\",\n+    \"contributors_url\": \"https://api.github.com/repos/discourse/discourse/contributors\",\n+    \"subscribers_url\": \"https://api.github.com/repos/discourse/discourse/subscribers\",\n+    \"subscription_url\": \"https://api.github.com/repos/discourse/discourse/subscription\",\n+    \"commits_url\": \"https://api.github.com/repos/discourse/discourse/commits{/sha}\",\n+    \"git_commits_url\": \"https://api.github.com/repos/discourse/discourse/git/commits{/sha}\",\n+    \"comments_url\": \"https://api.github.com/repos/discourse/discourse/comments{/number}\",\n+    \"issue_comment_url\": \"https://api.github.com/repos/discourse/discourse/issues/comments{/number}\",\n+    \"contents_url\": \"https://api.github.com/repos/discourse/discourse/contents/{+path}\",\n+    \"compare_url\": \"https://api.github.com/repos/discourse/discourse/compare/{base}...{head}\",\n+    \"merges_url\": \"https://api.github.com/repos/discourse/discourse/merges\",\n+    \"archive_url\": \"https://api.github.com/repos/discourse/discourse/{archive_format}{/ref}\",\n+    \"downloads_url\": \"https://api.github.com/repos/discourse/discourse/downloads\",\n+    \"issues_url\": \"https://api.github.com/repos/discourse/discourse/issues{/number}\",\n+    \"pulls_url\": \"https://api.github.com/repos/discourse/discourse/pulls{/number}\",\n+    \"milestones_url\": \"https://api.github.com/repos/discourse/discourse/milestones{/number}\",\n+    \"notifications_url\": \"https://api.github.com/repos/discourse/discourse/notifications{?since,all,participating}\",\n+    \"labels_url\": \"https://api.github.com/repos/discourse/discourse/labels{/name}\",\n+    \"releases_url\": \"https://api.github.com/repos/discourse/discourse/releases{/id}\",\n+    \"deployments_url\": \"https://api.github.com/repos/discourse/discourse/deployments\"\n+  }\n+}\n\\ No newline at end of file"
    },
    {
      "sha": "9992a476c481e153ac187b8e78bc6cf31af473a7",
      "filename": "spec/fixtures/onebox/githubactions_pr.response",
      "status": "added",
      "additions": 369,
      "deletions": 0,
      "changes": 369,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_pr.response",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_pr.response",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/fixtures/onebox/githubactions_pr.response?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,369 @@\n+{\n+  \"url\": \"https://api.github.com/repos/discourse/discourse/pulls/13128\",\n+  \"id\": 651671568,\n+  \"node_id\": \"MDExOlB1bGxSZXF1ZXN0NjUxNjcxNTY4\",\n+  \"html_url\": \"https://github.com/discourse/discourse/pull/13128\",\n+  \"diff_url\": \"https://github.com/discourse/discourse/pull/13128.diff\",\n+  \"patch_url\": \"https://github.com/discourse/discourse/pull/13128.patch\",\n+  \"issue_url\": \"https://api.github.com/repos/discourse/discourse/issues/13128\",\n+  \"number\": 13128,\n+  \"state\": \"closed\",\n+  \"locked\": false,\n+  \"title\": \"simplify post and topic deletion language\",\n+  \"user\": {\n+    \"login\": \"coding-horror\",\n+    \"id\": 1522517,\n+    \"node_id\": \"MDQ6VXNlcjE1MjI1MTc=\",\n+    \"avatar_url\": \"https://avatars.githubusercontent.com/u/1522517?v=4\",\n+    \"gravatar_id\": \"\",\n+    \"url\": \"https://api.github.com/users/coding-horror\",\n+    \"html_url\": \"https://github.com/coding-horror\",\n+    \"followers_url\": \"https://api.github.com/users/coding-horror/followers\",\n+    \"following_url\": \"https://api.github.com/users/coding-horror/following{/other_user}\",\n+    \"gists_url\": \"https://api.github.com/users/coding-horror/gists{/gist_id}\",\n+    \"starred_url\": \"https://api.github.com/users/coding-horror/starred{/owner}{/repo}\",\n+    \"subscriptions_url\": \"https://api.github.com/users/coding-horror/subscriptions\",\n+    \"organizations_url\": \"https://api.github.com/users/coding-horror/orgs\",\n+    \"repos_url\": \"https://api.github.com/users/coding-horror/repos\",\n+    \"events_url\": \"https://api.github.com/users/coding-horror/events{/privacy}\",\n+    \"received_events_url\": \"https://api.github.com/users/coding-horror/received_events\",\n+    \"type\": \"User\",\n+    \"site_admin\": false\n+  },\n+  \"body\": \"based on feedback from Matt Haughey, we don't need to use so many words when describing a deleted topic or post.\\r\\n\\r\\n<!-- NOTE: All pull requests should have tests (rspec in Ruby, qunit in JavaScript). If your code does not include test coverage, please include an explanation of why it was omitted. -->\\r\\n\",\n+  \"created_at\": \"2021-05-24T22:16:01Z\",\n+  \"updated_at\": \"2021-05-25T02:04:11Z\",\n+  \"closed_at\": \"2021-05-25T02:04:10Z\",\n+  \"merged_at\": \"2021-05-25T02:04:10Z\",\n+  \"merge_commit_sha\": \"50926f614342336793f1b78672b387d545d48de3\",\n+  \"assignee\": null,\n+  \"assignees\": [\n+\n+  ],\n+  \"requested_reviewers\": [\n+\n+  ],\n+  \"requested_teams\": [\n+\n+  ],\n+  \"labels\": [\n+\n+  ],\n+  \"milestone\": null,\n+  \"draft\": false,\n+  \"commits_url\": \"https://api.github.com/repos/discourse/discourse/pulls/13128/commits\",\n+  \"review_comments_url\": \"https://api.github.com/repos/discourse/discourse/pulls/13128/comments\",\n+  \"review_comment_url\": \"https://api.github.com/repos/discourse/discourse/pulls/comments{/number}\",\n+  \"comments_url\": \"https://api.github.com/repos/discourse/discourse/issues/13128/comments\",\n+  \"statuses_url\": \"https://api.github.com/repos/discourse/discourse/statuses/929e4ee5e93e53f45c7be78fcf81b734120af9c0\",\n+  \"head\": {\n+    \"label\": \"discourse:simplify-deleted-post-copy\",\n+    \"ref\": \"simplify-deleted-post-copy\",\n+    \"sha\": \"929e4ee5e93e53f45c7be78fcf81b734120af9c0\",\n+    \"user\": {\n+      \"login\": \"discourse\",\n+      \"id\": 3220138,\n+      \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+      \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+      \"gravatar_id\": \"\",\n+      \"url\": \"https://api.github.com/users/discourse\",\n+      \"html_url\": \"https://github.com/discourse\",\n+      \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+      \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+      \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+      \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+      \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+      \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+      \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+      \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+      \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+      \"type\": \"Organization\",\n+      \"site_admin\": false\n+    },\n+    \"repo\": {\n+      \"id\": 7569578,\n+      \"node_id\": \"MDEwOlJlcG9zaXRvcnk3NTY5NTc4\",\n+      \"name\": \"discourse\",\n+      \"full_name\": \"discourse/discourse\",\n+      \"private\": false,\n+      \"owner\": {\n+        \"login\": \"discourse\",\n+        \"id\": 3220138,\n+        \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+        \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+        \"gravatar_id\": \"\",\n+        \"url\": \"https://api.github.com/users/discourse\",\n+        \"html_url\": \"https://github.com/discourse\",\n+        \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+        \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+        \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+        \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+        \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+        \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+        \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+        \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+        \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+        \"type\": \"Organization\",\n+        \"site_admin\": false\n+      },\n+      \"html_url\": \"https://github.com/discourse/discourse\",\n+      \"description\": \"A platform for community discussion. Free, open, simple.\",\n+      \"fork\": false,\n+      \"url\": \"https://api.github.com/repos/discourse/discourse\",\n+      \"forks_url\": \"https://api.github.com/repos/discourse/discourse/forks\",\n+      \"keys_url\": \"https://api.github.com/repos/discourse/discourse/keys{/key_id}\",\n+      \"collaborators_url\": \"https://api.github.com/repos/discourse/discourse/collaborators{/collaborator}\",\n+      \"teams_url\": \"https://api.github.com/repos/discourse/discourse/teams\",\n+      \"hooks_url\": \"https://api.github.com/repos/discourse/discourse/hooks\",\n+      \"issue_events_url\": \"https://api.github.com/repos/discourse/discourse/issues/events{/number}\",\n+      \"events_url\": \"https://api.github.com/repos/discourse/discourse/events\",\n+      \"assignees_url\": \"https://api.github.com/repos/discourse/discourse/assignees{/user}\",\n+      \"branches_url\": \"https://api.github.com/repos/discourse/discourse/branches{/branch}\",\n+      \"tags_url\": \"https://api.github.com/repos/discourse/discourse/tags\",\n+      \"blobs_url\": \"https://api.github.com/repos/discourse/discourse/git/blobs{/sha}\",\n+      \"git_tags_url\": \"https://api.github.com/repos/discourse/discourse/git/tags{/sha}\",\n+      \"git_refs_url\": \"https://api.github.com/repos/discourse/discourse/git/refs{/sha}\",\n+      \"trees_url\": \"https://api.github.com/repos/discourse/discourse/git/trees{/sha}\",\n+      \"statuses_url\": \"https://api.github.com/repos/discourse/discourse/statuses/{sha}\",\n+      \"languages_url\": \"https://api.github.com/repos/discourse/discourse/languages\",\n+      \"stargazers_url\": \"https://api.github.com/repos/discourse/discourse/stargazers\",\n+      \"contributors_url\": \"https://api.github.com/repos/discourse/discourse/contributors\",\n+      \"subscribers_url\": \"https://api.github.com/repos/discourse/discourse/subscribers\",\n+      \"subscription_url\": \"https://api.github.com/repos/discourse/discourse/subscription\",\n+      \"commits_url\": \"https://api.github.com/repos/discourse/discourse/commits{/sha}\",\n+      \"git_commits_url\": \"https://api.github.com/repos/discourse/discourse/git/commits{/sha}\",\n+      \"comments_url\": \"https://api.github.com/repos/discourse/discourse/comments{/number}\",\n+      \"issue_comment_url\": \"https://api.github.com/repos/discourse/discourse/issues/comments{/number}\",\n+      \"contents_url\": \"https://api.github.com/repos/discourse/discourse/contents/{+path}\",\n+      \"compare_url\": \"https://api.github.com/repos/discourse/discourse/compare/{base}...{head}\",\n+      \"merges_url\": \"https://api.github.com/repos/discourse/discourse/merges\",\n+      \"archive_url\": \"https://api.github.com/repos/discourse/discourse/{archive_format}{/ref}\",\n+      \"downloads_url\": \"https://api.github.com/repos/discourse/discourse/downloads\",\n+      \"issues_url\": \"https://api.github.com/repos/discourse/discourse/issues{/number}\",\n+      \"pulls_url\": \"https://api.github.com/repos/discourse/discourse/pulls{/number}\",\n+      \"milestones_url\": \"https://api.github.com/repos/discourse/discourse/milestones{/number}\",\n+      \"notifications_url\": \"https://api.github.com/repos/discourse/discourse/notifications{?since,all,participating}\",\n+      \"labels_url\": \"https://api.github.com/repos/discourse/discourse/labels{/name}\",\n+      \"releases_url\": \"https://api.github.com/repos/discourse/discourse/releases{/id}\",\n+      \"deployments_url\": \"https://api.github.com/repos/discourse/discourse/deployments\",\n+      \"created_at\": \"2013-01-12T00:25:55Z\",\n+      \"updated_at\": \"2021-05-26T11:54:17Z\",\n+      \"pushed_at\": \"2021-05-26T14:34:39Z\",\n+      \"git_url\": \"git://github.com/discourse/discourse.git\",\n+      \"ssh_url\": \"git@github.com:discourse/discourse.git\",\n+      \"clone_url\": \"https://github.com/discourse/discourse.git\",\n+      \"svn_url\": \"https://github.com/discourse/discourse\",\n+      \"homepage\": \"https://www.discourse.org\",\n+      \"size\": 369664,\n+      \"stargazers_count\": 33354,\n+      \"watchers_count\": 33354,\n+      \"language\": \"Ruby\",\n+      \"has_issues\": false,\n+      \"has_projects\": false,\n+      \"has_downloads\": true,\n+      \"has_wiki\": false,\n+      \"has_pages\": false,\n+      \"forks_count\": 7246,\n+      \"mirror_url\": null,\n+      \"archived\": false,\n+      \"disabled\": false,\n+      \"open_issues_count\": 31,\n+      \"license\": {\n+        \"key\": \"other\",\n+        \"name\": \"Other\",\n+        \"spdx_id\": \"NOASSERTION\",\n+        \"url\": null,\n+        \"node_id\": \"MDc6TGljZW5zZTA=\"\n+      },\n+      \"forks\": 7246,\n+      \"open_issues\": 31,\n+      \"watchers\": 33354,\n+      \"default_branch\": \"master\"\n+    }\n+  },\n+  \"base\": {\n+    \"label\": \"discourse:master\",\n+    \"ref\": \"master\",\n+    \"sha\": \"b8a08d21e0e9c73f3fdd1ef99c6b8dfe00f5c4f7\",\n+    \"user\": {\n+      \"login\": \"discourse\",\n+      \"id\": 3220138,\n+      \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+      \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+      \"gravatar_id\": \"\",\n+      \"url\": \"https://api.github.com/users/discourse\",\n+      \"html_url\": \"https://github.com/discourse\",\n+      \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+      \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+      \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+      \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+      \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+      \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+      \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+      \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+      \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+      \"type\": \"Organization\",\n+      \"site_admin\": false\n+    },\n+    \"repo\": {\n+      \"id\": 7569578,\n+      \"node_id\": \"MDEwOlJlcG9zaXRvcnk3NTY5NTc4\",\n+      \"name\": \"discourse\",\n+      \"full_name\": \"discourse/discourse\",\n+      \"private\": false,\n+      \"owner\": {\n+        \"login\": \"discourse\",\n+        \"id\": 3220138,\n+        \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjMyMjAxMzg=\",\n+        \"avatar_url\": \"https://avatars.githubusercontent.com/u/3220138?v=4\",\n+        \"gravatar_id\": \"\",\n+        \"url\": \"https://api.github.com/users/discourse\",\n+        \"html_url\": \"https://github.com/discourse\",\n+        \"followers_url\": \"https://api.github.com/users/discourse/followers\",\n+        \"following_url\": \"https://api.github.com/users/discourse/following{/other_user}\",\n+        \"gists_url\": \"https://api.github.com/users/discourse/gists{/gist_id}\",\n+        \"starred_url\": \"https://api.github.com/users/discourse/starred{/owner}{/repo}\",\n+        \"subscriptions_url\": \"https://api.github.com/users/discourse/subscriptions\",\n+        \"organizations_url\": \"https://api.github.com/users/discourse/orgs\",\n+        \"repos_url\": \"https://api.github.com/users/discourse/repos\",\n+        \"events_url\": \"https://api.github.com/users/discourse/events{/privacy}\",\n+        \"received_events_url\": \"https://api.github.com/users/discourse/received_events\",\n+        \"type\": \"Organization\",\n+        \"site_admin\": false\n+      },\n+      \"html_url\": \"https://github.com/discourse/discourse\",\n+      \"description\": \"A platform for community discussion. Free, open, simple.\",\n+      \"fork\": false,\n+      \"url\": \"https://api.github.com/repos/discourse/discourse\",\n+      \"forks_url\": \"https://api.github.com/repos/discourse/discourse/forks\",\n+      \"keys_url\": \"https://api.github.com/repos/discourse/discourse/keys{/key_id}\",\n+      \"collaborators_url\": \"https://api.github.com/repos/discourse/discourse/collaborators{/collaborator}\",\n+      \"teams_url\": \"https://api.github.com/repos/discourse/discourse/teams\",\n+      \"hooks_url\": \"https://api.github.com/repos/discourse/discourse/hooks\",\n+      \"issue_events_url\": \"https://api.github.com/repos/discourse/discourse/issues/events{/number}\",\n+      \"events_url\": \"https://api.github.com/repos/discourse/discourse/events\",\n+      \"assignees_url\": \"https://api.github.com/repos/discourse/discourse/assignees{/user}\",\n+      \"branches_url\": \"https://api.github.com/repos/discourse/discourse/branches{/branch}\",\n+      \"tags_url\": \"https://api.github.com/repos/discourse/discourse/tags\",\n+      \"blobs_url\": \"https://api.github.com/repos/discourse/discourse/git/blobs{/sha}\",\n+      \"git_tags_url\": \"https://api.github.com/repos/discourse/discourse/git/tags{/sha}\",\n+      \"git_refs_url\": \"https://api.github.com/repos/discourse/discourse/git/refs{/sha}\",\n+      \"trees_url\": \"https://api.github.com/repos/discourse/discourse/git/trees{/sha}\",\n+      \"statuses_url\": \"https://api.github.com/repos/discourse/discourse/statuses/{sha}\",\n+      \"languages_url\": \"https://api.github.com/repos/discourse/discourse/languages\",\n+      \"stargazers_url\": \"https://api.github.com/repos/discourse/discourse/stargazers\",\n+      \"contributors_url\": \"https://api.github.com/repos/discourse/discourse/contributors\",\n+      \"subscribers_url\": \"https://api.github.com/repos/discourse/discourse/subscribers\",\n+      \"subscription_url\": \"https://api.github.com/repos/discourse/discourse/subscription\",\n+      \"commits_url\": \"https://api.github.com/repos/discourse/discourse/commits{/sha}\",\n+      \"git_commits_url\": \"https://api.github.com/repos/discourse/discourse/git/commits{/sha}\",\n+      \"comments_url\": \"https://api.github.com/repos/discourse/discourse/comments{/number}\",\n+      \"issue_comment_url\": \"https://api.github.com/repos/discourse/discourse/issues/comments{/number}\",\n+      \"contents_url\": \"https://api.github.com/repos/discourse/discourse/contents/{+path}\",\n+      \"compare_url\": \"https://api.github.com/repos/discourse/discourse/compare/{base}...{head}\",\n+      \"merges_url\": \"https://api.github.com/repos/discourse/discourse/merges\",\n+      \"archive_url\": \"https://api.github.com/repos/discourse/discourse/{archive_format}{/ref}\",\n+      \"downloads_url\": \"https://api.github.com/repos/discourse/discourse/downloads\",\n+      \"issues_url\": \"https://api.github.com/repos/discourse/discourse/issues{/number}\",\n+      \"pulls_url\": \"https://api.github.com/repos/discourse/discourse/pulls{/number}\",\n+      \"milestones_url\": \"https://api.github.com/repos/discourse/discourse/milestones{/number}\",\n+      \"notifications_url\": \"https://api.github.com/repos/discourse/discourse/notifications{?since,all,participating}\",\n+      \"labels_url\": \"https://api.github.com/repos/discourse/discourse/labels{/name}\",\n+      \"releases_url\": \"https://api.github.com/repos/discourse/discourse/releases{/id}\",\n+      \"deployments_url\": \"https://api.github.com/repos/discourse/discourse/deployments\",\n+      \"created_at\": \"2013-01-12T00:25:55Z\",\n+      \"updated_at\": \"2021-05-26T11:54:17Z\",\n+      \"pushed_at\": \"2021-05-26T14:34:39Z\",\n+      \"git_url\": \"git://github.com/discourse/discourse.git\",\n+      \"ssh_url\": \"git@github.com:discourse/discourse.git\",\n+      \"clone_url\": \"https://github.com/discourse/discourse.git\",\n+      \"svn_url\": \"https://github.com/discourse/discourse\",\n+      \"homepage\": \"https://www.discourse.org\",\n+      \"size\": 369664,\n+      \"stargazers_count\": 33354,\n+      \"watchers_count\": 33354,\n+      \"language\": \"Ruby\",\n+      \"has_issues\": false,\n+      \"has_projects\": false,\n+      \"has_downloads\": true,\n+      \"has_wiki\": false,\n+      \"has_pages\": false,\n+      \"forks_count\": 7246,\n+      \"mirror_url\": null,\n+      \"archived\": false,\n+      \"disabled\": false,\n+      \"open_issues_count\": 31,\n+      \"license\": {\n+        \"key\": \"other\",\n+        \"name\": \"Other\",\n+        \"spdx_id\": \"NOASSERTION\",\n+        \"url\": null,\n+        \"node_id\": \"MDc6TGljZW5zZTA=\"\n+      },\n+      \"forks\": 7246,\n+      \"open_issues\": 31,\n+      \"watchers\": 33354,\n+      \"default_branch\": \"master\"\n+    }\n+  },\n+  \"_links\": {\n+    \"self\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/pulls/13128\"\n+    },\n+    \"html\": {\n+      \"href\": \"https://github.com/discourse/discourse/pull/13128\"\n+    },\n+    \"issue\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/issues/13128\"\n+    },\n+    \"comments\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/issues/13128/comments\"\n+    },\n+    \"review_comments\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/pulls/13128/comments\"\n+    },\n+    \"review_comment\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/pulls/comments{/number}\"\n+    },\n+    \"commits\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/pulls/13128/commits\"\n+    },\n+    \"statuses\": {\n+      \"href\": \"https://api.github.com/repos/discourse/discourse/statuses/929e4ee5e93e53f45c7be78fcf81b734120af9c0\"\n+    }\n+  },\n+  \"author_association\": \"MEMBER\",\n+  \"auto_merge\": null,\n+  \"active_lock_reason\": null,\n+  \"merged\": true,\n+  \"mergeable\": null,\n+  \"rebaseable\": null,\n+  \"mergeable_state\": \"unknown\",\n+  \"merged_by\": {\n+    \"login\": \"martin-brennan\",\n+    \"id\": 920448,\n+    \"node_id\": \"MDQ6VXNlcjkyMDQ0OA==\",\n+    \"avatar_url\": \"https://avatars.githubusercontent.com/u/920448?v=4\",\n+    \"gravatar_id\": \"\",\n+    \"url\": \"https://api.github.com/users/martin-brennan\",\n+    \"html_url\": \"https://github.com/martin-brennan\",\n+    \"followers_url\": \"https://api.github.com/users/martin-brennan/followers\",\n+    \"following_url\": \"https://api.github.com/users/martin-brennan/following{/other_user}\",\n+    \"gists_url\": \"https://api.github.com/users/martin-brennan/gists{/gist_id}\",\n+    \"starred_url\": \"https://api.github.com/users/martin-brennan/starred{/owner}{/repo}\",\n+    \"subscriptions_url\": \"https://api.github.com/users/martin-brennan/subscriptions\",\n+    \"organizations_url\": \"https://api.github.com/users/martin-brennan/orgs\",\n+    \"repos_url\": \"https://api.github.com/users/martin-brennan/repos\",\n+    \"events_url\": \"https://api.github.com/users/martin-brennan/events{/privacy}\",\n+    \"received_events_url\": \"https://api.github.com/users/martin-brennan/received_events\",\n+    \"type\": \"User\",\n+    \"site_admin\": false\n+  },\n+  \"comments\": 0,\n+  \"review_comments\": 0,\n+  \"maintainer_can_modify\": false,\n+  \"commits\": 3,\n+  \"additions\": 10,\n+  \"deletions\": 19,\n+  \"changed_files\": 5\n+}\n\\ No newline at end of file"
    },
    {
      "sha": "7cc64a5894cb0e144d4f62c692d0309d296b8adc",
      "filename": "spec/fixtures/onebox/githubactions_pr_run.response",
      "status": "added",
      "additions": 109,
      "deletions": 0,
      "changes": 109,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_pr_run.response",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubactions_pr_run.response",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/fixtures/onebox/githubactions_pr_run.response?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,109 @@\n+{\n+  \"id\": 2660861130,\n+  \"node_id\": \"MDg6Q2hlY2tSdW4yNjYwODYxMTMw\",\n+  \"head_sha\": \"929e4ee5e93e53f45c7be78fcf81b734120af9c0\",\n+  \"external_id\": \"ca395085-040a-526b-2ce8-bdc85f692774\",\n+  \"url\": \"https://api.github.com/repos/discourse/discourse/check-runs/2660861130\",\n+  \"html_url\": \"https://github.com/discourse/discourse/runs/2660861130\",\n+  \"details_url\": \"https://github.com/discourse/discourse/runs/2660861130\",\n+  \"status\": \"completed\",\n+  \"conclusion\": \"success\",\n+  \"started_at\": \"2021-05-25T01:10:38Z\",\n+  \"completed_at\": \"2021-05-25T01:15:51Z\",\n+  \"output\": {\n+    \"title\": null,\n+    \"summary\": null,\n+    \"text\": null,\n+    \"annotations_count\": 0,\n+    \"annotations_url\": \"https://api.github.com/repos/discourse/discourse/check-runs/2660861130/annotations\"\n+  },\n+  \"name\": \"run\",\n+  \"check_suite\": {\n+    \"id\": 2820222471\n+  },\n+  \"app\": {\n+    \"id\": 15368,\n+    \"slug\": \"github-actions\",\n+    \"node_id\": \"MDM6QXBwMTUzNjg=\",\n+    \"owner\": {\n+      \"login\": \"github\",\n+      \"id\": 9919,\n+      \"node_id\": \"MDEyOk9yZ2FuaXphdGlvbjk5MTk=\",\n+      \"avatar_url\": \"https://avatars.githubusercontent.com/u/9919?v=4\",\n+      \"gravatar_id\": \"\",\n+      \"url\": \"https://api.github.com/users/github\",\n+      \"html_url\": \"https://github.com/github\",\n+      \"followers_url\": \"https://api.github.com/users/github/followers\",\n+      \"following_url\": \"https://api.github.com/users/github/following{/other_user}\",\n+      \"gists_url\": \"https://api.github.com/users/github/gists{/gist_id}\",\n+      \"starred_url\": \"https://api.github.com/users/github/starred{/owner}{/repo}\",\n+      \"subscriptions_url\": \"https://api.github.com/users/github/subscriptions\",\n+      \"organizations_url\": \"https://api.github.com/users/github/orgs\",\n+      \"repos_url\": \"https://api.github.com/users/github/repos\",\n+      \"events_url\": \"https://api.github.com/users/github/events{/privacy}\",\n+      \"received_events_url\": \"https://api.github.com/users/github/received_events\",\n+      \"type\": \"Organization\",\n+      \"site_admin\": false\n+    },\n+    \"name\": \"GitHub Actions\",\n+    \"description\": \"Automate your workflow from idea to production\",\n+    \"external_url\": \"https://help.github.com/en/actions\",\n+    \"html_url\": \"https://github.com/apps/github-actions\",\n+    \"created_at\": \"2018-07-30T09:30:17Z\",\n+    \"updated_at\": \"2019-12-10T19:04:12Z\",\n+    \"permissions\": {\n+      \"actions\": \"write\",\n+      \"checks\": \"write\",\n+      \"contents\": \"write\",\n+      \"deployments\": \"write\",\n+      \"discussions\": \"write\",\n+      \"issues\": \"write\",\n+      \"metadata\": \"read\",\n+      \"organization_packages\": \"write\",\n+      \"packages\": \"write\",\n+      \"pages\": \"write\",\n+      \"pull_requests\": \"write\",\n+      \"repository_hooks\": \"write\",\n+      \"repository_projects\": \"write\",\n+      \"security_events\": \"write\",\n+      \"statuses\": \"write\",\n+      \"vulnerability_alerts\": \"read\"\n+    },\n+    \"events\": [\n+      \"check_run\",\n+      \"check_suite\",\n+      \"create\",\n+      \"delete\",\n+      \"deployment\",\n+      \"deployment_status\",\n+      \"discussion\",\n+      \"discussion_comment\",\n+      \"fork\",\n+      \"gollum\",\n+      \"issues\",\n+      \"issue_comment\",\n+      \"label\",\n+      \"milestone\",\n+      \"page_build\",\n+      \"project\",\n+      \"project_card\",\n+      \"project_column\",\n+      \"public\",\n+      \"pull_request\",\n+      \"pull_request_review\",\n+      \"pull_request_review_comment\",\n+      \"push\",\n+      \"registry_package\",\n+      \"release\",\n+      \"repository\",\n+      \"repository_dispatch\",\n+      \"status\",\n+      \"watch\",\n+      \"workflow_dispatch\",\n+      \"workflow_run\"\n+    ]\n+  },\n+  \"pull_requests\": [\n+\n+  ]\n+}\n\\ No newline at end of file"
    },
    {
      "sha": "f2c8c94a42b38d1488489ff353a112f6429eea1d",
      "filename": "spec/fixtures/onebox/githubpullrequest.response",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubpullrequest.response",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/fixtures/onebox/githubpullrequest.response",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/fixtures/onebox/githubpullrequest.response?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -26,7 +26,7 @@\n     \"received_events_url\": \"https://api.github.com/users/jamesaanderson/received_events\",\n     \"type\": \"User\"\n   },\n-  \"body\": \"http://meta.discourse.org/t/audio-html5-tag/8168\",\n+  \"body\": \"http://meta.discourse.org/t/audio-html5-tag/8168\\n<!-- test comment -->\",\n   \"created_at\": \"2013-07-26T02:05:53Z\",\n   \"updated_at\": \"2013-07-26T15:31:57Z\",\n   \"closed_at\": \"2013-07-26T15:30:57Z\","
    },
    {
      "sha": "2e9182f00e7fd418686ed728554bc23aaeb6aed4",
      "filename": "spec/lib/onebox/engine/github_actions_onebox_spec.rb",
      "status": "added",
      "additions": 56,
      "deletions": 0,
      "changes": 56,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/lib/onebox/engine/github_actions_onebox_spec.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/lib/onebox/engine/github_actions_onebox_spec.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/lib/onebox/engine/github_actions_onebox_spec.rb?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -0,0 +1,56 @@\n+# frozen_string_literal: true\n+\n+require \"rails_helper\"\n+\n+describe Onebox::Engine::GithubActionsOnebox do\n+  describe \"PR check run\" do\n+    before do\n+      @link = \"https://github.com/discourse/discourse/pull/13128/checks?check_run_id=2660861130\"\n+\n+      stub_request(:get, \"https://api.github.com/repos/discourse/discourse/pulls/13128\")\n+        .to_return(status: 200, body: onebox_response(\"githubactions_pr\"))\n+\n+      stub_request(:get, \"https://api.github.com/repos/discourse/discourse/check-runs/2660861130\")\n+        .to_return(status: 200, body: onebox_response(\"githubactions_pr_run\"))\n+    end\n+\n+    include_context \"engines\"\n+    it_behaves_like \"an engine\"\n+\n+    describe \"#to_html\" do\n+      it \"includes status\" do\n+        expect(html).to include(\"success\")\n+      end\n+\n+      it \"includes title\" do\n+        expect(html).to include(\"simplify post and topic deletion language\")\n+      end\n+    end\n+  end\n+\n+  describe \"GitHub Actions run\" do\n+    before do\n+      @link = \"https://github.com/discourse/discourse/actions/runs/873214216\"\n+\n+      stub_request(:get, \"https://api.github.com/repos/discourse/discourse/actions/runs/873214216\")\n+        .to_return(status: 200, body: onebox_response(\"githubactions_actions_run\"))\n+    end\n+\n+    include_context \"engines\"\n+    it_behaves_like \"an engine\"\n+\n+    describe \"#to_html\" do\n+      it \"includes status\" do\n+        expect(html).to include(\"success\")\n+      end\n+\n+      it \"includes title\" do\n+        expect(html).to include(\"Remove deleted_by_author key\")\n+      end\n+\n+      it \"includes action name\" do\n+        expect(html).to include(\"Linting\")\n+      end\n+    end\n+  end\n+end"
    },
    {
      "sha": "78f2520379a6656c8d575c38eb00c63be8d0f076",
      "filename": "spec/lib/onebox/engine/github_pullrequest_onebox_spec.rb",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/discourse/discourse/blob/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/lib/onebox/engine/github_pullrequest_onebox_spec.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/723d7de18c8dda9889ad65ea58dd5df691bc91cc/spec/lib/onebox/engine/github_pullrequest_onebox_spec.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/spec/lib/onebox/engine/github_pullrequest_onebox_spec.rb?ref=723d7de18c8dda9889ad65ea58dd5df691bc91cc",
      "patch": "@@ -46,8 +46,9 @@\n       expect(html).to include(\"1\")\n     end\n \n-    it \"includes the body\" do\n+    it \"includes the body without comments\" do\n       expect(html).to include(\"http://meta.discourse.org/t/audio-html5-tag/8168\")\n+      expect(html).not_to include(\"test comment\")\n     end\n   end\n end"
    }
  ]
}
