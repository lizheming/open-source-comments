{
  "sha": "76ce814a62033296156d9e0886117ef283e1e9f2",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo3NmNlODE0YTYyMDMzMjk2MTU2ZDllMDg4NjExN2VmMjgzZTFlOWYy",
  "commit": {
    "author": {
      "name": "Guo Xiang Tan",
      "email": "gxtan1990@gmail.com",
      "date": "2020-06-03T07:36:50Z"
    },
    "committer": {
      "name": "Guo Xiang Tan",
      "email": "gxtan1990@gmail.com",
      "date": "2020-06-03T07:36:50Z"
    },
    "message": "DEV: Use `safe_each_connection` patch when preloading Rails.\n\nThis is to ensure we still boot even if there is a problem with any of\nthe databases.",
    "tree": {
      "sha": "6d2c3b6d536e3527c7aa0b5da1f133eb91c9c3dc",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/6d2c3b6d536e3527c7aa0b5da1f133eb91c9c3dc"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/76ce814a62033296156d9e0886117ef283e1e9f2",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMOJGkc46I9vMVlDg+9EQF5qsHyAFAl7XUzYACgkQ+9EQF5qs\nHyDTsQ//WYBj1iXOfgE2YRcq1GMjogYcFafVw364BjeMokwakWXwGaq1FqXjs1Zk\ncoiOQ6d7JWZTIcvrjcZHrMsOoS7GnG48ghwUtJ8g7LCFVZi9jaKmnp86dTdU5jYH\nTBYqOmMpxLnXFZfANYhOib6Tbm5QIXNdMubInTvakw4fAPpJiZe/gq4OjXzxL6g/\nm6xv2SN6CTpC3XmP/8MeBU9Ks20xGQW7/cgt8kxDUer14qJgbIadEaJrXb86NXO6\nHkAQVV0sUbz3VVlPxCgS3fR62v0COb/wOyd5YS7d+m06nZfJiVEpJcGsF424vkvV\n2ARdUeFoBr9e4SHWd4s5mVR1NQL+1J8eLoMq7pyG2yRP8GNNFy+IzFFUvnWh1m5y\nYCymsCHyGBOlm80XgkZkAlKu4vrUWMCazaaQjYKL+dKLVSQDf7tcSxbgixhs4fJk\nq/wrsSP670v1CewnTs+dwCqxOiXKGi+cDNFbl58XXRPrJJlbjKgQD7ASB2Enmfsj\nupG4ks82r2Hfo9DHe9LJe92VNJpP5fOYbuRaji+P7lLV5E7rklNBU5DCgoPf2ILb\nyeRRuZ6Tyeti8vzvrQLm3MkXrdzmwmwBp7tWDT3w9HBOwlXBDsoZfI5wqLMbr+gu\nnzMrekXAkW9dnu6VVi+tx02xLZ7fV7P0sZo2AJL4EyTsc9BuGJ0=\n=ZGu4\n-----END PGP SIGNATURE-----",
      "payload": "tree 6d2c3b6d536e3527c7aa0b5da1f133eb91c9c3dc\nparent a4a33fccb07f511b94584bc3886f42f4e8c86a9f\nauthor Guo Xiang Tan <gxtan1990@gmail.com> 1591169810 +0800\ncommitter Guo Xiang Tan <gxtan1990@gmail.com> 1591169810 +0800\n\nDEV: Use `safe_each_connection` patch when preloading Rails.\n\nThis is to ensure we still boot even if there is a problem with any of\nthe databases.\n"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/76ce814a62033296156d9e0886117ef283e1e9f2",
  "html_url": "https://github.com/discourse/discourse/commit/76ce814a62033296156d9e0886117ef283e1e9f2",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/76ce814a62033296156d9e0886117ef283e1e9f2/comments",
  "author": {
    "login": "tgxworld",
    "id": 4335742,
    "node_id": "MDQ6VXNlcjQzMzU3NDI=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/4335742?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tgxworld",
    "html_url": "https://github.com/tgxworld",
    "followers_url": "https://api.github.com/users/tgxworld/followers",
    "following_url": "https://api.github.com/users/tgxworld/following{/other_user}",
    "gists_url": "https://api.github.com/users/tgxworld/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tgxworld/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tgxworld/subscriptions",
    "organizations_url": "https://api.github.com/users/tgxworld/orgs",
    "repos_url": "https://api.github.com/users/tgxworld/repos",
    "events_url": "https://api.github.com/users/tgxworld/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tgxworld/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tgxworld",
    "id": 4335742,
    "node_id": "MDQ6VXNlcjQzMzU3NDI=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/4335742?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tgxworld",
    "html_url": "https://github.com/tgxworld",
    "followers_url": "https://api.github.com/users/tgxworld/followers",
    "following_url": "https://api.github.com/users/tgxworld/following{/other_user}",
    "gists_url": "https://api.github.com/users/tgxworld/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tgxworld/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tgxworld/subscriptions",
    "organizations_url": "https://api.github.com/users/tgxworld/orgs",
    "repos_url": "https://api.github.com/users/tgxworld/repos",
    "events_url": "https://api.github.com/users/tgxworld/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tgxworld/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a4a33fccb07f511b94584bc3886f42f4e8c86a9f",
      "url": "https://api.github.com/repos/discourse/discourse/commits/a4a33fccb07f511b94584bc3886f42f4e8c86a9f",
      "html_url": "https://github.com/discourse/discourse/commit/a4a33fccb07f511b94584bc3886f42f4e8c86a9f"
    }
  ],
  "stats": {
    "total": 2,
    "additions": 1,
    "deletions": 1
  },
  "files": [
    {
      "sha": "5da2acb15e9c21bf7f8ca120ca7017fc8b2c09d6",
      "filename": "lib/discourse.rb",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/discourse/discourse/blob/76ce814a62033296156d9e0886117ef283e1e9f2/lib/discourse.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/76ce814a62033296156d9e0886117ef283e1e9f2/lib/discourse.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/discourse.rb?ref=76ce814a62033296156d9e0886117ef283e1e9f2",
      "patch": "@@ -838,7 +838,7 @@ def self.preload_rails!\n \n     # load up schema cache for all multisite assuming all dbs have\n     # an identical schema\n-    RailsMultisite::ConnectionManagement.each_connection do\n+    RailsMultisite::ConnectionManagement.safe_each_connection do\n       dup_cache = schema_cache.dup\n       # this line is not really needed, but just in case the\n       # underlying implementation changes lets give it a shot"
    }
  ]
}
