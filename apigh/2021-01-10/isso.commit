{
  "sha": "944e4846847abc9b252f9b016158e336ffb77443",
  "node_id": "MDY6Q29tbWl0NjI2ODQxOTo5NDRlNDg0Njg0N2FiYzliMjUyZjliMDE2MTU4ZTMzNmZmYjc3NDQz",
  "commit": {
    "author": {
      "name": "fluffy",
      "email": "fluffy@beesbuzz.biz",
      "date": "2020-10-10T20:21:05Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-10-10T20:21:05Z"
    },
    "message": "Add HTML escaping to code blocks (#631)",
    "tree": {
      "sha": "21e1149788ed0de0320507b80d60d7ac516a2db1",
      "url": "https://api.github.com/repos/posativ/isso/git/trees/21e1149788ed0de0320507b80d60d7ac516a2db1"
    },
    "url": "https://api.github.com/repos/posativ/isso/git/commits/944e4846847abc9b252f9b016158e336ffb77443",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfghexCRBK7hj4Ov3rIwAAdHIIAFWNFRrdc3NW7mWV1M8J28j3\nO32VMsyjAj6isfNROXbjisHfaRcRzLnFpyBMXfZ//3+y+6JTddY/du6lBDp9QYqn\n6RbcbzG0M2F58sy6GAHR+kXAvTHobjjAy8PytppBtwdD/5+IUqieuntv/MkvZuDZ\n8pxqhvXj3A0okPOcICn5tquO9le20JX8OfDl7PcbRLGcRJmcDpNxrBaDjuzfT+0L\n4+aVKyZ0kPwl1yG/hL2Mbw1ki8VwQfyEhUcexm7ih7fJ83pBbvvmoCN0tZ5hNAZ7\nfN9y/VPkMRuHB4On749Wv89dZATVaUQHXNvE1Tq3HLya0gMVaR5StbOo+J2342w=\n=UJg+\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 21e1149788ed0de0320507b80d60d7ac516a2db1\nparent f4d2705d4f1b51f444d0629355a6fcbcec8d57b5\nauthor fluffy <fluffy@beesbuzz.biz> 1602361265 -0700\ncommitter GitHub <noreply@github.com> 1602361265 +0000\n\nAdd HTML escaping to code blocks (#631)\n\n"
    }
  },
  "url": "https://api.github.com/repos/posativ/isso/commits/944e4846847abc9b252f9b016158e336ffb77443",
  "html_url": "https://github.com/posativ/isso/commit/944e4846847abc9b252f9b016158e336ffb77443",
  "comments_url": "https://api.github.com/repos/posativ/isso/commits/944e4846847abc9b252f9b016158e336ffb77443/comments",
  "author": {
    "login": "fluffy-critter",
    "id": 347162,
    "node_id": "MDQ6VXNlcjM0NzE2Mg==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/347162?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fluffy-critter",
    "html_url": "https://github.com/fluffy-critter",
    "followers_url": "https://api.github.com/users/fluffy-critter/followers",
    "following_url": "https://api.github.com/users/fluffy-critter/following{/other_user}",
    "gists_url": "https://api.github.com/users/fluffy-critter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fluffy-critter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fluffy-critter/subscriptions",
    "organizations_url": "https://api.github.com/users/fluffy-critter/orgs",
    "repos_url": "https://api.github.com/users/fluffy-critter/repos",
    "events_url": "https://api.github.com/users/fluffy-critter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fluffy-critter/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f4d2705d4f1b51f444d0629355a6fcbcec8d57b5",
      "url": "https://api.github.com/repos/posativ/isso/commits/f4d2705d4f1b51f444d0629355a6fcbcec8d57b5",
      "html_url": "https://github.com/posativ/isso/commit/f4d2705d4f1b51f444d0629355a6fcbcec8d57b5"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 13,
    "deletions": 2
  },
  "files": [
    {
      "sha": "f92f30ad31eeabdce8de57922909a449c26d188b",
      "filename": "isso/tests/test_html.py",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/posativ/isso/blob/944e4846847abc9b252f9b016158e336ffb77443/isso/tests/test_html.py",
      "raw_url": "https://github.com/posativ/isso/raw/944e4846847abc9b252f9b016158e336ffb77443/isso/tests/test_html.py",
      "contents_url": "https://api.github.com/repos/posativ/isso/contents/isso/tests/test_html.py?ref=944e4846847abc9b252f9b016158e336ffb77443",
      "patch": "@@ -98,3 +98,13 @@ def test_render(self):\n         self.assertIn(renderer(\"http://example.org/ and sms:+1234567890\"),\n                       ['<p><a href=\"http://example.org/\" rel=\"nofollow noopener\">http://example.org/</a> and sms:+1234567890</p>',\n                        '<p><a rel=\"nofollow noopener\" href=\"http://example.org/\">http://example.org/</a> and sms:+1234567890</p>'])\n+\n+    def test_code_blocks(self):\n+        convert = html.Markdown(extensions=('fenced-code',))\n+        examples = [\n+            (\"```\\nThis is a code-fence. <hello>\\n```\", \"<p><pre><code>This is a code-fence. &lt;hello&gt;\\n</code></pre></p>\"),\n+            (\"```c++\\nThis is a code-fence. <hello>\\n```\", \"<p><pre><code class=\\\"c++\\\">This is a code-fence. &lt;hello&gt;\\n</code></pre></p>\"),\n+            (\"    This is a four-character indent. <hello>\", \"<p><pre><code>This is a four-character indent. &lt;hello&gt;\\n</code></pre></p>\")]\n+\n+        for (input, expected) in examples:\n+            self.assertEqual(convert(input), expected)"
    },
    {
      "sha": "a6945620aae2561832365458047fd623cb1742ab",
      "filename": "isso/utils/html.py",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/posativ/isso/blob/944e4846847abc9b252f9b016158e336ffb77443/isso/utils/html.py",
      "raw_url": "https://github.com/posativ/isso/raw/944e4846847abc9b252f9b016158e336ffb77443/isso/utils/html.py",
      "contents_url": "https://api.github.com/repos/posativ/isso/contents/isso/utils/html.py?ref=944e4846847abc9b252f9b016158e336ffb77443",
      "patch": "@@ -1,6 +1,7 @@\n # -*- encoding: utf-8 -*-\n \n from __future__ import unicode_literals\n+import html\n \n import bleach\n import misaka\n@@ -74,8 +75,8 @@ class Unofficial(misaka.HtmlRenderer):\n     \"\"\"\n \n     def blockcode(self, text, lang):\n-        lang = ' class=\"{0}\"'.format(lang) if lang else ''\n-        return \"<pre><code{1}>{0}</code></pre>\\n\".format(text, lang)\n+        lang = ' class=\"{0}\"'.format(html.escape(lang)) if lang else ''\n+        return \"<pre><code{1}>{0}</code></pre>\\n\".format(html.escape(text,False), lang)\n \n \n class Markup(object):"
    }
  ]
}
