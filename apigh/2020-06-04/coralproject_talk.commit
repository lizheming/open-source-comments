{
  "sha": "92c72f7041961e2ca055cf358a275f684a07c4a1",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6OTJjNzJmNzA0MTk2MWUyY2EwNTVjZjM1OGEyNzVmNjg0YTA3YzRhMQ==",
  "commit": {
    "author": {
      "name": "Wyatt Johnson",
      "email": "wyattjoh@gmail.com",
      "date": "2020-06-01T21:23:15Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-06-01T21:23:15Z"
    },
    "message": "fix: replace insert with push for slack channels (#2965)\n\nCo-authored-by: Kim Gardner <kgardnr@gmail.com>",
    "tree": {
      "sha": "da29e76a3d8689f3eea8d63da775ff355b28db04",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/da29e76a3d8689f3eea8d63da775ff355b28db04"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/92c72f7041961e2ca055cf358a275f684a07c4a1",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe1XHDCRBK7hj4Ov3rIwAAdHIIACsshN0yikDV5HNWIPHwP0XA\nLmMuoiNWsAwf1D+nnBAzKlJCMohxD6GiGAE8zOZrSrSxD2KGFImebp+KQFssdoDG\nxWQnTN4bDbg6h6AwG3jBEgQ5m4wHJF6dd3Wb7YJ9X62PxkGRjfd7th1qKn/EcCz8\nEVNga3Fjq/LR7NoNT6Adueb/d9VK2DbrDOav6CjkJVCknPiz1hxWZd0l13s24Zgv\nQsg4sMsfpMVrP3uXzfgOn3i2qb3gfpQcY7zkJ/z3fd+AKOggBvrU6WIRX1vE5XI1\nETo2Enm2EaKayAGC/iy2iqMW6zU8tcEZ9ZuhLXRoaoso8u2qSKP7gm+QyzwoZJc=\n=xj/r\n-----END PGP SIGNATURE-----\n",
      "payload": "tree da29e76a3d8689f3eea8d63da775ff355b28db04\nparent 08a9788bcc51d70309e39f7fc1336aac1e102409\nauthor Wyatt Johnson <wyattjoh@gmail.com> 1591046595 +0000\ncommitter GitHub <noreply@github.com> 1591046595 +0000\n\nfix: replace insert with push for slack channels (#2965)\n\nCo-authored-by: Kim Gardner <kgardnr@gmail.com>"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/92c72f7041961e2ca055cf358a275f684a07c4a1",
  "html_url": "https://github.com/coralproject/talk/commit/92c72f7041961e2ca055cf358a275f684a07c4a1",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/92c72f7041961e2ca055cf358a275f684a07c4a1/comments",
  "author": {
    "login": "wyattjoh",
    "id": 633002,
    "node_id": "MDQ6VXNlcjYzMzAwMg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/633002?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wyattjoh",
    "html_url": "https://github.com/wyattjoh",
    "followers_url": "https://api.github.com/users/wyattjoh/followers",
    "following_url": "https://api.github.com/users/wyattjoh/following{/other_user}",
    "gists_url": "https://api.github.com/users/wyattjoh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wyattjoh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wyattjoh/subscriptions",
    "organizations_url": "https://api.github.com/users/wyattjoh/orgs",
    "repos_url": "https://api.github.com/users/wyattjoh/repos",
    "events_url": "https://api.github.com/users/wyattjoh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wyattjoh/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "08a9788bcc51d70309e39f7fc1336aac1e102409",
      "url": "https://api.github.com/repos/coralproject/talk/commits/08a9788bcc51d70309e39f7fc1336aac1e102409",
      "html_url": "https://github.com/coralproject/talk/commit/08a9788bcc51d70309e39f7fc1336aac1e102409"
    }
  ],
  "stats": {
    "total": 31,
    "additions": 22,
    "deletions": 9
  },
  "files": [
    {
      "sha": "df7ab03bc4ad2042a2737b45e23f03ba2c9ed0ea",
      "filename": "src/core/client/admin/routes/Configure/sections/Slack/SlackChannel.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/92c72f7041961e2ca055cf358a275f684a07c4a1/src/core/client/admin/routes/Configure/sections/Slack/SlackChannel.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/92c72f7041961e2ca055cf358a275f684a07c4a1/src/core/client/admin/routes/Configure/sections/Slack/SlackChannel.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Slack/SlackChannel.tsx?ref=92c72f7041961e2ca055cf358a275f684a07c4a1",
      "patch": "@@ -24,7 +24,7 @@ import TextFieldWithValidation from \"../../TextFieldWithValidation\";\n import styles from \"./SlackChannel.css\";\n \n interface Props {\n-  channel: any;\n+  channel: string;\n   disabled: boolean;\n   index: number;\n   onRemoveClicked: (index: number) => void;"
    },
    {
      "sha": "36fc56644cfd97e514615bc8e4ed755c9aa38da7",
      "filename": "src/core/client/admin/routes/Configure/sections/Slack/SlackConfigContainer.tsx",
      "status": "modified",
      "additions": 21,
      "deletions": 8,
      "changes": 29,
      "blob_url": "https://github.com/coralproject/talk/blob/92c72f7041961e2ca055cf358a275f684a07c4a1/src/core/client/admin/routes/Configure/sections/Slack/SlackConfigContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/92c72f7041961e2ca055cf358a275f684a07c4a1/src/core/client/admin/routes/Configure/sections/Slack/SlackConfigContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Slack/SlackConfigContainer.tsx?ref=92c72f7041961e2ca055cf358a275f684a07c4a1",
      "patch": "@@ -30,21 +30,28 @@ interface Props {\n \n const SlackConfigContainer: FunctionComponent<Props> = ({ form, settings }) => {\n   const onAddChannel = useCallback(() => {\n-    const mutators = form.mutators;\n-    mutators.insert(\"slack.channels\", 0, {\n+    // We use push here because final form still has issues tracking new items\n+    // being inserted at the old array index.\n+    //\n+    // Ref: https://github.com/final-form/final-form-arrays/issues/44\n+    //\n+    form.mutators.push(\"slack.channels\", {\n       enabled: true,\n+      name: \"\",\n       hookURL: \"\",\n       triggers: {\n+        allComments: false,\n         reportedComments: false,\n         pendingComments: false,\n         featuredComments: false,\n+        staffComments: false,\n       },\n     });\n   }, [form]);\n+\n   const onRemoveChannel = useCallback(\n     (index: number) => {\n-      const mutators = form.mutators;\n-      mutators.remove(\"slack.channels\", index);\n+      form.mutators.remove(\"slack.channels\", index);\n     },\n     [form]\n   );\n@@ -58,9 +65,11 @@ const SlackConfigContainer: FunctionComponent<Props> = ({ form, settings }) => {\n             name: \"\",\n             hookURL: \"\",\n             triggers: {\n+              allComments: false,\n               reportedComments: false,\n               pendingComments: false,\n               featuredComments: false,\n+              staffComments: false,\n             },\n           },\n         ],\n@@ -107,16 +116,20 @@ const SlackConfigContainer: FunctionComponent<Props> = ({ form, settings }) => {\n         </Button>\n         <FieldArray name=\"slack.channels\">\n           {({ fields }) =>\n-            fields.map((channel: any, index: number) => (\n-              <div key={index}>\n+            fields\n+              .map((channel, index) => (\n                 <SlackChannel\n+                  key={index}\n                   channel={channel}\n                   disabled={false}\n                   index={index}\n                   onRemoveClicked={onRemoveChannel}\n                 />\n-              </div>\n-            ))\n+              ))\n+              // We're reversing here because we wanted the order of new items\n+              // added to be at the front, and we can only use `.push` and not\n+              // `.insert` or `.unshift`.\n+              .reverse()\n           }\n         </FieldArray>\n       </ConfigBox>"
    }
  ]
}
