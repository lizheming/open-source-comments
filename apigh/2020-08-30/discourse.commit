{
  "sha": "b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODpiNGM1ZjY2MzFmYzU5OTRhMWY1NmJiZTYxNjgyYjA3YTliYmQyN2Zj",
  "commit": {
    "author": {
      "name": "Penar Musaraj",
      "email": "pmusaraj@gmail.com",
      "date": "2020-08-30T13:32:40Z"
    },
    "committer": {
      "name": "Penar Musaraj",
      "email": "pmusaraj@gmail.com",
      "date": "2020-08-30T13:32:40Z"
    },
    "message": "FIX: Do not set color_scheme_id in user options when no schemes are marked as selectable",
    "tree": {
      "sha": "7f431d09202e5ae2145142063c80f842588c43bd",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/7f431d09202e5ae2145142063c80f842588c43bd"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
    "comment_count": 1,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJHBAABCAAxFiEEvt3ASmPsQKiNM2HD45BDXYgf8PcFAl9Lqn0THHBtdXNhcmFq\nQGdtYWlsLmNvbQAKCRDjkENdiB/w91PZD/48gV4XVHNOV15uj78ElXHJ3PMMpjUZ\nUJcHgN/VscGEXMcKCByh3RYZZpA7M4PhlpuijG6s59ICiOz6oSNZL7SePsKnxe5F\na3KnA1Eohg+iV7sUzDmGHx2gqaLriNYaHhWf1EIBhugL9YYlaRkZBWti5Lq90r7c\nuQjq4leqSfJt0nk6rOcQnvgaQIrnjfeQHaIT+R8K6Ub1Ad18pdi1xwd3z8I13i+T\nnkmIF6eu4HtDhUb+hPRAZvRzqDtEVeBmClQpYukW+K3pV6gx6Eq0JfjAps1Yd5Q9\nGJL91CNweDZ/GyH+/hudWwWQY3qwcS7xlpWxz0yrjZko2OP0POE32/TLdbOTEgKL\nLIsP3pUP89zjTKCsPFJIHxHsRMa0hAYxAR+giyD8vnomWupjKe50/9RHtVMXMRqJ\ndpQ08QsVTmuJP1cCnsuRro1FYaoA/vj6WMIIMSWTGLdl+ZocBfCBnisT4duux9F+\nalxvoR4W3z8TpOIpSYPipO4EEgWqDnCospSmkFdlw0Fh7xbEJXA0XubMPLUdsCnS\nKGZpuQCSvbtvmw6FdX/YlPdhtcMU1opf2EME7OniFKjA9QqodE9Yn2iimLCZ2XEI\nzeR9NmPwUlh8me8/1nHTrS/+jKq6sohpEdijofTJcRNoP1BS2gUY76+kO+ob2qwx\n7bj0njeADJChsQ==\n=uEzY\n-----END PGP SIGNATURE-----",
      "payload": "tree 7f431d09202e5ae2145142063c80f842588c43bd\nparent 7bba65b6f5cf246630cd6e65d70f29aa5219a8a8\nauthor Penar Musaraj <pmusaraj@gmail.com> 1598794360 -0400\ncommitter Penar Musaraj <pmusaraj@gmail.com> 1598794360 -0400\n\nFIX: Do not set color_scheme_id in user options when no schemes are marked as selectable\n"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
  "html_url": "https://github.com/discourse/discourse/commit/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc/comments",
  "author": {
    "login": "pmusaraj",
    "id": 368961,
    "node_id": "MDQ6VXNlcjM2ODk2MQ==",
    "avatar_url": "https://avatars1.githubusercontent.com/u/368961?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pmusaraj",
    "html_url": "https://github.com/pmusaraj",
    "followers_url": "https://api.github.com/users/pmusaraj/followers",
    "following_url": "https://api.github.com/users/pmusaraj/following{/other_user}",
    "gists_url": "https://api.github.com/users/pmusaraj/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pmusaraj/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pmusaraj/subscriptions",
    "organizations_url": "https://api.github.com/users/pmusaraj/orgs",
    "repos_url": "https://api.github.com/users/pmusaraj/repos",
    "events_url": "https://api.github.com/users/pmusaraj/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pmusaraj/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "pmusaraj",
    "id": 368961,
    "node_id": "MDQ6VXNlcjM2ODk2MQ==",
    "avatar_url": "https://avatars1.githubusercontent.com/u/368961?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pmusaraj",
    "html_url": "https://github.com/pmusaraj",
    "followers_url": "https://api.github.com/users/pmusaraj/followers",
    "following_url": "https://api.github.com/users/pmusaraj/following{/other_user}",
    "gists_url": "https://api.github.com/users/pmusaraj/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pmusaraj/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pmusaraj/subscriptions",
    "organizations_url": "https://api.github.com/users/pmusaraj/orgs",
    "repos_url": "https://api.github.com/users/pmusaraj/repos",
    "events_url": "https://api.github.com/users/pmusaraj/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pmusaraj/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7bba65b6f5cf246630cd6e65d70f29aa5219a8a8",
      "url": "https://api.github.com/repos/discourse/discourse/commits/7bba65b6f5cf246630cd6e65d70f29aa5219a8a8",
      "html_url": "https://github.com/discourse/discourse/commit/7bba65b6f5cf246630cd6e65d70f29aa5219a8a8"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 9,
    "deletions": 9
  },
  "files": [
    {
      "sha": "a64fab50d905fbcd1ea126449b8123a3d7cf158d",
      "filename": "app/assets/javascripts/discourse/app/controllers/preferences/interface.js",
      "status": "modified",
      "additions": 9,
      "deletions": 8,
      "changes": 17,
      "blob_url": "https://github.com/discourse/discourse/blob/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc/app/assets/javascripts/discourse/app/controllers/preferences/interface.js",
      "raw_url": "https://github.com/discourse/discourse/raw/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc/app/assets/javascripts/discourse/app/controllers/preferences/interface.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/app/controllers/preferences/interface.js?ref=b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
      "patch": "@@ -36,6 +36,7 @@ export default Controller.extend({\n   selectedColorSchemeId: null,\n   selectedDarkColorSchemeId: null,\n   preferencesController: inject(\"preferences\"),\n+  makeColorSchemeDefault: true,\n \n   init() {\n     this._super(...arguments);\n@@ -46,8 +47,8 @@ export default Controller.extend({\n     });\n   },\n \n-  @discourseComputed(\"makeThemeDefault\", \"makeColorSchemeDefault\")\n-  saveAttrNames(makeThemeDefault, makeColorSchemeDefault) {\n+  @discourseComputed(\"makeThemeDefault\")\n+  saveAttrNames(makeThemeDefault) {\n     let attrs = [\n       \"locale\",\n       \"external_links_in_new_tab\",\n@@ -61,17 +62,15 @@ export default Controller.extend({\n       \"hide_profile_and_presence\",\n       \"text_size\",\n       \"title_count_mode\",\n-      \"skip_new_user_tips\"\n+      \"skip_new_user_tips\",\n+      \"color_scheme_id\",\n+      \"dark_scheme_id\"\n     ];\n \n     if (makeThemeDefault) {\n       attrs.push(\"theme_ids\");\n     }\n \n-    if (makeColorSchemeDefault) {\n-      attrs.push(\"color_scheme_id\");\n-      attrs.push(\"dark_scheme_id\");\n-    }\n     return attrs;\n   },\n \n@@ -230,7 +229,9 @@ export default Controller.extend({\n         this.set(\"model.user_option.text_size\", this.textSize);\n       }\n \n-      if (this.makeColorSchemeDefault) {\n+      if (!this.showColorSchemeSelector) {\n+        this.set(\"model.user_option.color_scheme_id\", null);\n+      } else if (this.makeColorSchemeDefault) {\n         this.set(\n           \"model.user_option.color_scheme_id\",\n           this.selectedColorSchemeId"
    },
    {
      "sha": "34976bbd8254e7936d4cdac032e61882fe1a5c56",
      "filename": "app/assets/javascripts/discourse/app/routes/preferences-interface.js",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/discourse/discourse/blob/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc/app/assets/javascripts/discourse/app/routes/preferences-interface.js",
      "raw_url": "https://github.com/discourse/discourse/raw/b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc/app/assets/javascripts/discourse/app/routes/preferences-interface.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/app/routes/preferences-interface.js?ref=b4c5f6631fc5994a1f56bbe61682b07a9bbd27fc",
      "patch": "@@ -12,7 +12,6 @@ export default RestrictedUserRoute.extend({\n       makeThemeDefault:\n         !user.get(\"user_option.theme_ids\") ||\n         currentThemeId() === user.get(\"user_option.theme_ids\")[0],\n-      makeColorSchemeDefault: !user.get(\"user_option.color_scheme_id\"),\n       makeTextSizeDefault:\n         user.get(\"currentTextSize\") === user.get(\"user_option.text_size\")\n     });"
    }
  ]
}
