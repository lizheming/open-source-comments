{
  "sha": "f700e318a4671bc413c92b1c384c05f1080dda54",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODpmNzAwZTMxOGE0NjcxYmM0MTNjOTJiMWMzODRjMDVmMTA4MGRkYTU0",
  "commit": {
    "author": {
      "name": "Osama Sayegh",
      "email": "asooomaasoooma90@gmail.com",
      "date": "2021-02-05T22:18:29Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2021-02-05T22:18:29Z"
    },
    "message": "DEV: Add CSRF meta tags to pages served by Ember CLI server (#11993)\n\nSigned-off-by: OsamaSayegh <asooomaasoooma90@gmail.com>",
    "tree": {
      "sha": "31c520fa4bc187d101025d884918c888f9b06849",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/31c520fa4bc187d101025d884918c888f9b06849"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/f700e318a4671bc413c92b1c384c05f1080dda54",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgHcQ1CRBK7hj4Ov3rIwAAdHIIAI9uI7mn+p9xHarnoIwVGEtb\nNWPtWrGUsN7t2KKL5OzRPTRi08K6B+J6Qd5uJVEoTCHrgnjKrXuCOtD5JLDDbGX0\nxXYfZIaDZdUY/COBjt83DygCofHGMwgQdqn7CRIpqnwFdaTUXpy5FkCV1ZW0BiN/\nDtU2llMBCiSL1w4rJaFkgWqiVNJsdD8J2fd8B7aDLclF5G5EoLNcmIg32HJV5W1v\n9lki/3hyzV9lK7xwUmScDvwBnUtdA3wGDHVR9S56+aOQRM5IeFPvK+it5vGBUtsA\n4F6YAI1bQavu8sp+E3FPCU9uQjlMNiGs0Dh0iII1ahZlz9TLVxw87NFFwpgctII=\n=zn4b\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 31c520fa4bc187d101025d884918c888f9b06849\nparent ded0f5b4e5d29110bb5ee9680b4be5ce824fe286\nauthor Osama Sayegh <asooomaasoooma90@gmail.com> 1612563509 +0300\ncommitter GitHub <noreply@github.com> 1612563509 +0300\n\nDEV: Add CSRF meta tags to pages served by Ember CLI server (#11993)\n\nSigned-off-by: OsamaSayegh <asooomaasoooma90@gmail.com>"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/f700e318a4671bc413c92b1c384c05f1080dda54",
  "html_url": "https://github.com/discourse/discourse/commit/f700e318a4671bc413c92b1c384c05f1080dda54",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/f700e318a4671bc413c92b1c384c05f1080dda54/comments",
  "author": {
    "login": "OsamaSayegh",
    "id": 17474474,
    "node_id": "MDQ6VXNlcjE3NDc0NDc0",
    "avatar_url": "https://avatars.githubusercontent.com/u/17474474?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/OsamaSayegh",
    "html_url": "https://github.com/OsamaSayegh",
    "followers_url": "https://api.github.com/users/OsamaSayegh/followers",
    "following_url": "https://api.github.com/users/OsamaSayegh/following{/other_user}",
    "gists_url": "https://api.github.com/users/OsamaSayegh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/OsamaSayegh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/OsamaSayegh/subscriptions",
    "organizations_url": "https://api.github.com/users/OsamaSayegh/orgs",
    "repos_url": "https://api.github.com/users/OsamaSayegh/repos",
    "events_url": "https://api.github.com/users/OsamaSayegh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/OsamaSayegh/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ded0f5b4e5d29110bb5ee9680b4be5ce824fe286",
      "url": "https://api.github.com/repos/discourse/discourse/commits/ded0f5b4e5d29110bb5ee9680b4be5ce824fe286",
      "html_url": "https://github.com/discourse/discourse/commit/ded0f5b4e5d29110bb5ee9680b4be5ce824fe286"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 11,
    "deletions": 0
  },
  "files": [
    {
      "sha": "9c9c4d0200e082ae43701e3da86e9857c0ffcbbc",
      "filename": "app/assets/javascripts/discourse/public/assets/scripts/discourse-boot.js",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/discourse/discourse/blob/f700e318a4671bc413c92b1c384c05f1080dda54/app/assets/javascripts/discourse/public/assets/scripts/discourse-boot.js",
      "raw_url": "https://github.com/discourse/discourse/raw/f700e318a4671bc413c92b1c384c05f1080dda54/app/assets/javascripts/discourse/public/assets/scripts/discourse-boot.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/public/assets/scripts/discourse-boot.js?ref=f700e318a4671bc413c92b1c384c05f1080dda54",
      "patch": "@@ -195,6 +195,16 @@\n \n       let locale = data.bootstrap.locale_script;\n \n+      if (data.bootstrap.csrf_token) {\n+        const csrfParam = document.createElement(\"meta\");\n+        csrfParam.setAttribute(\"name\", \"csrf-param\");\n+        csrfParam.setAttribute(\"content\", \"authenticity_token\");\n+        head.append(csrfParam);\n+        const csrfToken = document.createElement(\"meta\");\n+        csrfToken.setAttribute(\"name\", \"csrf-token\");\n+        csrfToken.setAttribute(\"content\", data.bootstrap.csrf_token);\n+        head.append(csrfToken);\n+      }\n       (data.bootstrap.stylesheets || []).forEach((s) => {\n         let link = document.createElement(\"link\");\n         link.setAttribute(\"rel\", \"stylesheet\");"
    },
    {
      "sha": "b0378359c5f6baa576c6ed5438a3e5f767098687",
      "filename": "app/controllers/bootstrap_controller.rb",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/discourse/discourse/blob/f700e318a4671bc413c92b1c384c05f1080dda54/app/controllers/bootstrap_controller.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/f700e318a4671bc413c92b1c384c05f1080dda54/app/controllers/bootstrap_controller.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/controllers/bootstrap_controller.rb?ref=f700e318a4671bc413c92b1c384c05f1080dda54",
      "patch": "@@ -60,6 +60,7 @@ def index\n       preloaded: @preloaded,\n     }\n     bootstrap[:extra_locales] = extra_locales if extra_locales.present?\n+    bootstrap[:csrf_token] = form_authenticity_token if current_user\n \n     render_json_dump(bootstrap: bootstrap)\n   end"
    }
  ]
}
