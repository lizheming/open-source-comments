{
  "sha": "642b88f6c0fa9e692a870a1451ad6549eda861ea",
  "node_id": "MDY6Q29tbWl0ODQ4NzYyMTA6NjQyYjg4ZjZjMGZhOWU2OTJhODcwYTE0NTFhZDY1NDllZGE4NjFlYQ==",
  "commit": {
    "author": {
      "name": "Sönke Ludwig",
      "email": "sludwig@outerproduct.org",
      "date": "2021-07-07T12:18:58Z"
    },
    "committer": {
      "name": "Sönke Ludwig",
      "email": "sludwig@outerproduct.org",
      "date": "2021-07-07T12:18:58Z"
    },
    "message": "Fix deprecation warnings and errors on DMD 2.097.0.",
    "tree": {
      "sha": "b27cf7936db2b61131746e4116f801d4c49fa5e9",
      "url": "https://api.github.com/repos/rejectedsoftware/diskuto/git/trees/b27cf7936db2b61131746e4116f801d4c49fa5e9"
    },
    "url": "https://api.github.com/repos/rejectedsoftware/diskuto/git/commits/642b88f6c0fa9e692a870a1451ad6549eda861ea",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/rejectedsoftware/diskuto/commits/642b88f6c0fa9e692a870a1451ad6549eda861ea",
  "html_url": "https://github.com/rejectedsoftware/diskuto/commit/642b88f6c0fa9e692a870a1451ad6549eda861ea",
  "comments_url": "https://api.github.com/repos/rejectedsoftware/diskuto/commits/642b88f6c0fa9e692a870a1451ad6549eda861ea/comments",
  "author": {
    "login": "s-ludwig",
    "id": 1645969,
    "node_id": "MDQ6VXNlcjE2NDU5Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1645969?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/s-ludwig",
    "html_url": "https://github.com/s-ludwig",
    "followers_url": "https://api.github.com/users/s-ludwig/followers",
    "following_url": "https://api.github.com/users/s-ludwig/following{/other_user}",
    "gists_url": "https://api.github.com/users/s-ludwig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/s-ludwig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/s-ludwig/subscriptions",
    "organizations_url": "https://api.github.com/users/s-ludwig/orgs",
    "repos_url": "https://api.github.com/users/s-ludwig/repos",
    "events_url": "https://api.github.com/users/s-ludwig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/s-ludwig/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "s-ludwig",
    "id": 1645969,
    "node_id": "MDQ6VXNlcjE2NDU5Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1645969?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/s-ludwig",
    "html_url": "https://github.com/s-ludwig",
    "followers_url": "https://api.github.com/users/s-ludwig/followers",
    "following_url": "https://api.github.com/users/s-ludwig/following{/other_user}",
    "gists_url": "https://api.github.com/users/s-ludwig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/s-ludwig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/s-ludwig/subscriptions",
    "organizations_url": "https://api.github.com/users/s-ludwig/orgs",
    "repos_url": "https://api.github.com/users/s-ludwig/repos",
    "events_url": "https://api.github.com/users/s-ludwig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/s-ludwig/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3e83d5967dcea6bc9b5d62753c29c0ad870e660c",
      "url": "https://api.github.com/repos/rejectedsoftware/diskuto/commits/3e83d5967dcea6bc9b5d62753c29c0ad870e660c",
      "html_url": "https://github.com/rejectedsoftware/diskuto/commit/3e83d5967dcea6bc9b5d62753c29c0ad870e660c"
    }
  ],
  "stats": {
    "total": 14,
    "additions": 7,
    "deletions": 7
  },
  "files": [
    {
      "sha": "6d976a27dd8ba3eee2d57574781e626bcbbe57c8",
      "filename": "source/diskuto/commentstore.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/rejectedsoftware/diskuto/blob/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/commentstore.d",
      "raw_url": "https://github.com/rejectedsoftware/diskuto/raw/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/commentstore.d",
      "contents_url": "https://api.github.com/repos/rejectedsoftware/diskuto/contents/source/diskuto/commentstore.d?ref=642b88f6c0fa9e692a870a1451ad6549eda861ea",
      "patch": "@@ -40,7 +40,7 @@ struct StoredComment {\n \t}\n \n \tID id;\n-\t@byName CommentStatus status = CommentStatus.active;\n+\t@byName Status status = Status.active;\n \tstring topic;\n \tID replyTo;\n \tUserID author;"
    },
    {
      "sha": "037de9917972fe45d6333c2b461bd01e326b8ecc",
      "filename": "source/diskuto/commentstores/mongodb.d",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/rejectedsoftware/diskuto/blob/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/commentstores/mongodb.d",
      "raw_url": "https://github.com/rejectedsoftware/diskuto/raw/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/commentstores/mongodb.d",
      "contents_url": "https://api.github.com/repos/rejectedsoftware/diskuto/contents/source/diskuto/commentstores/mongodb.d?ref=642b88f6c0fa9e692a870a1451ad6549eda861ea",
      "patch": "@@ -29,8 +29,8 @@ class MongoDBCommentStore : DiskutoCommentStore {\n \t\t// upgrade missing \"clientAddress\" field name\n \t\tm_comments.update([\"clientAddress\": [\"$exists\": false]], [\"$set\": [\"clientAddress\": \"\"]], UpdateFlags.multiUpdate);\n \t\t// upgrade old status field\n-\t\tm_comments.update([\"status\": cast(int)CommentStatus.active], [\"$set\": [\"status\": \"active\"]], UpdateFlags.multiUpdate);\n-\t\tm_comments.update([\"status\": cast(int)CommentStatus.disabled], [\"$set\": [\"status\": \"disabled\"]], UpdateFlags.multiUpdate);\n+\t\tm_comments.update([\"status\": cast(int)StoredComment.Status.active], [\"$set\": [\"status\": \"active\"]], UpdateFlags.multiUpdate);\n+\t\tm_comments.update([\"status\": cast(int)StoredComment.Status.disabled], [\"$set\": [\"status\": \"disabled\"]], UpdateFlags.multiUpdate);\n \t}\n \n \tStoredComment.ID postComment(StoredComment comment)\n@@ -46,7 +46,7 @@ class MongoDBCommentStore : DiskutoCommentStore {\n \t\treturn cast(StoredComment)m_comments.findOne!(MongoStruct!StoredComment)([\"_id\": BsonObjectID.fromString(comment)]);\n \t}\n \n-\tvoid setCommentStatus(StoredComment.ID id, CommentStatus status)\n+\tvoid setCommentStatus(StoredComment.ID id, StoredComment.Status status)\n \t{\n \t\timport std.conv : to;\n \t\tm_comments.update([\"_id\": BsonObjectID.fromString(id)], [\"$set\": [\"status\": status.to!string]]);"
    },
    {
      "sha": "915b9f8921bfe85ce1123d2b55d4a2e4c7da1547",
      "filename": "source/diskuto/internal/webutils.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/rejectedsoftware/diskuto/blob/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/internal/webutils.d",
      "raw_url": "https://github.com/rejectedsoftware/diskuto/raw/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/internal/webutils.d",
      "contents_url": "https://api.github.com/repos/rejectedsoftware/diskuto/contents/source/diskuto/internal/webutils.d?ref=642b88f6c0fa9e692a870a1451ad6549eda861ea",
      "patch": "@@ -140,7 +140,7 @@ auto getCommentsContext(HTTPServerRequest req, DiskutoWeb web, string topic)\n \tif (web.settings.userStore) {\n \t\tauto u = web.settings.userStore.getLoggedInUser(req);\n \t\tif (!u.isNull) {\n-\t\t\tret.user = u;\n+\t\t\tret.user.user = u.get;\n \t\t\tret.user.registered = true;\n \t\t}\n \t\tret.user.role = web.settings.userStore.getUserRole(ret.user.id, topic);"
    },
    {
      "sha": "c6d03d6d6d49c060f1e65fd7a0051ae704ce7061",
      "filename": "source/diskuto/web.d",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/rejectedsoftware/diskuto/blob/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/web.d",
      "raw_url": "https://github.com/rejectedsoftware/diskuto/raw/642b88f6c0fa9e692a870a1451ad6549eda861ea/source/diskuto/web.d",
      "contents_url": "https://api.github.com/repos/rejectedsoftware/diskuto/contents/source/diskuto/web.d?ref=642b88f6c0fa9e692a870a1451ad6549eda861ea",
      "patch": "@@ -580,9 +580,9 @@ private User getUser(HTTPServerRequest req, DiskutoSettings settings, string top\n \tif (settings.userStore) {\n \t\tauto usr = settings.userStore.getLoggedInUser(req);\n \t\tif (!usr.isNull) {\n-\t\t\tret.user = usr;\n+\t\t\tret.user = usr.get;\n \t\t\tret.registered = true;\n-\t\t\tret.role = settings.userStore.getUserRole(usr.id, topic);\n+\t\t\tret.role = settings.userStore.getUserRole(usr.get.id, topic);\n \t\t\treturn ret;\n \t\t}\n \t}"
    }
  ]
}
