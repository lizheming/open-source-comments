{
  "sha": "011a458c3c5f0346099750ba198c2597dab8485b",
  "node_id": "C_kwDOAKEu-toAKDAxMWE0NThjM2M1ZjAzNDYwOTk3NTBiYTE5OGMyNTk3ZGFiODQ4NWI",
  "commit": {
    "author": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2021-12-12T12:58:45Z"
    },
    "committer": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2021-12-12T12:58:45Z"
    },
    "message": "Merge v0.2021.38 into 'release'.",
    "tree": {
      "sha": "b024a042adf6f8767a52638d31aee3f59cbf4c96",
      "url": "https://api.github.com/repos/debiki/talkyard/git/trees/b024a042adf6f8767a52638d31aee3f59cbf4c96"
    },
    "url": "https://api.github.com/repos/debiki/talkyard/git/commits/011a458c3c5f0346099750ba198c2597dab8485b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/debiki/talkyard/commits/011a458c3c5f0346099750ba198c2597dab8485b",
  "html_url": "https://github.com/debiki/talkyard/commit/011a458c3c5f0346099750ba198c2597dab8485b",
  "comments_url": "https://api.github.com/repos/debiki/talkyard/commits/011a458c3c5f0346099750ba198c2597dab8485b/comments",
  "author": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2c389d0108ca47b4d082b935f583fcfeb2c7cfe9",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/2c389d0108ca47b4d082b935f583fcfeb2c7cfe9",
      "html_url": "https://github.com/debiki/talkyard/commit/2c389d0108ca47b4d082b935f583fcfeb2c7cfe9"
    },
    {
      "sha": "1474a9a4826d6aa6a346befb725b05e639389d61",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/1474a9a4826d6aa6a346befb725b05e639389d61",
      "html_url": "https://github.com/debiki/talkyard/commit/1474a9a4826d6aa6a346befb725b05e639389d61"
    }
  ],
  "stats": {
    "total": 139,
    "additions": 125,
    "deletions": 14
  },
  "files": [
    {
      "sha": "42e4f64aaafddcbe745df456f8ffa76029fffb81",
      "filename": "build.sbt",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/build.sbt",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/build.sbt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/build.sbt?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -75,8 +75,7 @@ val appDependencies = Seq(\n   // Search engine, in https://mvnrepository.com.\n   \"org.elasticsearch\" % \"elasticsearch\" % \"6.2.4\",          // newest 6.2 as of 18-07-17, there's 6.3.\n   \"org.elasticsearch.client\" % \"transport\" % \"6.2.4\",       // newest 6.2 as of 18-07-17, there's 6.3.\n-  // ElasticSearch needs log4j\n-  \"log4j\" % \"log4j\" % \"1.2.17\",\n+\n   Dependencies.Libs.apacheCommonsEmail,\n   Dependencies.Libs.guava,\n   Dependencies.Libs.jsoup,\n@@ -125,6 +124,11 @@ def mainSettings = List(\n   version := appVersion,\n   libraryDependencies ++= appDependencies,\n \n+  // Pin to >= 2.15.\n+  dependencyOverrides ++= Seq(\n+        \"org.apache.logging.log4j\" % \"log4j-api\" % \"2.15.0\",\n+        \"org.apache.logging.log4j\" % \"log4j-core\" % \"2.15.0\"),\n+\n   // Place tests in ./tests/app/ instead of ./test/, because there're other tests in\n   // ./tests/, namely security/ and e2e/, and having both ./test/ and ./tests/ seems confusing.\n   // RENAME to ./tests/appsv? (since ./app is now ./appsv)"
    },
    {
      "sha": "6e855736d37699738e208d8ee56a5ec05146f0f8",
      "filename": "client/app-more/users/user-invites.more.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/client/app-more/users/user-invites.more.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/client/app-more/users/user-invites.more.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/client/app-more/users/user-invites.more.ts?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -253,7 +253,7 @@ const InviteDialog = createComponent({  // COULD break out to debiki2.invite mod\n     };\n \n     Server.sendInvites(requestBody, (sendInvitesResponse: SendInvitesResponse) => {\n-      dieIf(sendInvitesResponse.willSendLater, 'TyE2ABKR03', \"Unimpl\");\n+      dieIf(sendInvitesResponse.willSendLater, 'Unimpl [TyE2ABKR03]');\n       const invitesSent: Invite[] = sendInvitesResponse.invitesSent;\n       this.state.addInvites(invitesSent);\n "
    },
    {
      "sha": "234d99e2368d809adb77caa575db5953438d6463",
      "filename": "images/app/Dockerfile.dev",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/images/app/Dockerfile.dev",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/images/app/Dockerfile.dev",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/images/app/Dockerfile.dev?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -129,6 +129,9 @@ CMD cd /opt/talkyard/app/ && exec /opt/sbt/bin/sbt \\\n   -Ddeployment.security.SSLv3=false \\\n   -Dhttps.protocols=TLSv1.1,TLSv1.2 \\\n   -Djdk.tls.client.protocols=TLSv1.1,TLSv1.2 \\\n+  # log4j2 problem, disable this:\n+  -Dlog4j2.formatMsgNoLookups=true \\\n+  #\n   -Dconfig.file=/opt/talkyard/app/conf/app-dev.conf \\\n   run\n "
    },
    {
      "sha": "2d8b7fc5f7f00d8fdc0f347f869e3bc95101d0be",
      "filename": "images/app/Dockerfile.prod",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/images/app/Dockerfile.prod",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/images/app/Dockerfile.prod",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/images/app/Dockerfile.prod?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -93,6 +93,9 @@ CMD rm -f /opt/talkyard/app/RUNNING_PID && exec /opt/talkyard/app/bin/talkyard-s\n   # when running scrypt the first time, waiting for \"enough entropy\".\n   -Djava.security.egd=file:/dev/./urandom \\\n   #\n+  # log4j2 problem, disable this:\n+  -Dlog4j2.formatMsgNoLookups=true \\\n+  #\n   -Dlogger.file=/opt/talkyard/app/conf/logback-prod.xml \\\n   -Dconfig.file=${CONFIG_FILE}\n "
    },
    {
      "sha": "9688f9a825acd26ed092585c14ece9b86cf60174",
      "filename": "images/search/Dockerfile",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/images/search/Dockerfile",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/images/search/Dockerfile",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/images/search/Dockerfile?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -13,8 +13,10 @@ FROM docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3\n \n # [ty_v1] mount these instead â€” in a conf.d?\n # In dev, mount the conf from  modules/ed-prod-one-test/conf/search/.\n-COPY elasticsearch.yml /usr/share/elasticsearch/config/elasticsearch.yml\n-COPY log4j2.properties /usr/share/elasticsearch/config/log4j2.properties\n+COPY  jvm.options  \\\n+      elasticsearch.yml  \\\n+      log4j2.properties  \\\n+  /usr/share/elasticsearch/config/\n \n # For troubleshooting. Oops, maybe rpm not apt?\n # RUN apt-get install -y net-tools tree"
    },
    {
      "sha": "0b4cc89c6ff3fa2d52f745aa8825954b6233d5f8",
      "filename": "images/search/jvm.options",
      "status": "added",
      "additions": 100,
      "deletions": 0,
      "changes": 100,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/images/search/jvm.options",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/images/search/jvm.options",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/images/search/jvm.options?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -0,0 +1,100 @@\n+## JVM configuration\n+\n+################################################################\n+## IMPORTANT: JVM heap size\n+################################################################\n+##\n+## You should always set the min and max JVM heap\n+## size to the same value. For example, to set\n+## the heap to 4 GB, set:\n+##\n+## -Xms4g\n+## -Xmx4g\n+##\n+## See https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html\n+## for more information\n+##\n+################################################################\n+\n+# Xms represents the initial size of total heap space\n+# Xmx represents the maximum size of total heap space\n+\n+-Xms1g\n+-Xmx1g\n+\n+################################################################\n+## Expert settings\n+################################################################\n+##\n+## All settings below this section are considered\n+## expert settings. Don't tamper with them unless\n+## you understand what you are doing\n+##\n+################################################################\n+\n+## GC configuration\n+-XX:+UseConcMarkSweepGC\n+-XX:CMSInitiatingOccupancyFraction=75\n+-XX:+UseCMSInitiatingOccupancyOnly\n+\n+## optimizations\n+\n+# pre-touch memory pages used by the JVM during initialization\n+-XX:+AlwaysPreTouch\n+\n+## basic\n+\n+# explicitly set the stack size\n+-Xss1m\n+\n+# set to headless, just in case\n+-Djava.awt.headless=true\n+\n+# ensure UTF-8 encoding by default (e.g. filenames)\n+-Dfile.encoding=UTF-8\n+\n+# use our provided JNA always versus the system one\n+-Djna.nosys=true\n+\n+# turn off a JDK optimization that throws away stack traces for common\n+# exceptions because stack traces are important for debugging\n+-XX:-OmitStackTraceInFastThrow\n+\n+# flags to configure Netty\n+-Dio.netty.noUnsafe=true\n+-Dio.netty.noKeySetOptimization=true\n+-Dio.netty.recycler.maxCapacityPerThread=0\n+\n+# log4j 2\n+-Dlog4j.shutdownHookEnabled=false\n+-Dlog4j2.disable.jmx=true\n+-Dlog4j2.formatMsgNoLookups=true\n+\n+-Djava.io.tmpdir=${ES_TMPDIR}\n+\n+## heap dumps\n+\n+# generate a heap dump when an allocation from the Java heap fails\n+# heap dumps are created in the working directory of the JVM\n+-XX:+HeapDumpOnOutOfMemoryError\n+\n+# specify an alternative path for heap dumps\n+# ensure the directory exists and has sufficient space\n+#-XX:HeapDumpPath=/heap/dump/path\n+\n+## JDK 8 GC logging\n+\n+8:-XX:+PrintGCDetails\n+8:-XX:+PrintGCDateStamps\n+8:-XX:+PrintTenuringDistribution\n+8:-XX:+PrintGCApplicationStoppedTime\n+8:-Xloggc:logs/gc.log\n+8:-XX:+UseGCLogFileRotation\n+8:-XX:NumberOfGCLogFiles=32\n+8:-XX:GCLogFileSize=64m\n+\n+# JDK 9+ GC logging\n+9-:-Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m\n+# due to internationalization enhancements in JDK 9 Elasticsearch need to set the provider to COMPAT otherwise\n+# time/date parsing will break in an incompatible way for some date patterns and locals\n+9-:-Djava.locale.providers=COMPAT"
    },
    {
      "sha": "d98107b409c1a3708725c4f37aeea31ca89b23cd",
      "filename": "lock.sbt",
      "status": "modified",
      "additions": 3,
      "deletions": 4,
      "changes": 7,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/lock.sbt",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/lock.sbt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/lock.sbt?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -122,7 +122,6 @@ Compile / dependencyOverrides ++= {\n       \"javax.cache\" % \"cache-api\" % \"1.1.1\",\n       \"javax.inject\" % \"javax.inject\" % \"1\",\n       \"joda-time\" % \"joda-time\" % \"2.10.1\",\n-      \"log4j\" % \"log4j\" % \"1.2.17\",\n       \"net.logstash.logback\" % \"logstash-logback-encoder\" % \"4.11\",\n       \"net.minidev\" % \"accessors-smart\" % \"1.2\",\n       \"net.minidev\" % \"json-smart\" % \"2.3\",\n@@ -135,8 +134,8 @@ Compile / dependencyOverrides ++= {\n       \"org.apache.httpcomponents\" % \"httpclient\" % \"4.5.2\",\n       \"org.apache.httpcomponents\" % \"httpcore\" % \"4.4.5\",\n       \"org.apache.httpcomponents\" % \"httpcore-nio\" % \"4.4.5\",\n-      \"org.apache.logging.log4j\" % \"log4j-api\" % \"2.9.1\",\n-      \"org.apache.logging.log4j\" % \"log4j-core\" % \"2.9.1\",\n+      \"org.apache.logging.log4j\" % \"log4j-api\" % \"2.15.0\",\n+      \"org.apache.logging.log4j\" % \"log4j-core\" % \"2.15.0\",\n       \"org.apache.lucene\" % \"lucene-analyzers-common\" % \"7.2.1\",\n       \"org.apache.lucene\" % \"lucene-backward-codecs\" % \"7.2.1\",\n       \"org.apache.lucene\" % \"lucene-core\" % \"7.2.1\",\n@@ -200,4 +199,4 @@ Compile / dependencyOverrides ++= {\n     )\n   }\n }\n-// LIBRARY_DEPENDENCIES_HASH 8679dbad02eb53ea5e8c4904b48676ee36b6b08b\n+// LIBRARY_DEPENDENCIES_HASH 7393bdf41bbc926ee4b1f7b0168a4a3b75e9c025"
    },
    {
      "sha": "bb3a9b7dc6d2f3e31cd302fc331944897b1ce063",
      "filename": "project/build.properties",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/project/build.properties",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/project/build.properties",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/project/build.properties?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -1 +1 @@\n-sbt.version=1.5.5\n+sbt.version=1.5.6"
    },
    {
      "sha": "01f0eda32937a0f81445e2667903d3b007a78228",
      "filename": "relchans/tyse-v0-dev",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/relchans/tyse-v0-dev?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -1 +1 @@\n-Subproject commit 41410c57553867df4329e6273c33e2765ea8a71c\n+Subproject commit 01f0eda32937a0f81445e2667903d3b007a78228"
    },
    {
      "sha": "63b860c10da6f9e85e309714d792168da75f601c",
      "filename": "relchans/tyse-v0-regular",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/relchans/tyse-v0-regular?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -1 +1 @@\n-Subproject commit 556a79b4aa1627602feaac80f45b61b1ae762c4e\n+Subproject commit 63b860c10da6f9e85e309714d792168da75f601c"
    },
    {
      "sha": "271b4ee7ee58df319ce27755ce91d081c6c4dda9",
      "filename": "vendors/jars",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/vendors/jars?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -1 +1 @@\n-Subproject commit d6db12a51d3684bc41e100caa2f3b2ba841ff8d1\n+Subproject commit 271b4ee7ee58df319ce27755ce91d081c6c4dda9"
    },
    {
      "sha": "4106eeab80d6c218c3a143c68b08937853badd09",
      "filename": "version.txt",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/011a458c3c5f0346099750ba198c2597dab8485b/version.txt",
      "raw_url": "https://github.com/debiki/talkyard/raw/011a458c3c5f0346099750ba198c2597dab8485b/version.txt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/version.txt?ref=011a458c3c5f0346099750ba198c2597dab8485b",
      "patch": "@@ -1 +1 @@\n-v0.2021.36\n+v0.2021.38"
    }
  ]
}
