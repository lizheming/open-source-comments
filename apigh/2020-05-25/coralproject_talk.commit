{
  "sha": "fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6ZmU4Y2I5MGExY2E2MzVlNmNkNzViMzAwNmY3YzM3MjFlNzFlNTQwMA==",
  "commit": {
    "author": {
      "name": "Vinh",
      "email": "vinh@vinh.tech",
      "date": "2020-05-21T22:27:27Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-05-21T22:27:27Z"
    },
    "message": "[CORL-1086] Support `bodyClassName` in embed (#2969)\n\n* feat: support embed config `bodyClassName`\r\n\r\n* chore: add comment",
    "tree": {
      "sha": "20f61f92e429997f6da7363162ea79b4ba7a6d84",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/20f61f92e429997f6da7363162ea79b4ba7a6d84"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJexwBPCRBK7hj4Ov3rIwAAdHIIAESJWrPmF+hpXXVSbL9g0rtk\nAQieWgy5tDeijifEa9u85ejkoPPvBzVx7QNUnlK9HyHLcXMS5Xm8vIKvUm/cJXLQ\nH3Pc0hzW3D2wPAwzt+q8X8da4U8rzQgO7IgxwRu3PVjcu9q8ziF7EdcsLUfMnUmo\nEQMxTeVtR24QA7BVliF7jQNIS/0lBKV0e/7iQANpiQsYQIzFOhtbCXJ9NfIZrQXA\nb0G0pE4uUv1aNcX0FgRYjUYEpYdfu9rtEWNyRY66re+AFOQJcPa07cMchUm/mFYO\nxYi+i1ovkk8cjJJCZH52UenoVnJXjvpNoh3Jf220iLB6P3HQmRwS+KlGvIoHS2c=\n=Btol\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 20f61f92e429997f6da7363162ea79b4ba7a6d84\nparent 74366bec555371f14b0fc53b73391176783d9519\nauthor Vinh <vinh@vinh.tech> 1590100047 +0200\ncommitter GitHub <noreply@github.com> 1590100047 +0000\n\n[CORL-1086] Support `bodyClassName` in embed (#2969)\n\n* feat: support embed config `bodyClassName`\r\n\r\n* chore: add comment"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
  "html_url": "https://github.com/coralproject/talk/commit/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/comments",
  "author": {
    "login": "cvle",
    "id": 14221600,
    "node_id": "MDQ6VXNlcjE0MjIxNjAw",
    "avatar_url": "https://avatars2.githubusercontent.com/u/14221600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cvle",
    "html_url": "https://github.com/cvle",
    "followers_url": "https://api.github.com/users/cvle/followers",
    "following_url": "https://api.github.com/users/cvle/following{/other_user}",
    "gists_url": "https://api.github.com/users/cvle/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cvle/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cvle/subscriptions",
    "organizations_url": "https://api.github.com/users/cvle/orgs",
    "repos_url": "https://api.github.com/users/cvle/repos",
    "events_url": "https://api.github.com/users/cvle/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cvle/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "74366bec555371f14b0fc53b73391176783d9519",
      "url": "https://api.github.com/repos/coralproject/talk/commits/74366bec555371f14b0fc53b73391176783d9519",
      "html_url": "https://github.com/coralproject/talk/commit/74366bec555371f14b0fc53b73391176783d9519"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 15,
    "deletions": 3
  },
  "files": [
    {
      "sha": "c713bac47e9a8d6cc0a605d41bf577d1afe568d5",
      "filename": "src/core/client/embed/Coral.ts",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/Coral.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/Coral.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/embed/Coral.ts?ref=fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
      "patch": "@@ -16,6 +16,8 @@ export interface Config {\n   events?: (eventEmitter: EventEmitter2) => void;\n   accessToken?: string;\n   enableDeprecatedEvents?: boolean;\n+  /** Allow setting className of body tag inside iframe */\n+  bodyClassName?: string;\n }\n \n export function createStreamEmbed(config: Config): StreamEmbed {\n@@ -37,6 +39,7 @@ export function createStreamEmbed(config: Config): StreamEmbed {\n     autoRender: config.autoRender,\n     eventEmitter,\n     accessToken: config.accessToken,\n+    bodyClassName: config.bodyClassName,\n     enableDeprecatedEvents: config.enableDeprecatedEvents,\n   });\n }"
    },
    {
      "sha": "3229eb4ae6688c358be2aef0a671b5a2fa6b5e26",
      "filename": "src/core/client/embed/StreamEmbed.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/StreamEmbed.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/StreamEmbed.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/embed/StreamEmbed.ts?ref=fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
      "patch": "@@ -33,6 +33,7 @@ export interface StreamEmbedConfig {\n   id: string;\n   rootURL: string;\n   accessToken?: string;\n+  bodyClassName?: string;\n   enableDeprecatedEvents?: boolean;\n }\n \n@@ -131,6 +132,7 @@ export class StreamEmbed {\n \n     const externalConfig: ExternalConfig = {\n       accessToken: this.config.accessToken,\n+      bodyClassName: this.config.bodyClassName,\n     };\n \n     const streamDecorators: ReadonlyArray<Decorator> = ["
    },
    {
      "sha": "6b27c39acff96495e597cd130a9fc5925edca0ca",
      "filename": "src/core/client/embed/decorators/withConfig.spec.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/decorators/withConfig.spec.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/embed/decorators/withConfig.spec.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/embed/decorators/withConfig.spec.ts?ref=fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
      "patch": "@@ -3,7 +3,7 @@ import sinon from \"sinon\";\n import withConfig from \"./withConfig\";\n \n it(\"should emit events from pym to Config\", () => {\n-  const config = { accessToken: \"token\" };\n+  const config = { accessToken: \"token\", bodyClassName: \"custom\" };\n   const fakePym = {\n     onMessage: (type: string, callback: () => void) => {\n       expect(type).toBe(\"getConfig\");"
    },
    {
      "sha": "53a62bbe59ac80bbf6b9242914b0f2654b535974",
      "filename": "src/core/client/framework/lib/externalConfig.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/coralproject/talk/blob/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/framework/lib/externalConfig.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/framework/lib/externalConfig.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/framework/lib/externalConfig.ts?ref=fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
      "patch": "@@ -4,6 +4,7 @@ import { areWeInIframe } from \"coral-framework/utils\";\n \n export interface ExternalConfig {\n   accessToken?: string;\n+  bodyClassName?: string;\n }\n \n export function getExternalConfig("
    },
    {
      "sha": "dae8465d0c1db6206b872a0766a436d7c0bccee2",
      "filename": "src/core/client/stream/local/initLocalState.ts",
      "status": "modified",
      "additions": 8,
      "deletions": 2,
      "changes": 10,
      "blob_url": "https://github.com/coralproject/talk/blob/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/stream/local/initLocalState.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/fe8cb90a1ca635e6cd75b3006f7c3721e71e5400/src/core/client/stream/local/initLocalState.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/local/initLocalState.ts?ref=fe8cb90a1ca635e6cd75b3006f7c3721e71e5400",
      "patch": "@@ -18,8 +18,14 @@ export default async function initLocalState(\n   auth?: AuthState\n ) {\n   const config = await getExternalConfig(context.pym);\n-  if (config && config.accessToken) {\n-    auth = storeAccessToken(config.accessToken);\n+  if (config) {\n+    if (config.accessToken) {\n+      auth = storeAccessToken(config.accessToken);\n+    }\n+    // append body class name if set in config.\n+    if (config.bodyClassName) {\n+      document.body.classList.add(config.bodyClassName);\n+    }\n   }\n \n   initLocalBaseState(environment, context, auth);"
    }
  ]
}
