{
  "sha": "a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6YTZiZTE2N2FmNTUzMDdhNWFhYTBhYTdmZGRlMGU1ZWFmMDZiYWNlYQ==",
  "commit": {
    "author": {
      "name": "Vinh",
      "email": "vinh@vinh.tech",
      "date": "2020-09-03T18:05:40Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-09-03T18:05:40Z"
    },
    "message": "Upgrade unblocked dependencies (#3173)\n\n* chore: upgrade final form\n\n* chore: upgrade graphql-playground-html\n\n* chore: downgrade react-final-form, upgrade jest packages\n\nCo-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>",
    "tree": {
      "sha": "632cc974b3180913c4a598583f0c79c312ae1232",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/632cc974b3180913c4a598583f0c79c312ae1232"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfUTB0CRBK7hj4Ov3rIwAAdHIIAA4VsO7BHPwBniMpYKdIxh7Y\nXRuUtcEE9oNr9spA6PwOYQ/uJT+pgiEtcXB2k2gcytGSTPwjhkRv/lfOxc114T08\n+DyrWlqEDGcKf9TZckHetzqBK/ePp8Zi5lyIl75er0LSVwa6gwAW5fYXxnexSvAu\n6EDu1aoO724FSrj22l5qCmbRAtevIVwZQg/E8pj2VQ1QmtJtMAjiy5lkotfBkdsn\nrsLfU8n25a6XdkO1fxFFCuxjduTdKMSDyiqyrHXRcemPiDpRIlU3uw2ZtijiUhdx\nx87Jneu43ebTfiZ5E/sY+6jxETGtvWcORmzt5u5DsaMwXO3ejsF2f7RQVmnt6OU=\n=3MaG\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 632cc974b3180913c4a598583f0c79c312ae1232\nparent a8e5df4b8a15ddac1b2cfdf967536b346022ef8b\nauthor Vinh <vinh@vinh.tech> 1599156340 +0200\ncommitter GitHub <noreply@github.com> 1599156340 +0000\n\nUpgrade unblocked dependencies (#3173)\n\n* chore: upgrade final form\n\n* chore: upgrade graphql-playground-html\n\n* chore: downgrade react-final-form, upgrade jest packages\n\nCo-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
  "html_url": "https://github.com/coralproject/talk/commit/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/comments",
  "author": {
    "login": "cvle",
    "id": 14221600,
    "node_id": "MDQ6VXNlcjE0MjIxNjAw",
    "avatar_url": "https://avatars2.githubusercontent.com/u/14221600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cvle",
    "html_url": "https://github.com/cvle",
    "followers_url": "https://api.github.com/users/cvle/followers",
    "following_url": "https://api.github.com/users/cvle/following{/other_user}",
    "gists_url": "https://api.github.com/users/cvle/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cvle/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cvle/subscriptions",
    "organizations_url": "https://api.github.com/users/cvle/orgs",
    "repos_url": "https://api.github.com/users/cvle/repos",
    "events_url": "https://api.github.com/users/cvle/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cvle/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a8e5df4b8a15ddac1b2cfdf967536b346022ef8b",
      "url": "https://api.github.com/repos/coralproject/talk/commits/a8e5df4b8a15ddac1b2cfdf967536b346022ef8b",
      "html_url": "https://github.com/coralproject/talk/commit/a8e5df4b8a15ddac1b2cfdf967536b346022ef8b"
    }
  ],
  "stats": {
    "total": 2506,
    "additions": 1389,
    "deletions": 1117
  },
  "files": [
    {
      "sha": "a93be1fc7c81d34707b20ae6c6bd2de013371513",
      "filename": "package-lock.json",
      "status": "modified",
      "additions": 1346,
      "deletions": 1070,
      "changes": 2416,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/package-lock.json",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/package-lock.json",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/package-lock.json?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea"
    },
    {
      "sha": "c0e4c8744f41f0f8efc3a9bc41de9735b6fb734f",
      "filename": "package.json",
      "status": "modified",
      "additions": 16,
      "deletions": 31,
      "changes": 47,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/package.json",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/package.json",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/package.json?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -97,7 +97,7 @@\n     \"graphql\": \"^14.6.0\",\n     \"graphql-config\": \"^2.2.2\",\n     \"graphql-fields\": \"2.0.3\",\n-    \"graphql-playground-html\": \"1.6.13\",\n+    \"graphql-playground-html\": \"^1.6.27\",\n     \"graphql-redis-subscriptions\": \"^2.2.1\",\n     \"graphql-subscriptions\": \"^1.1.0\",\n     \"graphql-tools\": \"^4.0.7\",\n@@ -183,8 +183,8 @@\n     \"@types/html-to-text\": \"^1.4.31\",\n     \"@types/html-webpack-plugin\": \"^3.2.3\",\n     \"@types/ioredis\": \"^4.14.9\",\n-    \"@types/jest\": \"^26.0.3\",\n-    \"@types/jest-axe\": \"^3.2.2\",\n+    \"@types/jest\": \"^26.0.13\",\n+    \"@types/jest-axe\": \"^3.5.0\",\n     \"@types/jsdom\": \"^16.2.0\",\n     \"@types/jsonwebtoken\": \"^8.3.8\",\n     \"@types/linkifyjs\": \"^2.1.3\",\n@@ -239,7 +239,7 @@\n     \"@typescript-eslint/parser\": \"^3.4.0\",\n     \"autoprefixer\": \"^9.7.5\",\n     \"babel-core\": \"^7.0.0-bridge.0\",\n-    \"babel-jest\": \"^26.1.0\",\n+    \"babel-jest\": \"^26.3.0\",\n     \"babel-loader\": \"^8.1.0\",\n     \"babel-plugin-lodash\": \"^3.3.4\",\n     \"babel-plugin-module-resolver\": \"^4.0.0\",\n@@ -273,7 +273,7 @@\n     \"eslint-plugin-react-hooks\": \"^4.0.8\",\n     \"eventemitter2\": \"^6.3.1\",\n     \"farce\": \"^0.2.8\",\n-    \"final-form\": \"4.18.6\",\n+    \"final-form\": \"^4.20.1\",\n     \"final-form-arrays\": \"^3.0.2\",\n     \"flat\": \"^5.0.0\",\n     \"fluent-intl-polyfill\": \"^0.1.0\",\n@@ -291,10 +291,10 @@\n     \"husky\": \"^4.2.3\",\n     \"intersection-observer\": \"^0.7.0\",\n     \"intl\": \"^1.2.5\",\n-    \"jest\": \"^26.1.0\",\n-    \"jest-axe\": \"^3.4.0\",\n-    \"jest-junit\": \"^11.0.1\",\n-    \"jest-localstorage-mock\": \"^2.4.2\",\n+    \"jest\": \"^26.4.2\",\n+    \"jest-axe\": \"^4.0.0\",\n+    \"jest-junit\": \"^11.1.0\",\n+    \"jest-localstorage-mock\": \"^2.4.3\",\n     \"jest-mock-console\": \"^1.0.1\",\n     \"keymaster\": \"^1.6.2\",\n     \"lint-staged\": \"^10.2.11\",\n@@ -326,7 +326,7 @@\n     \"react-dom\": \"^16.13.1\",\n     \"react-error-overlay\": \"^6.0.7\",\n     \"react-final-form\": \"6.3.0\",\n-    \"react-final-form-arrays\": \"^3.1.1\",\n+    \"react-final-form-arrays\": \"^3.1.2\",\n     \"react-helmet\": \"^5.2.1\",\n     \"react-popper\": \"^1.3.7\",\n     \"react-relay\": \"^10.0.1\",\n@@ -356,7 +356,7 @@\n     \"terser-webpack-plugin\": \"^2.3.5\",\n     \"thread-loader\": \"^2.1.3\",\n     \"timekeeper\": \"^2.2.0\",\n-    \"ts-jest\": \"26.1.1\",\n+    \"ts-jest\": \"26.3.0\",\n     \"ts-loader\": \"^7.0.5\",\n     \"ts-node\": \"^8.10.2\",\n     \"ts-node-dev\": \"1.0.0-pre.44\",\n@@ -379,36 +379,21 @@\n     \"whatwg-fetch\": \"^3.4.0\"\n   },\n   \"dependencies-pins-documentation\": {\n+    \"react-final-form@6.3.0\": [\n+      \"Newer versions has problems with radio and checkbox fields.\",\n+      \"Update when the following issue is resolved:\",\n+      \"https://github.com/final-form/react-final-form/issues/683\"\n+    ],\n     \"ts-node-dev@1.0.0-pre.44\": [\n       \"Newer versions unbearibly slow\"\n     ],\n-    \"ts-jest@25.4.0\": [\n-      \"Newer versions require every definition file to be included\",\n-      \"in tsconfig.json in the `files` field. This is cumbersome and\",\n-      \"here is a discussion of it: https://github.com/kulshekhar/ts-jest/issues/1604\"\n-    ],\n     \"wait-for-expect@1.x.x\": [\n       \"Newer versions breaks the use of jest fake timers\"\n     ],\n     \"consolidate@14.0.0\": [\n       \"Newer versions has problems with using nunjucks.\",\n       \"Update when the following issue is resolved:\",\n       \"https://github.com/tj/consolidate.js/issues/244\"\n-    ],\n-    \"final-form@4.18.6\": [\n-      \"Newer versions has problems with resetting forms.\",\n-      \"Update when the following issue is resolved:\",\n-      \"https://github.com/final-form/final-form/issues/317\"\n-    ],\n-    \"react-final-form@6.3.0\": [\n-      \"Newer versions has problems with radio and checkbox fields.\",\n-      \"Update when the following issue is resolved:\",\n-      \"https://github.com/final-form/react-final-form/issues/683\"\n-    ],\n-    \"graphql-playground-html@1.6.13\": [\n-      \"A template was broken in a release.\",\n-      \"Update when the following issue is resolved:\",\n-      \"https://github.com/prisma-labs/graphql-playground/pull/1238\"\n     ]\n   },\n   \"husky\": {"
    },
    {
      "sha": "03e8d84917d9b5504f54335292e484098b527b45",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/OIDCConfigContainer.tsx",
      "status": "modified",
      "additions": 8,
      "deletions": 4,
      "changes": 12,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/admin/routes/Configure/sections/Auth/OIDCConfigContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/admin/routes/Configure/sections/Auth/OIDCConfigContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/OIDCConfigContainer.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -50,20 +50,24 @@ class OIDCConfigContainer extends React.Component<Props, State> {\n       if (config) {\n         if (config.issuer) {\n           this.props.form.change(\n-            \"auth.integrations.oidc.issuer\",\n+            // TODO: @(cvle) Types in final-form are not accurate...\n+            \"auth.integrations.oidc.issuer\" as any,\n             config.issuer\n           );\n         }\n         this.props.form.change(\n-          \"auth.integrations.oidc.authorizationURL\",\n+          // TODO: @(cvle) Types in final-form are not accurate...\n+          \"auth.integrations.oidc.authorizationURL\" as any,\n           config.authorizationURL\n         );\n         this.props.form.change(\n-          \"auth.integrations.oidc.jwksURI\",\n+          // TODO: @(cvle) Types in final-form are not accurate...\n+          \"auth.integrations.oidc.jwksURI\" as any,\n           config.jwksURI\n         );\n         this.props.form.change(\n-          \"auth.integrations.oidc.tokenURL\",\n+          // TODO: @(cvle) Types in final-form are not accurate...\n+          \"auth.integrations.oidc.tokenURL\" as any,\n           config.tokenURL\n         );\n       }"
    },
    {
      "sha": "9178899dcd5aec389f3633665c0f7b59144481df",
      "filename": "src/core/client/framework/lib/form/withForm.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/framework/lib/form/withForm.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/framework/lib/form/withForm.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/framework/lib/form/withForm.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -8,7 +8,7 @@ import {\n } from \"recompose\";\n \n interface FormProps {\n-  form: FormApi;\n+  form: FormApi<any>;\n }\n const withForm: InferableComponentEnhancer<FormProps> = hoistStatics<any>(\n   (WrappedComponent: React.ComponentType<any>) => {"
    },
    {
      "sha": "d4b49565ad2cba9b17a664b5384c76bf37a3a742",
      "filename": "src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentForm.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentForm.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentForm.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentForm.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -50,6 +50,7 @@ const ReplyCommentForm: FunctionComponent<ReplyCommentFormProps> = (props) => {\n         rteRef={props.rteRef}\n         siteID={props.siteID}\n         onSubmit={props.onSubmit}\n+        onChange={props.onChange}\n         initialValues={props.initialValues}\n         min={props.min}\n         max={props.max}"
    },
    {
      "sha": "5061f28dd426293930cd692745ac1a33df5c9659",
      "filename": "src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.tsx",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Comment/ReplyCommentForm/ReplyCommentFormContainer.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -177,8 +177,12 @@ export class ReplyCommentFormContainer extends Component<Props, State> {\n       void this.props.sessionStorage.removeItem(this.contextKey);\n     }\n     // Reset errors whenever user clears the form.\n-    if (state.touched && state.touched.body && !state.values.body) {\n-      form.reset({ body: RTE_RESET_VALUE });\n+    if (\n+      state.touched &&\n+      state.touched.body &&\n+      (!state.values.body || state.values.body === RTE_RESET_VALUE)\n+    ) {\n+      (form as any).restart({ body: RTE_RESET_VALUE });\n     }\n   };\n "
    },
    {
      "sha": "db9670bed43c2a2f397ddf9dad5befd26cf789b5",
      "filename": "src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 7,
      "changes": 9,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.spec.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -1,4 +1,5 @@\n import { shallow } from \"enzyme\";\n+import { createForm } from \"final-form\";\n import { noop } from \"lodash\";\n import React from \"react\";\n import sinon from \"sinon\";\n@@ -9,7 +10,6 @@ import { createPromisifiedStorage } from \"coral-framework/lib/storage\";\n import { act, removeFragmentRefs, wait } from \"coral-framework/testHelpers\";\n import { DeepPartial, PropTypesOf } from \"coral-framework/types\";\n \n-import { RTE_RESET_VALUE } from \"../../RTE/RTE\";\n import { PostCommentFormContainer } from \"./PostCommentFormContainer\";\n \n const contextKey = \"postCommentFormBody\";\n@@ -136,9 +136,7 @@ it(\"creates a comment\", async () => {\n   const storyID = \"story-id\";\n   const input = { body: \"Hello World!\" };\n   const createCommentStub = sinon.stub().returns({ edge: { node: {} } });\n-  const form = { initialize: noop };\n-  const formMock = sinon.mock(form);\n-  formMock.expects(\"initialize\").withArgs({ body: RTE_RESET_VALUE }).once();\n+  const form = createForm({ onSubmit: noop });\n \n   const props = createDefaultProps({\n     createComment: createCommentStub,\n@@ -176,9 +174,6 @@ it(\"creates a comment\", async () => {\n       ).toBeTruthy()\n     );\n   });\n-  await act(async () => {\n-    await wait(() => formMock.verify());\n-  });\n });\n \n it(\"renders when story has been closed (collapsing)\", async () => {"
    },
    {
      "sha": "dc3dd1e47af36f75fa65c9994ce5b1f9918eecc5",
      "filename": "src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.tsx",
      "status": "modified",
      "additions": 9,
      "deletions": 2,
      "changes": 11,
      "blob_url": "https://github.com/coralproject/talk/blob/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/a6be167af55307a5aaa0aa7fdde0e5eaf06bacea/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/PostCommentForm/PostCommentFormContainer.tsx?ref=a6be167af55307a5aaa0aa7fdde0e5eaf06bacea",
      "patch": "@@ -147,6 +147,9 @@ export class PostCommentFormContainer extends Component<Props, State> {\n         })\n       );\n       if (submitStatus !== \"RETRY\") {\n+        form\n+          .getRegisteredFields()\n+          .forEach((name) => form.resetFieldState(name));\n         form.initialize({ body: RTE_RESET_VALUE });\n       }\n       this.setState({ submitStatus, nudge: true });\n@@ -197,8 +200,12 @@ export class PostCommentFormContainer extends Component<Props, State> {\n     }\n \n     // Reset errors whenever user clears the form.\n-    if (state.touched && state.touched.body && !state.values.body) {\n-      form.reset({ body: RTE_RESET_VALUE });\n+    if (\n+      state.touched &&\n+      state.touched.body &&\n+      (!state.values.body || state.values.body === RTE_RESET_VALUE)\n+    ) {\n+      (form as any).restart({ body: RTE_RESET_VALUE });\n     }\n   };\n "
    }
  ]
}
