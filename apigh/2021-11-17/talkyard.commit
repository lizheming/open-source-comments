{
  "sha": "f93d7812264feefa8683d1781ca15a8947a88cef",
  "node_id": "C_kwDOAKEu-toAKGY5M2Q3ODEyMjY0ZmVlZmE4NjgzZDE3ODFjYTE1YTg5NDdhODhjZWY",
  "commit": {
    "author": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2021-11-04T07:04:23Z"
    },
    "committer": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2021-11-04T07:04:23Z"
    },
    "message": "Merge v0.2021.31 into 'release'.",
    "tree": {
      "sha": "0535be55b050168769f7be991e6e0541797a4782",
      "url": "https://api.github.com/repos/debiki/talkyard/git/trees/0535be55b050168769f7be991e6e0541797a4782"
    },
    "url": "https://api.github.com/repos/debiki/talkyard/git/commits/f93d7812264feefa8683d1781ca15a8947a88cef",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/debiki/talkyard/commits/f93d7812264feefa8683d1781ca15a8947a88cef",
  "html_url": "https://github.com/debiki/talkyard/commit/f93d7812264feefa8683d1781ca15a8947a88cef",
  "comments_url": "https://api.github.com/repos/debiki/talkyard/commits/f93d7812264feefa8683d1781ca15a8947a88cef/comments",
  "author": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "463dc6017107704d196ac590c1e9d6aa238cb1bb",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/463dc6017107704d196ac590c1e9d6aa238cb1bb",
      "html_url": "https://github.com/debiki/talkyard/commit/463dc6017107704d196ac590c1e9d6aa238cb1bb"
    },
    {
      "sha": "658eb1144186b251718924289be4c4228d5cb75b",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/658eb1144186b251718924289be4c4228d5cb75b",
      "html_url": "https://github.com/debiki/talkyard/commit/658eb1144186b251718924289be4c4228d5cb75b"
    }
  ],
  "stats": {
    "total": 786,
    "additions": 484,
    "deletions": 302
  },
  "files": [
    {
      "sha": "95b3caab2b73f882c992b9c3f9e3394ed18f4d82",
      "filename": "README.md",
      "status": "modified",
      "additions": 6,
      "deletions": 4,
      "changes": 10,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/README.md",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/README.md",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/README.md?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -370,19 +370,21 @@ how to use docker-compose already.\n     gpg2 --verify ./install-nix-2.3.15.asc\n     ```\n \n-    Install Nix and Niv. Either 1/2: First create the `/nix` directory for yourself,\n+    Install Nix and, optionally, Niv.\n+    Either **1/2:** First create the `/nix` directory for yourself,\n     and then install — no need to be root:\n     (see https://nixos.wiki/wiki/Nix_Installation_Guide)\n+\n     ```\n     sudo install --directory --mode=755 --owner=$(id -u) --group=$(id -g) /nix\n-    sh ./install-nix-2.3.15  # not root\n-    nix-env -iA nixpkgs.niv\n+    sh ./install-nix-2.3.15    # not root\n+    # nix-env -iA nixpkgs.niv  # optionally, if you want to upgrade Ty's build tools\n     ```\n \n     (To uninstall Nix, remove `/nix`, a line in `~/.profile`, and:\n     `~/{.nix-channels,.nix-defexpr,.nix-profile,.config/nixpkgs}`)\n \n-    Or, 2/2, alternatively, you can do a multi-user installation of Nix:\n+    Or alternatively, **2/2:** Do a multi-user installation of Nix:\n     https://nixos.org/manual/nix/stable/#sect-multi-user-installation\n     (then I'd think it's best to use the above `./install-nix-...`\n     script whose signature you've verified)."
    },
    {
      "sha": "9c48164958a094dc79c5713969c58676f3eb2cdd",
      "filename": "appsv/rdb/src/main/resources/db/migration/y2021/v411__sessions_t.sql",
      "status": "added",
      "additions": 85,
      "deletions": 0,
      "changes": 85,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/rdb/src/main/resources/db/migration/y2021/v411__sessions_t.sql",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/rdb/src/main/resources/db/migration/y2021/v411__sessions_t.sql",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/rdb/src/main/resources/db/migration/y2021/v411__sessions_t.sql?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -0,0 +1,85 @@\n+\n+create domain browser_id_d text;\n+alter domain  browser_id_d add constraint browser_id_d_c_shte60 check (length(value) <= 60);\n+alter domain  browser_id_d add constraint browser_id_d_c_lote14 check (length(value) >= 14);\n+alter domain  browser_id_d add constraint browser_id_d_c_chars  check (value ~ '^[a-zA-Z0-9._=-]*$');\n+\n+-- \"us\" is here for \"url safe\".\n+create domain base64us_inf_d text_nonempty_inf_d;\n+alter domain  base64us_inf_d add constraint base64us_inf_d_c_chars\n+    check (value ~ '^[a-zA-Z0-9_=-]*$');\n+\n+create domain base64us_len16_d base64us_inf_d;\n+alter domain  base64us_len16_d add constraint base64us_len16_d_c_len16\n+    check (length(value) = 16);\n+\n+-- For storing a SHA-512/224 or BLAKE3 hash the first 224 bits only.\n+create domain bytea_len28_d bytea;\n+alter domain  bytea_len28_d add constraint bytea_len28_d_c_len28\n+    check (length(value) = 28);\n+\n+-- For storing a SHA-512/256 or BLAKE3 hash, 256 bits.\n+create domain bytea_len32_d bytea;\n+alter domain  bytea_len32_d add constraint bytea_len32_d_c_len32\n+    check (length(value) = 32);\n+\n+-- For storing a 384 bits hash.\n+create domain bytea_len48_d bytea;\n+alter domain  bytea_len48_d add constraint bytea_len48_d_c_len48\n+    check (length(value) = 48);\n+\n+-- For storing a 512 bits hash.\n+create domain bytea_len64_d bytea;\n+alter domain  bytea_len64_d add constraint bytea_len64_d_c_len64\n+    check (length(value) = 64);\n+\n+\n+create table sessions_t (\n+  site_id_c i32_d,  -- pk\n+  pat_id_c i32_d,  -- pk\n+  created_at_c timestamp, -- pk\n+  deleted_at_c timestamp,\n+  expired_at_c timestamp,\n+  version_c i16_gz_d not null,\n+  start_ip_c inet,\n+  start_browser_id_c browser_id_d,\n+  start_headers_c jsonb,\n+  part_1_comp_id_c base64us_len16_d not null,\n+  hash_2_for_embg_storage_c bytea_len32_d not null,\n+  hash_3_for_dir_js_c bytea_len32_d not null,\n+  hash_4_http_only_c bytea_len32_d not null,\n+  hash_5_strict_c bytea_len32_d not null,\n+\n+  constraint sessions_p_patid_createdat primary key (site_id_c, pat_id_c, created_at_c),\n+\n+  -- Part 1 needs to be unique, because it's used to compare session ids with\n+  -- each other, to see if they are the same (but more parts needed to\n+  -- actually use a session for anything).  [sid_part1]\n+  constraint sessions_u_part1 unique (site_id_c, part_1_comp_id_c),\n+\n+  -- We never lookup by part 2 or 3. (So, no indexes or unique constraints.)\n+\n+  -- There needs to be an index on part 4, so we can find sessions where part 1\n+  -- is missing (because of logging out client side only, when not connected to\n+  -- the server — then, parts 1-3 get deleted, but not parts 4 and 5, which are\n+  -- HttpOnly cookies). And then, we might as well make part 4 unique? — to catch bugs,\n+  -- because if not unique, that'd be a bug somehow (since statistically impossible).\n+  constraint sessions_u_hash4 unique (site_id_c, hash_4_http_only_c),\n+\n+  -- We never lookup by part 5.\n+\n+  -- fk ix: primary key\n+  constraint sessions_r_pats foreign key (site_id_c, pat_id_c)\n+    references users3 (site_id, user_id) deferrable,\n+\n+  constraint sessions_c_createdat_lte_deletedat check (created_at_c <= deleted_at_c),\n+  constraint sessions_c_createdat_lte_expiredat check (created_at_c <= expired_at_c),\n+\n+  constraint settings_c_startheaders_len check (pg_column_size(start_headers_c) <= 1000)\n+);\n+\n+\n+-- For quickly finding all active sessions by someone.\n+create index sessions_i_patid_createdat_active\n+    on sessions_t (site_id_c, pat_id_c, created_at_c desc)\n+    where deleted_at_c is null and expired_at_c is null;"
    },
    {
      "sha": "42a00c91b573d5850b17c696b402971c320848c9",
      "filename": "appsv/server/controllers/LoginController.scala",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/controllers/LoginController.scala",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/controllers/LoginController.scala",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/controllers/LoginController.scala?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -90,7 +90,7 @@ class LoginController @Inject()(cc: ControllerComponents, edContext: EdContext)\n   }\n \n \n-  private val EmbCommentsModeStr = 16.toString  // [8UKBR2AD5]\n+  private val EmbCommentsModeStr = 16  // also in model.ts [8UKBR2AD5]\n \n   /** For showing a login dialog inside a popup window. Used when   [2ABKW24T]\n     * 1) logging in in an iframe,"
    },
    {
      "sha": "f755ec25aa87307d901eacbf906e319b910ed437",
      "filename": "appsv/server/controllers/ViewPageController.scala",
      "status": "modified",
      "additions": 8,
      "deletions": 3,
      "changes": 11,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/controllers/ViewPageController.scala",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/controllers/ViewPageController.scala",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/controllers/ViewPageController.scala?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -372,8 +372,11 @@ class ViewPageController @Inject()(cc: ControllerComponents, edContext: EdContex\n \n object ViewPageController {\n \n-  val HtmlEncodedVolatileJsonMagicString =\n-    \"\\\"__html_encoded_volatile_json__\\\"\"\n+  val HtmlEncodedVolatileJsonMagicStringNoQuotes =\n+    \"__html_encoded_volatile_json__\"\n+\n+  val HtmlEncodedVolatileJsonMagicStringQuoted: St =\n+    \"\\\"\" + HtmlEncodedVolatileJsonMagicStringNoQuotes + \"\\\"\"\n \n   val ContSecPolHeaderName = \"Content-Security-Policy\"\n   val objectSrcNonePolicy = \"object-src 'none'; \"\n@@ -433,9 +436,11 @@ object ViewPageController {\n     // The Scala templates take care to place the <script type=\"application/json\">\n     // tag with the magic-string-that-we'll-replace-with-user-specific-data before\n     // user editable HTML for comments and the page title and body. [8BKAZ2G]\n+    // (We replace the quotes around the string too, or the page json would end up\n+    // inside \"...\".)\n     val htmlEncodedJson = org.owasp.encoder.Encode.forHtmlContent(volatileJson.toString)\n     val pageHtml = org.apache.commons.lang3.StringUtils.replaceOnce(\n-        pageHtmlNoVolData, HtmlEncodedVolatileJsonMagicString, htmlEncodedJson)\n+          pageHtmlNoVolData, HtmlEncodedVolatileJsonMagicStringQuoted, htmlEncodedJson)\n \n     requester.foreach(dao.pubSub.userIsActive(request.siteId, _, request.theBrowserIdData))\n "
    },
    {
      "sha": "b50231a27fa65490d6e73d6d4cfee6e400f8f6da",
      "filename": "appsv/server/debiki/PageTpi.scala",
      "status": "modified",
      "additions": 26,
      "deletions": 11,
      "changes": 37,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/debiki/PageTpi.scala",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/debiki/PageTpi.scala",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/debiki/PageTpi.scala?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -133,13 +133,25 @@ class SiteTpi protected (\n     globals.config.featureFlags.contains(\"ffNoPolyfillDotIo\")\n \n   def avoidPolyfillDotIo: Bo =\n-    globals.config.featureFlags.contains(\"ffAvoidPolyfillDotIo\")\n+    // Was: globals.config.featureFlags.contains(\"ffAvoidPolyfillDotIo\")\n+    // But let's avoid always, by default, nowadays: (after Oct 2021)\n+    !globals.config.featureFlags.contains(\"ffAlwaysPolyfillDotIo\")\n \n   def debikiHtmlTagClasses: String = {\n     // Sync with js [4JXW5I2].\n     val chatClass = if (anyCurrentPageRole.exists(_.isChat)) \" es-chat\" else \"\"\n     val forumClass = if (anyCurrentPageRole.contains(PageType.Forum)) \" es-forum\" else \"\"\n-    val customClass = anyCurrentPageMeta.map(\" \" + _.htmlTagCssClasses) getOrElse \"\"\n+\n+    var customClass = anyCurrentPageMeta.map(\" \" + _.htmlTagCssClasses) getOrElse \"\"\n+    // Any page custom html classes would appear before the json data placeholder,\n+    // and we don't want to insert the json data in the html class attribute, so:  [8BKAZ2G]\n+    // (Use ...NoQuotes, because then no need to think about if the quotes got escaped\n+    // or not, and would/could there then still be a match or not.)\n+    if (customClass contains\n+          controllers.ViewPageController.HtmlEncodedVolatileJsonMagicStringNoQuotes) {\n+      customClass = \"\"\n+    }\n+\n     val pageTypeClass = anyCurrentPageRole.map(\" s_PT-\" + _.toInt) getOrElse \"\"     // [5J7KTW2]\n     val pageLayoutClass = anyCurrentPageLayout.map(\" s_PL-\" + _.toInt) getOrElse \"\"\n     \"DW dw-pri\" + pageTypeClass + pageLayoutClass + chatClass + forumClass + customClass + \" \"\n@@ -148,11 +160,11 @@ class SiteTpi protected (\n   def xsrfToken: String = debikiRequest.xsrfToken.value\n \n \n-  def debikiStyles: xml.Unparsed =\n+  def talkyardStyles: xml.Unparsed =\n     xml.Unparsed(views.html.debikiStyles(this).body)\n \n   CLEAN_UP // isAdminApp not needed? already has isAdminArea.\n-  def debikiScriptsInHead(\n+  def jsonDataMustBeFirst(\n         isCreateSitePage: Bo = false,\n         isInLoginWindow: Bo = false,\n         isInLoginPopup: Bo = false,\n@@ -229,16 +241,20 @@ class SiteTpi protected (\n         \"resetPasswordEmailId\" -> JsString(anyResetPasswordEmailId))\n     }\n \n-    xml.Unparsed(views.html.debikiScriptsHead(\n-          tpi = this,\n+    xml.Unparsed(views.html.tags.jsonDataMustBeFirst(\n           safeStaticJsonSt = safeStaticJson.toString,\n           reactStoreSafeJsonString = reactStoreSafeJsonString).body)\n   }\n \n \n-  def scriptBundlesEndOfBody(loadStaffBundle: Bo = false): xml.Unparsed =\n+  def parseJsonUpdDocClassesScript(): xml.Unparsed = {\n+    xml.Unparsed(views.html.debikiScriptsHead(tpi = this).body)\n+  }\n+\n+\n+  def talkyardScriptBundles(loadStaffBundle: Bo = false): xml.Unparsed =\n     xml.Unparsed(\n-          views.html.debikiScriptsEndOfBody(\n+          views.html.tags.talkyardScriptBundles(\n               this, loadStaffBundle = loadStaffBundle).body)\n \n \n@@ -276,7 +292,7 @@ class SiteTpi protected (\n   def minMaxCss: String = PageTpi.minMaxCss\n   def minMaxJs: String = PageTpi.minMaxJs\n \n-  def stylesheetBundle(bundleName: String): xml.NodeSeq = {\n+  def anySiteCustomStylesBundle(bundleName: String): xml.NodeSeq = {\n \n     val (nameNoSuffix, suffix) = bundleName match {\n       case StylesheetAssetBundleNameRegex(nameNoSuffix, suffix) =>\n@@ -310,8 +326,7 @@ class SiteTpi protected (\n     }\n   }\n \n-  RENAME // to anySiteCustomScriptsBundle\n-  def anyScriptsBundle(): xml.NodeSeq = {\n+  def anySiteCustomScriptBundle(): xml.NodeSeq = {\n     val version = debikiRequest.dao.getAssetBundleVersion(\"scripts\", \"js\") getOrElse {\n       return <span></span>\n     }"
    },
    {
      "sha": "0a415117c90b0026ba245b68271683aeaf2234ba",
      "filename": "appsv/server/views/adminPage.scala.html",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/adminPage.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/adminPage.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/adminPage.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -20,9 +20,10 @@\n <!DOCTYPE html>\n <html class=\"dw-pri DW dw-admin-page\">\n <head>\n-  @tpi.debikiMeta\n-  @tpi.debikiStyles\n-  @tpi.debikiScriptsInHead(isAdminApp = true)\n+@tpi.jsonDataMustBeFirst(isAdminApp = true)\n+@tpi.debikiMeta\n+@tpi.talkyardStyles\n+@tpi.parseJsonUpdDocClassesScript()\n </head>\n <body>\n <!-- adminPage.scala.html -->\n@@ -37,6 +38,6 @@\n <div id=\"esWatchbarColumn\"></div>\n <div id=\"esThisbarColumn\"><div id=\"dw-any-sidebar\"></div></div>\n \n-@tpi.scriptBundlesEndOfBody(loadStaffBundle = true)\n+@tpi.talkyardScriptBundles(loadStaffBundle = true)\n </body>\n </html>"
    },
    {
      "sha": "b04522a8bb19eba7580a553b292faa3f4d77d73c",
      "filename": "appsv/server/views/authn/authnPageHtmlDoc.scala.html",
      "status": "modified",
      "additions": 15,
      "deletions": 12,
      "changes": 27,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/authn/authnPageHtmlDoc.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/authn/authnPageHtmlDoc.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/authn/authnPageHtmlDoc.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -20,18 +20,21 @@\n <!DOCTYPE html>\n <html class=\"DW dw-pri\">\n <head>\n-  <meta name=\"viewport\" content=\"width=device-width\">\n-  <meta charset=\"utf-8\"/>\n-  @tpi.debikiStyles\n-  @if(!tpi.isAdminArea) @{\n-   // But don't load these, when logging in to the Admin Area — then, if there's\n-   // a problem, maybe we couldn't login to fix it.\n-   tpi.stylesheetBundle(\"styles.css\")\n-  }\n-  @tpi.debikiScriptsInHead(isInLoginWindow = true, isInLoginPopup = isInLoginPopup)\n-  <script src=\"@tpi.assetUrl(s\"translations/${tpi.languageCode}/i18n.${tpi.minMaxJs}\")\"></script>\n-  <script src=\"@tpi.assetUrl(s\"slim-bundle.${tpi.minMaxJs}\")\"></script>\n-  <script src=\"@tpi.assetUrl(s\"more-bundle.${tpi.minMaxJs}\")\"></script>\n+@tpi.jsonDataMustBeFirst(isInLoginWindow = true, isInLoginPopup = isInLoginPopup)\n+\n+<meta name=\"viewport\" content=\"width=device-width\">\n+<meta charset=\"utf-8\"/>\n+@tpi.talkyardStyles\n+@if(!tpi.isAdminArea) @{\n+// But don't load these, when logging in to the Admin Area — then, if there's\n+// a problem, maybe we couldn't login to fix it.\n+tpi.anySiteCustomStylesBundle(\"styles.css\")\n+}\n+\n+@tpi.parseJsonUpdDocClassesScript()\n+<script src=\"@tpi.assetUrl(s\"translations/${tpi.languageCode}/i18n.${tpi.minMaxJs}\")\"></script>\n+<script src=\"@tpi.assetUrl(s\"slim-bundle.${tpi.minMaxJs}\")\"></script>\n+<script src=\"@tpi.assetUrl(s\"more-bundle.${tpi.minMaxJs}\")\"></script>\n </head>\n <body>\n   <!-- views/authn/authnPageHtmlDoc.scala.html -->"
    },
    {
      "sha": "6f8884a7930a9a727c40d56e9c70b9555bd58586",
      "filename": "appsv/server/views/createsite/createSitePage.scala.html",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/createsite/createSitePage.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/createsite/createSitePage.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/createsite/createSitePage.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -21,9 +21,10 @@\n <!DOCTYPE html>\n <html class=\"dw-pri DW\">\n <head>\n+@tpi.jsonDataMustBeFirst(isCreateSitePage = true)\n @tpi.debikiMeta\n-@tpi.debikiStyles\n-@tpi.debikiScriptsInHead(isCreateSitePage = true)\n+@tpi.talkyardStyles\n+@tpi.parseJsonUpdDocClassesScript()\n </head>\n <body style=\"overflow: auto\">\n <!-- createSitePage.scala.html -->\n@@ -42,6 +43,6 @@\n   <div id=\"dw-react-create-site\"></div>\n </div>\n \n-@tpi.scriptBundlesEndOfBody(loadStaffBundle = true)\n+@tpi.talkyardScriptBundles(loadStaffBundle = true)\n </body>\n </html>"
    },
    {
      "sha": "20ae4cdfb5bda376d2b63e4984c31a4904e86d53",
      "filename": "appsv/server/views/createsite/main.scala.html",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/createsite/main.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/createsite/main.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/createsite/main.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -21,7 +21,7 @@\n <html>\n <head>\n <title>Create Website</title>\n-@tpi.debikiStyles\n+@tpi.talkyardStyles\n <style>@Html(css)</style>\n </head>\n <body style=\"overflow: auto\">"
    },
    {
      "sha": "bc9f59ec4f747a56e1e98519f9c99f9af5e16263",
      "filename": "appsv/server/views/debikiScriptsHead.scala.html",
      "status": "modified",
      "additions": 1,
      "deletions": 20,
      "changes": 21,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/debikiScriptsHead.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/debikiScriptsHead.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/debikiScriptsHead.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -15,25 +15,6 @@\n  * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n  *@\n \n-@(tpi: debiki.SiteTpi, safeStaticJsonSt: String, reactStoreSafeJsonString: String)\n-\n-@import org.owasp.encoder.Encode\n-\n-<script id=\"theVolatileJson\" type=\"application/json\">\n-@* Here we place quickly changing data and user specific data. Note that\n-this tag is placed before #thePageJson below, so if e.g. a comment contains\n-the below magic string then that won't matter because we replace only the very first\n-occurrence of the magic string with volatile + user specific data. [8BKAZ2G] *@\n-@Html(controllers.ViewPageController.HtmlEncodedVolatileJsonMagicString)\n-</script>\n-\n-<script id=\"thePageJson\" type=\"application/json\">\n-@* Play Framework escapes too much (it escapes '\"'), so use @Html and OWASP instead. *@\n-@Html(Encode.forHtmlContent(reactStoreSafeJsonString))\n-</script>\n-\n-<script id=\"theStaticJson\" type=\"application/json\">\n-@Html(Encode.forHtmlContent(safeStaticJsonSt))\n-</script>\n+@(tpi: debiki.SiteTpi)\n \n <script src=\"@tpi.assetUrl(s\"head-bundle.${tpi.minMaxJs}\")\"></script>"
    },
    {
      "sha": "51ee0a9b892bf1d9a6e4526e28d60fd4f8baa85e",
      "filename": "appsv/server/views/embeddedEditor.scala.html",
      "status": "modified",
      "additions": 8,
      "deletions": 18,
      "changes": 26,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/embeddedEditor.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/embeddedEditor.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/embeddedEditor.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1,5 +1,5 @@\n @**\n- * Copyright (c) 2014-2015, 2017 Kaj Magnus Lindberg\n+ * Copyright (c) 2014-2015, 2017, 2021 Kaj Magnus Lindberg\n  *\n  * This program is free software: you can redistribute it and/or modify\n  * it under the terms of the GNU Affero General Public License as\n@@ -20,29 +20,19 @@\n \n <html class=\"DW dw-pri dw-embedded-editor\">\n <head>\n-@tpi.debikiMeta\n-@tpi.debikiStyles\n-@tpi.stylesheetBundle(\"styles.css\")\n-\n-@* Won't work any more: anyEmbeddedPageId,  with [many_embcom_iframes]  *@\n-@tpi.debikiScriptsInHead(\n+@tpi.jsonDataMustBeFirst(\n       isInEmbeddedEditor = true,\n       embeddingScriptV = embeddingScriptV)\n \n-@* [script_src_self]\n-<script>\n-eds.isInEmbeddedEditor = true;\n-eds.isInEmbeddedCommentsIframe = false;\n-eds.embeddedPageId = @Html(embeddedPageIdOrUndefined);    [6932867RMS]\n-  was: tpi.anyEmbeddedPageId.map(id => s\"'${ Encode.forJavaScript(id) }'\") getOrElse \"undefined\"\n-_store.currentPage = {};    Avoids null errors when editor accesses the current page. [2BK4P3R]\n-_store.me = _volatileData.me;   [603WMSRKD3]\n-</script>\n-*@\n+@tpi.debikiMeta\n+@tpi.talkyardStyles\n+@tpi.anySiteCustomStylesBundle(\"styles.css\")\n+\n+@tpi.parseJsonUpdDocClassesScript()\n </head>\n <body>\n   <!-- embeddedEditor.scala.html -->\n   <div id=\"dw-editor\"></div>\n-  @tpi.scriptBundlesEndOfBody()\n+  @tpi.talkyardScriptBundles()\n </body>\n </html>"
    },
    {
      "sha": "258485da5c5213263e4d7c4e0e434ae965a08968",
      "filename": "appsv/server/views/resetpassword/chooseNewPassword.scala.html",
      "status": "modified",
      "additions": 5,
      "deletions": 16,
      "changes": 21,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/resetpassword/chooseNewPassword.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/resetpassword/chooseNewPassword.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/resetpassword/chooseNewPassword.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -21,32 +21,21 @@\n <!DOCTYPE html>\n <html class=\"dw-pri DW\">\n <head>\n+@tpi.jsonDataMustBeFirst(resetPasswordPageData = Some((user, anyResetPasswordEmailId)))\n @tpi.debikiMeta\n-@tpi.debikiStyles\n-@tpi.debikiScriptsInHead(resetPasswordPageData = Some((user, anyResetPasswordEmailId)))\n+@tpi.talkyardStyles\n+@tpi.parseJsonUpdDocClassesScript()\n </head>\n <body>\n <!-- chooseNewPassword.scala.html -->\n \n <div class=\"container\">\n   <div class='row'>\n-    <h1>Choose New Password</h1>\n+    <h1>Choose New Password</h1>@* I18N *@\n   </div>\n   <div id=\"dw-react-new-password\"></div>\n </div>\n \n-@* <script>[script_src_self]\n-var newPasswordData = {\n-  fullName: '@(user.fullName.getOrElse(\"\"))',\n-  username: '@(user.theUsername)',\n-  email: '@(user.email)',\n-  minLength: @(tpi.globals.minPasswordLengthAllSites),\n-  resetPasswordEmailId: '@anyResetPasswordEmailId'\n-};\n-</script>\n-@tpi.debikiScriptsEndOfBodyCustomStartupCode(\"debiki2.login.renderNewPasswordPage();\")\n-*@\n-\n-@tpi.scriptBundlesEndOfBody()\n+@tpi.talkyardScriptBundles()\n </body>\n </html>"
    },
    {
      "sha": "5f0f90f7fa58d173de1375bae7245d5def758c1f",
      "filename": "appsv/server/views/specialpages/createSomethingHerePage.scala.html",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/specialpages/createSomethingHerePage.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/specialpages/createSomethingHerePage.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/specialpages/createSomethingHerePage.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -21,9 +21,10 @@\n <!DOCTYPE html>\n <html class=\"dw-pri DW\">\n <head>\n+@tpi.jsonDataMustBeFirst()\n @tpi.debikiMeta\n-@tpi.debikiStyles\n-@tpi.debikiScriptsInHead()\n+@tpi.talkyardStyles\n+@tpi.parseJsonUpdDocClassesScript()\n </head>\n <body>\n <!-- createSomethingHerePage.scala.html -->\n@@ -34,6 +35,6 @@\n     <div id=\"dw-non-existing-page\"></div>\n </div>\n \n-@tpi.scriptBundlesEndOfBody()\n+@tpi.talkyardScriptBundles()\n </body>\n </html>"
    },
    {
      "sha": "f2570812eaceb95722cd83b0d748640847914eb3",
      "filename": "appsv/server/views/tags/jsonDataMustBeFirst.scala.html",
      "status": "added",
      "additions": 37,
      "deletions": 0,
      "changes": 37,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/tags/jsonDataMustBeFirst.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/tags/jsonDataMustBeFirst.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/tags/jsonDataMustBeFirst.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -0,0 +1,37 @@\n+@**\n+ * Copyright (c) 2013-2020 Kaj Magnus Lindberg\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as\n+ * published by the Free Software Foundation, either version 3 of the\n+ * License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ *@\n+\n+@(safeStaticJsonSt: String, reactStoreSafeJsonString: String)\n+\n+@import org.owasp.encoder.Encode\n+\n+<script id=\"theVolatileJson\" type=\"application/json\">\n+@* Here we place quickly changing data and user specific data. Note that\n+this tag is placed before #thePageJson below, so if e.g. a comment contains\n+the below magic string then that won't matter because we replace only the very first\n+occurrence of the magic string with volatile + user specific data. [8BKAZ2G] *@\n+@Html(controllers.ViewPageController.HtmlEncodedVolatileJsonMagicStringQuoted)\n+</script>\n+\n+<script id=\"thePageJson\" type=\"application/json\">\n+@* Play Framework escapes too much (it escapes '\"'), so use @Html and OWASP instead. *@\n+@Html(Encode.forHtmlContent(reactStoreSafeJsonString))\n+</script>\n+\n+<script id=\"theStaticJson\" type=\"application/json\">\n+@Html(Encode.forHtmlContent(safeStaticJsonSt))\n+</script>"
    },
    {
      "sha": "54ad92d6b31848ab40fafd5b2c1cb521b3d66dbc",
      "filename": "appsv/server/views/tags/talkyardScriptBundles.scala.html",
      "status": "renamed",
      "additions": 0,
      "deletions": 0,
      "changes": 0,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/tags/talkyardScriptBundles.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/tags/talkyardScriptBundles.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/tags/talkyardScriptBundles.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "previous_filename": "appsv/server/views/debikiScriptsEndOfBody.scala.html"
    },
    {
      "sha": "d61420f25efcf7b5b9ea955cd0d4294f8a05e0c3",
      "filename": "appsv/server/views/templates/wrapper.scala.html",
      "status": "modified",
      "additions": 10,
      "deletions": 6,
      "changes": 16,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/templates/wrapper.scala.html",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/appsv/server/views/templates/wrapper.scala.html",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/appsv/server/views/templates/wrapper.scala.html?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1,5 +1,5 @@\n @**\n- * Copyright (C) 2013-2017 Kaj Magnus Lindberg\n+ * Copyright (c) 2013-2017, 2021 Kaj Magnus Lindberg\n  *\n  * This program is free software: you can redistribute it and/or modify\n  * it under the terms of the GNU Affero General Public License as\n@@ -20,6 +20,8 @@\n <!DOCTYPE html>\n <html class=\"@tpi.debikiHtmlTagClasses\">\n <head>\n+@tpi.jsonDataMustBeFirst()\n+\n @if(noindex) {\n <meta name=\"robots\" content=\"noindex\">\n }\n@@ -28,10 +30,12 @@\n <base href=\"@{tpi.anyEmbeddingUrl.get}\" target=\"_parent\">\n }\n @Html(tpi.anySafeMetaTags)\n-@tpi.debikiStyles\n-@tpi.stylesheetBundle(\"styles.css\")\n+@tpi.talkyardStyles\n+@tpi.anySiteCustomStylesBundle(\"styles.css\")\n @Html(tpi.siteSettings.headStylesHtml)\n-@tpi.debikiScriptsInHead()\n+\n+@tpi.parseJsonUpdDocClassesScript()\n+\n @if(useGoogleAnalytics) {\n @Html(tpi.anyGoogleUniversalAnalyticsScript)\n }\n@@ -62,9 +66,9 @@\n <div id=\"esWatchbarColumn\"></div>\n <div id=\"esThisbarColumn\"><div id=\"dw-any-sidebar\"></div></div>\n \n-@tpi.scriptBundlesEndOfBody()\n+@tpi.talkyardScriptBundles()\n @Html(tpi.siteSettings.headScriptsHtml)\n-@tpi.anyScriptsBundle()\n+@tpi.anySiteCustomScriptBundle()\n @Html(tpi.siteSettings.endOfBodyHtml)\n </body>\n </html>"
    },
    {
      "sha": "1c7543437e902e51802c451b9a67035bad51aedc",
      "filename": "client/app-head/head-bundle.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/client/app-head/head-bundle.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/client/app-head/head-bundle.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/client/app-head/head-bundle.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -129,7 +129,7 @@ _store.currentPage = _cp; // Is set to {} in the embedded editor [2BK4P3R]\n if (eds.isInEmbeddedEditor) {\n   // This avoids null errors when editor accesses the current page. [2BK4P3R]\n   _store.currentPage = {} as Page;\n-  // CLEAN_UP: Why this needed? Can remove, or do always? Previously: [603WMSRKD3]\n+  // CLEAN_UP: Why this needed? Can remove, or do always?\n   _store.me = _volatileData.me;\n }\n \n@@ -266,7 +266,7 @@ eds.isInEmbeddedCommentsIframe = _isInEmbCmtsIframe && !eds.isInEmbeddedEditor;\n   embeddingOrigin: @Html(embeddingOriginOrUndefined),\n   embeddingUrl: @Html(embeddingUrlOrUndefined),\n   */\n-if (!eds.isInEmbeddedEditor) {  // [6932867RMS]\n+if (!eds.isInEmbeddedEditor) {\n   // CLEAN_UP use sth like:  getMainWin().theStore.currentPageId  instead?\n   // — no, remove main-win-current-page-id.  [many_embcom_iframes]\n   eds.embeddedPageId = _isInIframe ? _pageId : undefined;"
    },
    {
      "sha": "0a8489d9653da6e851050bcd8e66a2f0fa364bd4",
      "filename": "client/app-slim/model.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/client/app-slim/model.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/client/app-slim/model.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/client/app-slim/model.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1568,7 +1568,7 @@ const enum LoginReason {\n   SignUp = 13,\n   TryToAccessNotFoundPage = 14,\n   SubmitEditorText = 15,\n-  PostEmbeddedComment = 16,  // dupl [8UKBR2AD5]\n+  PostEmbeddedComment = 16,  // also in Scala code [8UKBR2AD5]\n   PostProgressPost = 17,\n   PostReply = 18,     // was: 'LoginToComment'\n   CreateTopic = 19,   // was: 'LoginToCreateTopic'"
    },
    {
      "sha": "86fd2d92eae14d28b2fa3330896bda4c05dd360d",
      "filename": "docs/maybe-do-later.txt",
      "status": "modified",
      "additions": 38,
      "deletions": 3,
      "changes": 41,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/docs/maybe-do-later.txt",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/docs/maybe-do-later.txt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/docs/maybe-do-later.txt?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -288,8 +288,38 @@ And these unique indexes:\n   tags_u_id_patid\n   tags_u_id_postid\n \n+[careless_rdb]  ty_crdb\n+Use a 2nd PostgreSQL server for a persistent mem + disk \"cache\"?\n+E.g. for session storage and user visit logs.\n+Set isolation level read-committed, https://www.postgresql.org/docs/current/transaction-iso.html\n+and synchronous_commit = off,\n+    https://www.postgresql.org/docs/current/wal-async-commit.html\n+    https://www.postgresql.org/docs/current/runtime-config-wal.html#GUC-SYNCHRONOUS-COMMIT\n+and increase commit_delay\n+and set commit_siblings?\n+    https://www.postgresql.org/docs/current/runtime-config-wal.html#GUC-COMMIT-DELAY\n+    See: https://stackoverflow.com/a/58169528\n+see https://dba.stackexchange.com/questions/42290/configuring-postgresql-for-read-performance\n+https://www.cybertec-postgresql.com/en/postgresql-vs-redis-vs-memcached-performance/\n+>  Asynchronous mode was used for writing data, meaning a slight loss of most recent data is possible in case of a server crash\n+Could move to the careless rdb?  \"AC\" means async-commits-probably-ok\n+    (Change the suffixes to \"_ct\", meaning \"...cache table\" or \"... careless table\".\n+    user_visit_stats3 AC\n+    page_html3  — is just a cache. AC\n+    user_stats3?\n+    spam_check_queue3\n+    sessions_t   — AC if a session is lost, all that happens is that one needs to log in again.\n+              When logging out, then, that transaction should be synchronous (not async) though.\n+    review_tasks3 — No! That's important, don't move to the careless rdb.\n+    post_read_stats3 AC ?\n+    page_popularity_scores3 ??\n+    link_previews_t AC — who cares if a Twitter tweet wasn't saved, has to be fetched again.\n+    index_queue3\n+    emails_out3\n+    audit_log3 — split in 2 parts maybe?  One less interesting, and one important?\n+\n [table_partitions]\n-{{{2 Shard tables by site_id_c?\n+Shard tables by site_id_c? {{{2\n Needs pg11 (not pg10): In pg11, a parent table index gets auto-created on child tables\n (both child tables that already existed, or get created after the index).\n What happens when partitions created and there's data already?\n@@ -312,13 +342,18 @@ Nice way to quickly delete a whole site: Just drop the whole partitioned tables.\n \n Pg12 has good partition pruning: at ~ 8k partitions, speed is ~90% of w just 1 table, and ~100% up to\n about 2k partitions. https://www.2ndquadrant.com/en/blog/postgresql-12-partitioning/\n+}}}2\n \n+[cluster_tables]\n Or, cluster tables — but:\n   > when the table is subsequently updated, the changes are not clustered\n-  https://www.postgresql.org/docs/12/sql-cluster.html\n+  https://www.postgresql.org/docs/current/sql-cluster.html\n   One can periodically recluster — but that requries an exclusive lock!\n   However, clustering posts3 / posts_t by page_id_c = good idea.\n-}}}2\n+  There is also:\n+  https://github.com/reorg/pg_repack, clustering without exclusive locks, a fork of:\n+    https://github.com/reorg/pg_reorg  (abandoned)\n+\n \n DONE [onesocket]\n Subscribe to live-updates via a \"shared web worker\" so each browser gets its own connection,"
    },
    {
      "sha": "66f2f6731d96434ad6958c60199afc60abc8b30f",
      "filename": "modules/ed-prod-one-test",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/modules/ed-prod-one-test?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1 +1 @@\n-Subproject commit 68ec36e35ac2151fc53866d8002a0fc2c5959240\n+Subproject commit 66f2f6731d96434ad6958c60199afc60abc8b30f"
    },
    {
      "sha": "5cff21d0209e3530e32ec2c1863735d3651f3813",
      "filename": "relchans/tyse-v0-dev",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/relchans/tyse-v0-dev?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1 +1 @@\n-Subproject commit ba9ff66b22d37fa0da95d871d176ba57a905a0b4\n+Subproject commit 5cff21d0209e3530e32ec2c1863735d3651f3813"
    },
    {
      "sha": "6388cd04580ac3e4920e9eb2e08b6077f1572fe5",
      "filename": "relchans/tyse-v0-regular",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/relchans/tyse-v0-regular?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1 +1 @@\n-Subproject commit 759666088afcc42481f7d8aa50a92a4dc9441937\n+Subproject commit 6388cd04580ac3e4920e9eb2e08b6077f1572fe5"
    },
    {
      "sha": "be829ed469268fdc19a7d186fa39eef56a1d9c54",
      "filename": "tests/e2e-wdio7/package.json",
      "status": "modified",
      "additions": 9,
      "deletions": 9,
      "changes": 18,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/package.json",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/package.json",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e-wdio7/package.json?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -5,15 +5,15 @@\n   \"author\": \"Kaj Magnus Lindberg\",\n   \"license\": \"AGPL-3.0-or-later\",\n   \"devDependencies\": {\n-    \"@wdio/cli\": \"^7.14.1\",\n-    \"@wdio/devtools-service\": \"^7.14.1\",\n-    \"@wdio/firefox-profile-service\": \"^7.14.1\",\n-    \"@wdio/local-runner\": \"^7.14.1\",\n-    \"@wdio/mocha-framework\": \"^7.14.1\",\n-    \"@wdio/reporter\": \"^7.14.1\",\n-    \"@wdio/spec-reporter\": \"^7.14.1\",\n-    \"@wdio/types\": \"^7.14.1\",\n-    \"chromedriver\": \"^94.0.0\",\n+    \"@wdio/cli\": \"^7.16.3\",\n+    \"@wdio/devtools-service\": \"^7.16.3\",\n+    \"@wdio/firefox-profile-service\": \"^7.16.3\",\n+    \"@wdio/local-runner\": \"^7.16.3\",\n+    \"@wdio/mocha-framework\": \"^7.16.3\",\n+    \"@wdio/reporter\": \"^7.16.3\",\n+    \"@wdio/spec-reporter\": \"^7.16.3\",\n+    \"@wdio/types\": \"^7.16.3\",\n+    \"chromedriver\": \"^95.0.0\",\n     \"paseto.js\": \"^0.1.7\",\n     \"ts-node\": \"^10.2.1\",\n     \"wdio-chromedriver-service\": \"^7.2.2\""
    },
    {
      "sha": "bc294c0a244db57987e271d47981d1d4f1ab7ecc",
      "filename": "tests/e2e-wdio7/specs/dir.create-site-imp-json.2br.e2e.ts",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/specs/dir.create-site-imp-json.2br.e2e.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/specs/dir.create-site-imp-json.2br.e2e.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e-wdio7/specs/dir.create-site-imp-json.2br.e2e.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -6,6 +6,7 @@ import assert from '../utils/ty-assert';\n import server from '../utils/server';\n import * as utils from '../utils/utils';\n import { TyE2eTestBrowser } from '../utils/ty-e2e-test-browser';\n+import settings from '../utils/settings';\n import c from '../test-constants';\n \n let brA: TyE2eTestBrowser;\n@@ -37,6 +38,11 @@ const importedTopicTwoBody = 'importedTopicTwoBody';\n \n describe(`dir.create-site-imp-json.2br  TyTEIMPJSON01`, async () => {\n \n+  if (settings.prod) {\n+    console.log(\"Skipping this spec — the server needs to have upsert conf vals enabled.\"); // E2EBUG\n+    return;\n+  }\n+\n   it(`Init browsers`, async () => {\n     brA = new TyE2eTestBrowser(wdioBrowserA, 'brA');\n     brB = new TyE2eTestBrowser(wdioBrowserB, 'brB');"
    },
    {
      "sha": "eacd982aa8ec77b73506f5f5f141ce007d3b5a19",
      "filename": "tests/e2e-wdio7/utils/server.ts",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/utils/server.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/utils/server.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e-wdio7/utils/server.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -6,7 +6,7 @@ import * as _ from 'lodash';\n import assert from './ty-assert';\n import * as utils from './utils';\n import c from '../test-constants';\n-import { j2s, logMessage, logWarning, logError, logServerRequest, die, dieIf,\n+import { j2s, logMessage, logWarning, logErrorNoTrace, logServerRequest, die, dieIf,\n         } from './log-and-die';\n \n const syncRequest = require('sync-request');\n@@ -26,15 +26,15 @@ function initOrExit(theSettings) {\n     response = syncRequest('GET', settings.mainSiteOrigin);\n   }\n   catch (ex) {\n-    logError(`Error talking with:  ${settings.mainSiteOrigin}\\n` +\n+    logErrorNoTrace(`Error talking with:  ${settings.mainSiteOrigin}\\n` +\n         `Is the server not running?  [TyEE2ESRVOFF]\\n\\n`, ex);\n     process.exit(1);\n   }\n \n   if (response.statusCode !== 200) {\n-    logError(`Error response from:  ${settings.mainSiteOrigin}  ` +\n+    logErrorNoTrace(`Error response from:  ${settings.mainSiteOrigin}  ` +\n         `when requesting xsrf token and cookies [TyEE2ESRVSTS]\\n`);\n-    logError(showResponse(response));\n+    logErrorNoTrace(showResponse(response));\n     process.exit(1);\n   }\n \n@@ -54,7 +54,7 @@ function initOrExit(theSettings) {\n   });\n \n   if (!xsrfToken) {\n-    logError(\n+    logErrorNoTrace(\n         `Got no xsrf token from:  ${settings.mainSiteOrigin}   [TyEE2ESRVXSRF]\\n` +\n         `Cookie headers:\\n` +\n         `    ${j2s(cookies)}\\n`);"
    },
    {
      "sha": "40bca809c7102c0526a2eebfb39a87ea6af32284",
      "filename": "tests/e2e-wdio7/utils/ty-e2e-test-browser.ts",
      "status": "modified",
      "additions": 17,
      "deletions": 17,
      "changes": 34,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/utils/ty-e2e-test-browser.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/utils/ty-e2e-test-browser.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e-wdio7/utils/ty-e2e-test-browser.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -883,7 +883,7 @@ export class TyE2eTestBrowser {\n \n \n     async numWindowsOpen(): Pr<Nr> {\n-      return await this.#br.getWindowHandles().length;  // how can this be undefined?\n+      return (await this.#br.getWindowHandles()).length;\n     }\n \n \n@@ -2153,6 +2153,9 @@ export class TyE2eTestBrowser {\n         await this._waitForClickable(selector, opts);\n       }\n \n+      let oldText;\n+      let desiredValue = null;\n+\n         // Sometimes, when starting typing, React does a refresh / unmount?\n         // — maybe the mysterious unmount e2e test problem [5QKBRQ] ? [E2EBUG]\n         // so the remaining characters gets lost. Then, try again.\n@@ -2165,7 +2168,13 @@ export class TyE2eTestBrowser {\n           //  https://github.com/webdriverio/webdriverio/issues/3024#issuecomment-542888255\n           \n           const elem = await this.$(selector);\n-          const oldText = await elem.getValue();\n+          oldText = await elem.getValue();\n+\n+          if (desiredValue === null) {\n+            desiredValue = (opts.append ? oldText : '') + value;\n+          }\n+          if (desiredValue === oldText)\n+            return true;\n \n           if (opts.append) {\n             dieIf(!value, 'TyE29TKP0565');\n@@ -2203,25 +2212,16 @@ export class TyE2eTestBrowser {\n             // Delete chars one at a time:\n             await this.#br.keys(\n                     Array(oldText.length + 1).fill('Backspace'));  // + 1 = the 'x'\n+            // This in rare cases leaves an 'x'. (A race condition?) So\n+            // we'll waitUntil()-try until we've also read back the correct new value.\n             // --------------------------------\n             await elem.setValue(value);\n           }\n-\n-          if (!opts.checkAndRetry)\n-            return true;\n-\n-          await this.#br.pause(200);\n-\n-          const valueReadBack = await elem.getValue();\n-          const desiredValue = (opts.append ? oldText : '') + value;\n-\n-          if (desiredValue === valueReadBack)\n-            return true;\n-\n-          logUnusual('\\n' +\n+      }, {\n+        message: () =>\n             `   Couldn't set value to:  ${desiredValue}\\n` +\n-            `   got back when reading:  ${valueReadBack}\\n` +\n-            `                selector:  ${selector}   — trying again... [TyME2E5MKSRJ2]`);\n+            `   got back when reading:  ${oldText}\\n` +\n+            `                selector:  ${selector}   — trying again... [TyME2E5MKSRJ2]`,\n       });\n     }\n "
    },
    {
      "sha": "7a3eeae9b8bac2fd0121063a75d5b0a64a94f969",
      "filename": "tests/e2e-wdio7/yarn.lock",
      "status": "modified",
      "additions": 181,
      "deletions": 154,
      "changes": 335,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/yarn.lock",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e-wdio7/yarn.lock",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e-wdio7/yarn.lock?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -320,10 +320,10 @@\n   resolved \"https://registry.yarnpkg.com/@tsconfig/node16/-/node16-1.0.2.tgz#423c77877d0569db20e1fc80885ac4118314010e\"\n   integrity sha512-eZxlbI8GZscaGS7kkc/trHTT5xgrjH3/1n2JDwusC9iahPKWMRvRjJSAN5mCXviuTGQ/lHnhvv8Q1YTpnfz9gA==\n \n-\"@types/aria-query@^4.2.1\":\n-  version \"4.2.1\"\n-  resolved \"https://registry.yarnpkg.com/@types/aria-query/-/aria-query-4.2.1.tgz#78b5433344e2f92e8b306c06a5622c50c245bf6b\"\n-  integrity sha512-S6oPal772qJZHoRZLFc/XoZW2gFvwXusYUmXPXkgxJLuEk2vOt7jc4Yo6z/vtI0EBkbPBVrJJ0B+prLIKiWqHg==\n+\"@types/aria-query@^5.0.0\":\n+  version \"5.0.0\"\n+  resolved \"https://registry.yarnpkg.com/@types/aria-query/-/aria-query-5.0.0.tgz#df2d64b5cc73cca0d75e2a7793d6b5c199c2f7b2\"\n+  integrity sha512-P+dkdFu0n08PDIvw+9nT9ByQnd+Udc8DaWPb9HKfaPwCvWvQpC5XaMRx2xLWECm9x1VKNps6vEAlirjA6+uNrQ==\n \n \"@types/cacheable-request@^6.0.1\":\n   version \"6.0.1\"\n@@ -432,10 +432,10 @@\n   resolved \"https://registry.yarnpkg.com/@types/node/-/node-16.0.0.tgz#067a6c49dc7a5c2412a505628e26902ae967bf6f\"\n   integrity sha512-TmCW5HoZ2o2/z2EYi109jLqIaPIi9y/lc2LmDCWzuCi35bcaQ+OtUh6nwBiFK7SOu25FAU5+YKdqFZUwtqGSdg==\n \n-\"@types/node@^15.12.5\":\n-  version \"15.14.2\"\n-  resolved \"https://registry.yarnpkg.com/@types/node/-/node-15.14.2.tgz#7af8ab20156586f076f4760bc1b3c5ddfffd1ff2\"\n-  integrity sha512-dvMUE/m2LbXPwlvVuzCyslTEtQ2ZwuuFClDrOQ6mp2CenCg971719PTILZ4I6bTP27xfFFc+o7x2TkLuun/MPw==\n+\"@types/node@^16.11.1\":\n+  version \"16.11.6\"\n+  resolved \"https://registry.yarnpkg.com/@types/node/-/node-16.11.6.tgz#6bef7a2a0ad684cf6e90fcfe31cecabd9ce0a3ae\"\n+  integrity sha512-ua7PgUoeQFjmWPcoo9khiPum3Pd60k4/2ZGXt18sm2Slk0W0xZTqt5Y0Ny1NyBiN1EVQ/+FaF9NcY4Qe6rwk5w==\n \n \"@types/object-inspect@^1.8.0\":\n   version \"1.8.1\"\n@@ -480,6 +480,16 @@\n   dependencies:\n     \"@types/node\" \"*\"\n \n+\"@types/tmp@^0.2.0\":\n+  version \"0.2.2\"\n+  resolved \"https://registry.yarnpkg.com/@types/tmp/-/tmp-0.2.2.tgz#424537a3b91828cb26aaf697f21ae3cd1b69f7e7\"\n+  integrity sha512-MhSa0yylXtVMsyT8qFpHA1DLHj4DvQGH5ntxrhHSh8PxUVNi35Wk+P5hVgqbO2qZqOotqr9jaoPRL+iRjWYm/A==\n+\n+\"@types/ua-parser-js@^0.7.33\":\n+  version \"0.7.36\"\n+  resolved \"https://registry.yarnpkg.com/@types/ua-parser-js/-/ua-parser-js-0.7.36.tgz#9bd0b47f26b5a3151be21ba4ce9f5fa457c5f190\"\n+  integrity sha512-N1rW+njavs70y2cApeIw1vLMYXRwfBy+7trgavGuuTfOd7j1Yh7QTRc/yqsPl6ncokt72ZXuxEU0PiCp9bSwNQ==\n+\n \"@types/which@^1.3.2\":\n   version \"1.3.2\"\n   resolved \"https://registry.yarnpkg.com/@types/which/-/which-1.3.2.tgz#9c246fc0c93ded311c8512df2891fb41f6227fdf\"\n@@ -509,23 +519,23 @@\n   resolved \"https://registry.yarnpkg.com/@ungap/promise-all-settled/-/promise-all-settled-1.1.2.tgz#aa58042711d6e3275dd37dc597e5d31e8c290a44\"\n   integrity sha512-sL/cEvJWAnClXw0wHk85/2L0G6Sj8UB0Ctc1TEMbKSsmpRosqhwj9gWgFRZSrBr2f9tiXISwNhCPmlfqUqyb9Q==\n \n-\"@wdio/cli@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/cli/-/cli-7.14.1.tgz#c43f0c1ecf0f53ef500f50f0cd6d28f9b8d4a4f0\"\n-  integrity sha512-ydFsNlimP9W77NXRAYCn8xVtnS7/08UcaQT0iH0iCaaw+h9JJH4IIFhzIcPojG78g1ojEfBsQOqvD54elJpwzw==\n+\"@wdio/cli@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/cli/-/cli-7.16.3.tgz#72d8a3682c82d80963714972950ef2757bf96bdd\"\n+  integrity sha512-0y1/tJ5rPAx98VcPBczxNk2TdxDFer3gfqOI/Cowrt2VarIm1HiL2m/tPxenIQiqFHJCba9TN5Iho9g1JQbCEg==\n   dependencies:\n     \"@types/ejs\" \"^3.0.5\"\n     \"@types/fs-extra\" \"^9.0.4\"\n     \"@types/inquirer\" \"^8.1.2\"\n     \"@types/lodash.flattendeep\" \"^4.4.6\"\n     \"@types/lodash.pickby\" \"^4.6.6\"\n     \"@types/lodash.union\" \"^4.6.6\"\n-    \"@types/node\" \"^15.12.5\"\n+    \"@types/node\" \"^16.11.1\"\n     \"@types/recursive-readdir\" \"^2.2.0\"\n-    \"@wdio/config\" \"7.14.1\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+    \"@wdio/config\" \"7.16.3\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     async-exit-hook \"^2.0.1\"\n     chalk \"^4.0.0\"\n     chokidar \"^3.0.0\"\n@@ -538,66 +548,76 @@\n     lodash.union \"^4.6.0\"\n     mkdirp \"^1.0.4\"\n     recursive-readdir \"^2.2.2\"\n-    webdriverio \"7.14.1\"\n+    webdriverio \"7.16.3\"\n     yargs \"^17.0.0\"\n     yarn-install \"^1.0.0\"\n \n-\"@wdio/config@7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/config/-/config-7.14.1.tgz#56517d1053c0f412e585a3c4a71a6f0c2134cfde\"\n-  integrity sha512-Moa5ea/0so50OX+xm4sX9ty9vbVcIowSnm/SINayzg+waAAVbjHi10hZke8TaTsQ/kmZGeJv6Qjq8PTOZeaNCw==\n+\"@wdio/config@7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/config/-/config-7.16.3.tgz#b5c49c267fc4fc8f947024a2bca47a47a6eae1e2\"\n+  integrity sha512-YbpeZAeEncyJrsKxfAwjhNbDUf/ZrMB2Io3PYnH3RQjEEo5lYlO15aUt9uJx09W5h8hBPcrj7CfUC5yNkFZJhw==\n   dependencies:\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n     deepmerge \"^4.0.0\"\n     glob \"^7.1.2\"\n \n-\"@wdio/devtools-service@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/devtools-service/-/devtools-service-7.14.1.tgz#9e8ea68ec680c42364e52f7efefec198b0a9149f\"\n-  integrity sha512-E0qIyeNsR4uRlxm1E7GZlbJle47JX0jryqf0ZOku3GBT2Uv3ZulC4wYpi1zoK+mxG279N5ZaBNCHdZ7DUu/B1Q==\n+\"@wdio/devtools-service@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/devtools-service/-/devtools-service-7.16.3.tgz#fe24f0704614c3d6f381e0313a8e515f06a32fd2\"\n+  integrity sha512-PZC8NvSwpBtznMiirB46WNiraxJSt59NARhGi5KZGMXrrD1YbG19xPccuMF9pjay1DVfTcjhGqmsF4Ja0F29WA==\n   dependencies:\n     \"@babel/core\" \"^7.12.10\"\n     \"@tracerbench/trace-event\" \"^6.0.0\"\n-    \"@types/node\" \"^15.12.5\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@types/node\" \"^16.11.1\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n     atob \"^2.1.2\"\n     babel-plugin-istanbul \"^6.0.0\"\n-    core-js \"~3.18.0\"\n-    devtools-protocol \"^0.0.927104\"\n+    core-js \"~3.19.0\"\n+    devtools-protocol \"^0.0.933220\"\n     istanbul-lib-coverage \"^3.0.0\"\n     istanbul-lib-report \"^3.0.0\"\n     istanbul-reports \"^3.0.2\"\n     lighthouse \"8.5.1\"\n     puppeteer-core \"^10.1.0\"\n     speedline \"^1.4.1\"\n     stable \"^0.1.8\"\n-    webdriverio \"7.14.1\"\n+    webdriverio \"7.16.3\"\n \n-\"@wdio/firefox-profile-service@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/firefox-profile-service/-/firefox-profile-service-7.14.1.tgz#f273b75d4c25cc9087684222ce18428f1eb6c4f7\"\n-  integrity sha512-uOZtSx3IRB4TQ5NtH5cl5oyssLyJn2b9YUuu7Qu5vop9Y693MjhXqqdZHuEsDgP0o1X2V9qk1ULGlnEM7pWZ1g==\n+\"@wdio/firefox-profile-service@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/firefox-profile-service/-/firefox-profile-service-7.16.3.tgz#9b2cd751234d098566a5e546bc8a2eef3a9739b8\"\n+  integrity sha512-YwsFFkAssZcs1erRUjrjFx1tjwYV/ucR3FpLzK3QY9qW7kxy+SinlgJmRzLmUbtDIaJ+ZaqIFbAeLrXeB04j2g==\n   dependencies:\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@wdio/types\" \"7.16.3\"\n     firefox-profile \"^4.0.0\"\n \n-\"@wdio/local-runner@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/local-runner/-/local-runner-7.14.1.tgz#9f91e155cd2ab559a7a8a4dfe130825999ad6853\"\n-  integrity sha512-q/BXKN5hld1MpcABGTkurVKuNWy5GJNJvMamt0Fi5SLFDrTtndxaKFw9aciJiDqkJGCREVjYOOdMnsY+UmMKdg==\n+\"@wdio/local-runner@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/local-runner/-/local-runner-7.16.3.tgz#3b1d7c098f952e890a5e7e100e5ab9beb44ebd55\"\n+  integrity sha512-1ZhD10IZSQ4Sj9Ap/xz2KT8ULUMfNPyeb5qaitU0q7Wv41lnr96+zRCdb87nQwUzho9cWkIy1LMJRjDjO/ZfHQ==\n   dependencies:\n     \"@types/stream-buffers\" \"^3.0.3\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/repl\" \"7.14.1\"\n-    \"@wdio/runner\" \"7.14.1\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/repl\" \"7.16.3\"\n+    \"@wdio/runner\" \"7.16.3\"\n+    \"@wdio/types\" \"7.16.3\"\n     async-exit-hook \"^2.0.1\"\n-    split2 \"^3.2.2\"\n+    split2 \"^4.0.0\"\n     stream-buffers \"^3.0.2\"\n \n-\"@wdio/logger@7.7.0\", \"@wdio/logger@^7.5.3\":\n+\"@wdio/logger@7.16.0\":\n+  version \"7.16.0\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/logger/-/logger-7.16.0.tgz#40f116ebffc23c638b8e421e350f110a058523e9\"\n+  integrity sha512-/6lOGb2Iow5eSsy7RJOl1kCwsP4eMlG+/QKro5zUJsuyNJSQXf2ejhpkzyKWLgQbHu83WX6cM1014AZuLkzoQg==\n+  dependencies:\n+    chalk \"^4.0.0\"\n+    loglevel \"^1.6.0\"\n+    loglevel-plugin-prefix \"^0.8.4\"\n+    strip-ansi \"^6.0.0\"\n+\n+\"@wdio/logger@^7.5.3\":\n   version \"7.7.0\"\n   resolved \"https://registry.yarnpkg.com/@wdio/logger/-/logger-7.7.0.tgz#cac834008b7570f3b6ae30ed731545618c51da40\"\n   integrity sha512-XX/OkC8NlvsBdhKsb9j7ZbuQtF/Vuo0xf38PXdqYtVezOrYbDuba0hPG++g/IGNuAF34ZbSi+49cvz4u5w92kQ==\n@@ -607,86 +627,87 @@\n     loglevel-plugin-prefix \"^0.8.4\"\n     strip-ansi \"^6.0.0\"\n \n-\"@wdio/mocha-framework@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/mocha-framework/-/mocha-framework-7.14.1.tgz#6d126f2ad54f2c92b1fc3fd6bb7e8f4c5a5b1ade\"\n-  integrity sha512-VoFt8ziAH1KHDR7vKan0tT2I3new0Y/mU284nR/zHfUJyxrqi9P6pff6Y9wVTyjHYHsJfWstwk2v9wPKNUn6pQ==\n+\"@wdio/mocha-framework@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/mocha-framework/-/mocha-framework-7.16.3.tgz#cbc7942c818290474f8d2b31f288900c1dd6029f\"\n+  integrity sha512-vGm8KYfmI+1L+QniXsHdUvfWs3U4d3a6otfpBqFzS2LfSgsRbdUtIFz8NDqpIIm+HXr8noH1qMR8fe0Ay64Now==\n   dependencies:\n     \"@types/mocha\" \"^9.0.0\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     expect-webdriverio \"^3.0.0\"\n     mocha \"^9.0.0\"\n \n-\"@wdio/protocols@7.13.2\":\n-  version \"7.13.2\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/protocols/-/protocols-7.13.2.tgz#639cb0d9863e8d899c51642e9f1980aa1e713f86\"\n-  integrity sha512-GUbYbV2IjPlPhlz457nMD6C0GA9yPfVtZQAwgqaKXf9yR2cuNGHHkidWivfXJNG3zws2uFm/9I1+K9OaYIKVkQ==\n+\"@wdio/protocols@7.16.1\":\n+  version \"7.16.1\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/protocols/-/protocols-7.16.1.tgz#058e316364bf4ca7a7e377dbcb25bdb57b68f2d0\"\n+  integrity sha512-Bxfqak67+/d/1c2c/eHWmVw5xAKhDU+5Ekqpka5Kt1VmW8Se7w9rFligrU0LrrgY9zzhYfVAL4sYkHfDPCOWbA==\n \n-\"@wdio/repl@7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/repl/-/repl-7.14.1.tgz#86ce539cc1385c6d31e39d70bb109e6053501bc5\"\n-  integrity sha512-nD1RVihoEZaQ71eMyiPWMVUct40Wf8cp9Q6PZVn4MlIatRqB+X26C98qw6Bcjzfz72nEcmfkbN3tZpf9pY4saw==\n+\"@wdio/repl@7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/repl/-/repl-7.16.3.tgz#6bcc2934d76e361d1c8001ad7ec8b816ac79344f\"\n+  integrity sha512-aFpWyAIuPo6VVmkotZDWXMzd4qw3gD+xAhB6blNrMCZKWnz9+HqZnuGGc6pmiyuc5yFzb9wF22tnIxuyTyH7yA==\n   dependencies:\n-    \"@wdio/utils\" \"7.14.1\"\n+    \"@wdio/utils\" \"7.16.3\"\n \n-\"@wdio/reporter@7.14.1\", \"@wdio/reporter@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/reporter/-/reporter-7.14.1.tgz#7b0c714a5e13eae950435650873687065f2044cf\"\n-  integrity sha512-x/rV+aTTYf0Kj4Ti/6Yq/XEiA9k3StM6EnkMhaA3S/J6TeuQ8ZHZf6T4Lu/Izafg8F25ky0yH98HxZi2b2Fw1g==\n+\"@wdio/reporter@7.16.3\", \"@wdio/reporter@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/reporter/-/reporter-7.16.3.tgz#9cd3f62914ca60b5628a5217fdcdf55a445fbcad\"\n+  integrity sha512-DL6FaO8/ULHv4ET0ZVdg9+ZAP7ZzhZc8qP5slZTwMQ5vnXOHEO9JrALFtcEO8OkyZfaZKbI9oE2d96zli+wT9g==\n   dependencies:\n     \"@types/diff\" \"^5.0.0\"\n-    \"@types/node\" \"^15.12.5\"\n+    \"@types/node\" \"^16.11.1\"\n     \"@types/object-inspect\" \"^1.8.0\"\n     \"@types/supports-color\" \"^8.1.0\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@types/tmp\" \"^0.2.0\"\n+    \"@wdio/types\" \"7.16.3\"\n     diff \"^5.0.0\"\n     fs-extra \"^10.0.0\"\n     object-inspect \"^1.10.3\"\n     supports-color \"8.1.1\"\n \n-\"@wdio/runner@7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/runner/-/runner-7.14.1.tgz#4c09dd34011eb7e3258ac7babf912a748e0d9618\"\n-  integrity sha512-wMnv4yQX24/kcINUPq+OcGWAlCL5NldMi45zzt2iOuCeMNEv/Scchahr0gNZ1Mc0zubyCGDzrERYsYHmYAK3Dw==\n+\"@wdio/runner@7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/runner/-/runner-7.16.3.tgz#a4b2450beddc5d64f987c3c8b98b59401db31c21\"\n+  integrity sha512-5unQ6uNUL+dUehyy8bsBCOMqrgTK+Rykvde0ZQHkIUCwPx1Y40h4v6TFbefeLlyV9A0OmgWsbHKSfy7blBpqkQ==\n   dependencies:\n-    \"@wdio/config\" \"7.14.1\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+    \"@wdio/config\" \"7.16.3\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     deepmerge \"^4.0.0\"\n     gaze \"^1.1.2\"\n-    webdriver \"7.14.1\"\n-    webdriverio \"7.14.1\"\n+    webdriver \"7.16.3\"\n+    webdriverio \"7.16.3\"\n \n-\"@wdio/spec-reporter@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/spec-reporter/-/spec-reporter-7.14.1.tgz#2a486d7b8784587d3b51f77e7550b8bf4162fa4f\"\n-  integrity sha512-vViWdv2ExsgyN04QZ0w+Kj1Qi03/WR2kriOJCrGmCVZFXpZKFFOscf6irLeGL6zMRy6k86mf+AwFxV6PZB9K/w==\n+\"@wdio/spec-reporter@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/spec-reporter/-/spec-reporter-7.16.3.tgz#9b7191faf63d34458016bd988bbbe1fcf851f373\"\n+  integrity sha512-MprsLcS36N0cfrY8D/1ya2nJTqtRNmT9LzUidFUSbMSLj0oL/uZUioMBk9IRXPdnrgfBUoNrijbLqqo5G+vKAQ==\n   dependencies:\n     \"@types/easy-table\" \"^0.0.33\"\n-    \"@wdio/reporter\" \"7.14.1\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@wdio/reporter\" \"7.16.3\"\n+    \"@wdio/types\" \"7.16.3\"\n     chalk \"^4.0.0\"\n     easy-table \"^1.1.1\"\n     pretty-ms \"^7.0.0\"\n \n-\"@wdio/types@7.14.1\", \"@wdio/types@^7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/types/-/types-7.14.1.tgz#967e0f81f47addd1fc94b35f556877b738bceb4c\"\n-  integrity sha512-W1ctBarjFuLz7wub6wNFd3sWfaENf1+thQL2YQW/cgFuTvhyK5hhUPoP2Q1suXBDE+qs90wWwx4z8XwDC6S8OA==\n+\"@wdio/types@7.16.3\", \"@wdio/types@^7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/types/-/types-7.16.3.tgz#7fff2f2b8d13e3ef23f641fcd8f6ace52befedfd\"\n+  integrity sha512-iJLtJrOJZSJrXR1zseCkVWUFs477FngjWz2HTMfGHR69LzfmxC0RNagemjZuLTfhTqWp/FBbqaA/F+7xJdNKag==\n   dependencies:\n-    \"@types/node\" \"^15.12.5\"\n+    \"@types/node\" \"^16.11.1\"\n     got \"^11.8.1\"\n \n-\"@wdio/utils@7.14.1\":\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/@wdio/utils/-/utils-7.14.1.tgz#0aa52a8443abb7b6b3c80b7f4167b97c62a4bfcc\"\n-  integrity sha512-2LMjTiCccohUKGaHWpodIz9eF+5HApT4NVFJjWYqGQFAUrLaBrSocie7NW5+moYolY5dESYSNVB6qJlSdMbQlA==\n+\"@wdio/utils@7.16.3\":\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/@wdio/utils/-/utils-7.16.3.tgz#d4fe7dbdd4cdcb99de95cfacfe8c18f6f508e86a\"\n+  integrity sha512-/662h5Z7B5TejHN6GiW96PAKuTPi/xcAGmtjA9ozRBI2/0eHSccDfNEaBgTTjLqqEgGAXylHcOuxHOrKx2ddJw==\n   dependencies:\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/types\" \"7.14.1\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/types\" \"7.16.3\"\n     p-iteration \"^1.1.8\"\n \n acorn-walk@^8.1.1:\n@@ -1149,10 +1170,10 @@ chrome-launcher@^0.14.0:\n     is-wsl \"^2.2.0\"\n     lighthouse-logger \"^1.0.0\"\n \n-chromedriver@^94.0.0:\n-  version \"94.0.0\"\n-  resolved \"https://registry.yarnpkg.com/chromedriver/-/chromedriver-94.0.0.tgz#f6a3533976ba72413a01672954040c3544ea9d30\"\n-  integrity sha512-x4hK7R7iOyAhdLHJEcOyGBW/oa2kno6AqpHVLd+n3G7c2Vk9XcAXMz84XhNItqykJvTc6E3z/JRIT1eHYH//Eg==\n+chromedriver@^95.0.0:\n+  version \"95.0.0\"\n+  resolved \"https://registry.yarnpkg.com/chromedriver/-/chromedriver-95.0.0.tgz#ecf854cac6df5137a651dcc132edf55612d3db7f\"\n+  integrity sha512-HwSg7S0ZZYsHTjULwxFHrrUqEpz1+ljDudJM3eOquvqD5QKnR5pSe/GlBTY9UU2tVFRYz8bEHYC4Y8qxciQiLQ==\n   dependencies:\n     \"@testim/chrome-version\" \"^1.0.7\"\n     axios \"^0.21.2\"\n@@ -1288,10 +1309,10 @@ cookie@0.3.1:\n   resolved \"https://registry.yarnpkg.com/cookie/-/cookie-0.3.1.tgz#e7e0a1f9ef43b4c8ba925c5c5a96e806d16873bb\"\n   integrity sha1-5+Ch+e9DtMi6klxcWpboBtFoc7s=\n \n-core-js@~3.18.0:\n-  version \"3.18.0\"\n-  resolved \"https://registry.yarnpkg.com/core-js/-/core-js-3.18.0.tgz#9af3f4a6df9ba3428a3fb1b171f1503b3f40cc49\"\n-  integrity sha512-WJeQqq6jOYgVgg4NrXKL0KLQhi0CT4ZOCvFL+3CQ5o7I6J8HkT5wd53EadMfqTDp1so/MT1J+w2ujhWcCJtN7w==\n+core-js@~3.19.0:\n+  version \"3.19.0\"\n+  resolved \"https://registry.yarnpkg.com/core-js/-/core-js-3.19.0.tgz#9e40098a9bc326c7e81b486abbd5e12b9d275176\"\n+  integrity sha512-L1TpFRWXZ76vH1yLM+z6KssLZrP8Z6GxxW4auoCj+XiViOzNPJCAuTIkn03BGdFe6Z5clX5t64wRIRypsZQrUg==\n \n core-util-is@~1.0.0:\n   version \"1.0.2\"\n@@ -1467,27 +1488,28 @@ devtools-protocol@0.0.883894:\n   resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.883894.tgz#d403f2c75cd6d71c916aee8dde9258da988a4da9\"\n   integrity sha512-33idhm54QJzf3Q7QofMgCvIVSd2o9H3kQPWaKT/fhoZh+digc+WSiMhbkeG3iN79WY4Hwr9G05NpbhEVrsOYAg==\n \n-devtools-protocol@^0.0.927104:\n-  version \"0.0.927104\"\n-  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.927104.tgz#3bba0fca644bcdce1bcebb10ae392ab13428a7a0\"\n-  integrity sha512-5jfffjSuTOv0Lz53wTNNTcCUV8rv7d82AhYcapj28bC2B5tDxEZzVb7k51cNxZP2KHw24QE+sW7ZuSeD9NfMpA==\n-\n-devtools@7.14.1:\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/devtools/-/devtools-7.14.1.tgz#21ff7ae5a3a5cc49b325bd13ebbb31267b64045a\"\n-  integrity sha512-NpGjos9SMOZeDXnlmxKBVrbxJuPqFgLDUX/g9IlMtsjUKFq+ePcDNxTr1gRLax+boinc5UoFYPEpeFUKbBzR4Q==\n-  dependencies:\n-    \"@types/node\" \"^15.12.5\"\n-    \"@wdio/config\" \"7.14.1\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/protocols\" \"7.13.2\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+devtools-protocol@^0.0.933220:\n+  version \"0.0.933220\"\n+  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.933220.tgz#1689ac0d5bebdc8703ff96d1a04e2e41ee6a020b\"\n+  integrity sha512-6BHFljAlcA4jG2L6gMJfyQLnIrtftCZkZL7AZC7SBTlnda4yN5TqFtd/ZcqvcFS5VHkrc7QZGT/VGWCmeeiHAg==\n+\n+devtools@7.16.3:\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/devtools/-/devtools-7.16.3.tgz#f49a11182182380757069b053b8230b4a29c117c\"\n+  integrity sha512-mRs1d1y9fT/hen/tGVj0bbgatgkaAsfrDOG2VECL/sKRYlP4An18W8BdSU1wXe+4dUC322VxrtScXfRL2bsb1g==\n+  dependencies:\n+    \"@types/node\" \"^16.11.1\"\n+    \"@types/ua-parser-js\" \"^0.7.33\"\n+    \"@wdio/config\" \"7.16.3\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/protocols\" \"7.16.1\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     chrome-launcher \"^0.14.0\"\n     edge-paths \"^2.1.0\"\n     puppeteer-core \"^10.1.0\"\n     query-selector-shadow-dom \"^1.0.0\"\n-    ua-parser-js \"^0.7.21\"\n+    ua-parser-js \"^1.0.1\"\n     uuid \"^8.0.0\"\n \n diff-sequences@^27.0.6:\n@@ -3542,6 +3564,11 @@ split2@^3.2.2:\n   dependencies:\n     readable-stream \"^3.0.0\"\n \n+split2@^4.0.0:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/split2/-/split2-4.1.0.tgz#101907a24370f85bb782f08adaabe4e281ecf809\"\n+  integrity sha512-VBiJxFkxiXRlUIeyMQi8s4hgvKCSjtknJv/LVYbrgALPwf5zSKmEwV9Lst25AkvMDnvxODugjdl6KZgwKM1WYQ==\n+\n sprintf-js@~1.0.2:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/sprintf-js/-/sprintf-js-1.0.3.tgz#04e6926f662895354f3dd015203633b857297e2c\"\n@@ -3829,10 +3856,10 @@ typedarray-to-buffer@^3.1.5:\n   dependencies:\n     is-typedarray \"^1.0.0\"\n \n-ua-parser-js@^0.7.21:\n-  version \"0.7.28\"\n-  resolved \"https://registry.yarnpkg.com/ua-parser-js/-/ua-parser-js-0.7.28.tgz#8ba04e653f35ce210239c64661685bf9121dec31\"\n-  integrity sha512-6Gurc1n//gjp9eQNXjD9O3M/sMwVtN5S8Lv9bvOYBfKfDNiIIhqiyi01vMBO45u4zkDE420w/e0se7Vs+sIg+g==\n+ua-parser-js@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/ua-parser-js/-/ua-parser-js-1.0.1.tgz#268408f4d60375e67aa919fa7d117bdc66d5cd77\"\n+  integrity sha512-ZMu7XRN3M3R+g/YaFQKiVW0J42bzciF0+xAxP5uuO6VibE30MQvRRBctHuh22uS3yAe5jkru/i8QVOwRDJazIw==\n \n unbzip2-stream@1.3.3:\n   version \"1.3.3\"\n@@ -3924,41 +3951,41 @@ wdio-chromedriver-service@^7.2.2:\n     fs-extra \"^9.1.0\"\n     split2 \"^3.2.2\"\n \n-webdriver@7.14.1:\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/webdriver/-/webdriver-7.14.1.tgz#a689c5e544aee01f948661e9aae7401e3db54204\"\n-  integrity sha512-YhnuVquRQBVDO4seFDSpKsT5VFTpNTK7YZIPB6MwDBsIiiXA5Lt8QJN4kBuE6zuHmRuGRFv1y1dONCxsumEtXQ==\n-  dependencies:\n-    \"@types/node\" \"^15.12.5\"\n-    \"@wdio/config\" \"7.14.1\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/protocols\" \"7.13.2\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+webdriver@7.16.3:\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/webdriver/-/webdriver-7.16.3.tgz#1086ccf97c1d9091af726e149dfba880b680d78c\"\n+  integrity sha512-tZzkCS14RBa6EmC4jYbg9iHmZnPqI7Ui46chRRazFSG+9Wwr0Gu/UIuuPGw5h8IOotrFfkgFnPZbXWTtfTeu4Q==\n+  dependencies:\n+    \"@types/node\" \"^16.11.1\"\n+    \"@wdio/config\" \"7.16.3\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/protocols\" \"7.16.1\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     got \"^11.0.2\"\n     ky \"^0.28.5\"\n     lodash.merge \"^4.6.1\"\n \n-webdriverio@7.14.1:\n-  version \"7.14.1\"\n-  resolved \"https://registry.yarnpkg.com/webdriverio/-/webdriverio-7.14.1.tgz#357003a084efb23c472efc06a0fe7a92ad43f5c6\"\n-  integrity sha512-LE3YbEkzqqpCt2lN4JIYSpfv1mOXUk2SCglUXHD1O/uNY/Z1hUM5iL0X7tW0Wg5QKvH5YYJ/YPmtqza1OrtNAg==\n-  dependencies:\n-    \"@types/aria-query\" \"^4.2.1\"\n-    \"@types/node\" \"^15.12.5\"\n-    \"@wdio/config\" \"7.14.1\"\n-    \"@wdio/logger\" \"7.7.0\"\n-    \"@wdio/protocols\" \"7.13.2\"\n-    \"@wdio/repl\" \"7.14.1\"\n-    \"@wdio/types\" \"7.14.1\"\n-    \"@wdio/utils\" \"7.14.1\"\n+webdriverio@7.16.3:\n+  version \"7.16.3\"\n+  resolved \"https://registry.yarnpkg.com/webdriverio/-/webdriverio-7.16.3.tgz#b09d65a12a1e98ce8eabb265988680354b56de1c\"\n+  integrity sha512-hXLXP8IDgA3DojDHJrI4j+V4YmikKpJ8UUhuIjgoNWNRJom+sHLihy3AF92O4Rnt/vEe+glbO8gNL+/i8vMLGQ==\n+  dependencies:\n+    \"@types/aria-query\" \"^5.0.0\"\n+    \"@types/node\" \"^16.11.1\"\n+    \"@wdio/config\" \"7.16.3\"\n+    \"@wdio/logger\" \"7.16.0\"\n+    \"@wdio/protocols\" \"7.16.1\"\n+    \"@wdio/repl\" \"7.16.3\"\n+    \"@wdio/types\" \"7.16.3\"\n+    \"@wdio/utils\" \"7.16.3\"\n     archiver \"^5.0.0\"\n     aria-query \"^5.0.0\"\n     atob \"^2.1.2\"\n     css-shorthand-properties \"^1.1.1\"\n     css-value \"^0.0.1\"\n-    devtools \"7.14.1\"\n-    devtools-protocol \"^0.0.927104\"\n+    devtools \"7.16.3\"\n+    devtools-protocol \"^0.0.933220\"\n     fs-extra \"^10.0.0\"\n     get-port \"^5.1.1\"\n     grapheme-splitter \"^1.0.2\"\n@@ -3972,7 +3999,7 @@ webdriverio@7.14.1:\n     resq \"^1.9.1\"\n     rgb2hex \"0.2.5\"\n     serialize-error \"^8.0.0\"\n-    webdriver \"7.14.1\"\n+    webdriver \"7.16.3\"\n \n which@2.0.2, which@^2.0.2:\n   version \"2.0.2\""
    },
    {
      "sha": "a3c049891aeaa80b17103798659824884a75e035",
      "filename": "tests/e2e/utils/server.ts",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e/utils/server.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/tests/e2e/utils/server.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/tests/e2e/utils/server.ts?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -7,7 +7,7 @@ import assert = require('assert');\n import tyAssert = require('./ty-assert');\n import utils = require('./utils');\n import c = require('../test-constants');\n-import { j2s, logMessage, logWarning, logError, logServerRequest, die, dieIf,\n+import { j2s, logMessage, logWarning, logErrorNoTrace, logServerRequest, die, dieIf,\n         } from './log-and-die';\n \n // Didn't find any Typescript defs.\n@@ -29,15 +29,15 @@ function initOrExit(theSettings) {\n     response = syncRequest('GET', settings.mainSiteOrigin);\n   }\n   catch (ex) {\n-    logError(`Error talking with:  ${settings.mainSiteOrigin}\\n` +\n+    logErrorNoTrace(`Error talking with:  ${settings.mainSiteOrigin}\\n` +\n         `Is the server not running?  [TyEE2ESRVOFF]\\n\\n`, ex);\n     process.exit(1);\n   }\n \n   if (response.statusCode !== 200) {\n-    logError(`Error response from:  ${settings.mainSiteOrigin}  ` +\n+    logErrorNoTrace(`Error response from:  ${settings.mainSiteOrigin}  ` +\n         `when requesting xsrf token and cookies [TyEE2ESRVSTS]\\n`);\n-    logError(showResponse(response));\n+    logErrorNoTrace(showResponse(response));\n     process.exit(1);\n   }\n \n@@ -57,7 +57,7 @@ function initOrExit(theSettings) {\n   });\n \n   if (!xsrfToken) {\n-    logError(\n+    logErrorNoTrace(\n         `Got no xsrf token from:  ${settings.mainSiteOrigin}   [TyEE2ESRVXSRF]\\n` +\n         `Cookie headers:\\n` +\n         `    ${j2s(cookies)}\\n`);"
    },
    {
      "sha": "7440e9cdb6dacb465c43c03b811678e4d2cd7578",
      "filename": "version.txt",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/debiki/talkyard/blob/f93d7812264feefa8683d1781ca15a8947a88cef/version.txt",
      "raw_url": "https://github.com/debiki/talkyard/raw/f93d7812264feefa8683d1781ca15a8947a88cef/version.txt",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/version.txt?ref=f93d7812264feefa8683d1781ca15a8947a88cef",
      "patch": "@@ -1 +1 @@\n-v0.2021.30\n+v0.2021.31"
    }
  ]
}
