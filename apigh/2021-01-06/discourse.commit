{
  "sha": "53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo1M2Y5YTA4ODNlZDhhZjQ1YmQ0Zjg3M2NmOWU0YTVjNmQzMWNkMjkx",
  "commit": {
    "author": {
      "name": "Joffrey JAFFEUX",
      "email": "j.jaffeux@gmail.com",
      "date": "2021-01-06T11:57:13Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2021-01-06T11:57:13Z"
    },
    "message": "UX: allows to copy/paste a list of | separated values in sk (#11642)\n\n* UX: allows to copy/paste a list of | separated values in sk\n\n* fixes tests",
    "tree": {
      "sha": "f4894a47db7b311e0e471a04d8cd65212ec95ddd",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/f4894a47db7b311e0e471a04d8cd65212ec95ddd"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf9aWZCRBK7hj4Ov3rIwAAdHIIAGkoE0mVgY2WTMolyewiPUvK\nf3mEAyNKWh2VZx4Fqud5Og3RVRFWUNK22+J/5FmLntqTPMA/IqOXyZ/kfa+sjcIW\no26cEyNZf/MtzzSidRpCpfCWakbBuDRAML74gRcvZHm13RsNz6z7EAQtZ/NFIukN\nWkaOVcderP91iIsARnJNrlbJadofH6jVwdi089BO9Mcvk/vrEgq6DS7+J94O9s3z\n3plkmY3WpOaKJvPciCkVZc9U1U/p+e7jTnjb7KxFZQbkpKENFh2PJ8Ci2hJPdUrw\ngbVCAFDMUmOAQZRzoYqdFivsZa16YsEI9B5OU41zOFIMUFMMTZDrId1OMZJeOMM=\n=2Cem\n-----END PGP SIGNATURE-----\n",
      "payload": "tree f4894a47db7b311e0e471a04d8cd65212ec95ddd\nparent 5f846531a5a9a5f8f8dcc95588063d848d116795\nauthor Joffrey JAFFEUX <j.jaffeux@gmail.com> 1609934233 +0100\ncommitter GitHub <noreply@github.com> 1609934233 +0100\n\nUX: allows to copy/paste a list of | separated values in sk (#11642)\n\n* UX: allows to copy/paste a list of | separated values in sk\n\n* fixes tests"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
  "html_url": "https://github.com/discourse/discourse/commit/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/comments",
  "author": {
    "login": "jjaffeux",
    "id": 339945,
    "node_id": "MDQ6VXNlcjMzOTk0NQ==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/339945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jjaffeux",
    "html_url": "https://github.com/jjaffeux",
    "followers_url": "https://api.github.com/users/jjaffeux/followers",
    "following_url": "https://api.github.com/users/jjaffeux/following{/other_user}",
    "gists_url": "https://api.github.com/users/jjaffeux/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jjaffeux/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jjaffeux/subscriptions",
    "organizations_url": "https://api.github.com/users/jjaffeux/orgs",
    "repos_url": "https://api.github.com/users/jjaffeux/repos",
    "events_url": "https://api.github.com/users/jjaffeux/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jjaffeux/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5f846531a5a9a5f8f8dcc95588063d848d116795",
      "url": "https://api.github.com/repos/discourse/discourse/commits/5f846531a5a9a5f8f8dcc95588063d848d116795",
      "html_url": "https://github.com/discourse/discourse/commit/5f846531a5a9a5f8f8dcc95588063d848d116795"
    }
  ],
  "stats": {
    "total": 70,
    "additions": 66,
    "deletions": 4
  },
  "files": [
    {
      "sha": "6f6a32eb15d1510d3fca0bc0580ba327f98d273a",
      "filename": "app/assets/javascripts/select-kit/addon/components/multi-select.js",
      "status": "modified",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/multi-select.js",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/multi-select.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/components/multi-select.js?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -29,6 +29,31 @@ export default SelectKitComponent.extend({\n     );\n   },\n \n+  append(values) {\n+    const existingItems = values\n+      .map((value) => {\n+        const defaultItem = this.defaultItem(value, value);\n+        const existingItem =\n+          this.findValue(this.mainCollection, defaultItem) ||\n+          this.findName(this.mainCollection, defaultItem);\n+        if (!existingItem) {\n+          if (this.validateCreate(value, this.content)) {\n+            return value;\n+          }\n+        } else if (this.validateSelect(existingItem)) {\n+          return this.getValue(existingItem);\n+        }\n+      })\n+      .filter(Boolean);\n+\n+    const newValues = makeArray(this.value).concat(existingItems);\n+    const newContent = makeArray(this.selectedContent).concat(\n+      makeArray(existingItems)\n+    );\n+\n+    this.selectKit.change(newValues, newContent);\n+  },\n+\n   deselect(item) {\n     this.clearErrors();\n "
    },
    {
      "sha": "c7dbe545fd2cb2243b497c0dfc949df41b80441c",
      "filename": "app/assets/javascripts/select-kit/addon/components/multi-select/multi-select-filter.js",
      "status": "modified",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/multi-select/multi-select-filter.js",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/multi-select/multi-select-filter.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/components/multi-select/multi-select-filter.js?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -15,4 +15,25 @@ export default SelectKitFilterComponent.extend({\n     }\n     return isEmpty(placeholder) ? \"\" : I18n.t(placeholder);\n   },\n+\n+  actions: {\n+    onPaste(event) {\n+      const data = event.originalEvent.clipboardData;\n+\n+      if (!data) {\n+        return;\n+      }\n+\n+      const parts = data.getData(\"text\").split(\"|\").filter(Boolean);\n+\n+      if (parts.length > 1) {\n+        event.stopPropagation();\n+        event.preventDefault();\n+\n+        this.selectKit.append(parts);\n+\n+        return false;\n+      }\n+    },\n+  },\n });"
    },
    {
      "sha": "1ad7f666316ae52648a4e666b8039b8ac645bd36",
      "filename": "app/assets/javascripts/select-kit/addon/components/select-kit.js",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/select-kit.js",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/select-kit.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/components/select-kit.js?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -112,6 +112,7 @@ export default Component.extend(\n           change: bind(this, this._onChangeWrapper),\n           select: bind(this, this.select),\n           deselect: bind(this, this.deselect),\n+          append: bind(this, this.append),\n \n           onOpen: bind(this, this._onOpenWrapper),\n           onClose: bind(this, this._onCloseWrapper),\n@@ -540,6 +541,10 @@ export default Component.extend(\n       this.selectKit.change(null, null);\n     },\n \n+    append() {\n+      // do nothing on general case\n+    },\n+\n     search(filter) {\n       let content = this.content || [];\n       if (filter) {"
    },
    {
      "sha": "555930325e6d763b9044a673049ebc242dab7838",
      "filename": "app/assets/javascripts/select-kit/addon/components/select-kit/select-kit-filter.js",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/select-kit/select-kit-filter.js",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/components/select-kit/select-kit-filter.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/components/select-kit/select-kit-filter.js?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -47,6 +47,8 @@ export default Component.extend(UtilsMixin, {\n   },\n \n   actions: {\n+    onPaste() {},\n+\n     onInput(event) {\n       this.selectKit.onInput(event);\n       return true;"
    },
    {
      "sha": "cb1c4244bc3e4326b6e91c5f4640486b4f25bf47",
      "filename": "app/assets/javascripts/select-kit/addon/mixins/utils.js",
      "status": "modified",
      "additions": 12,
      "deletions": 4,
      "changes": 16,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/mixins/utils.js",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/mixins/utils.js",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/mixins/utils.js?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -57,18 +57,26 @@ export default Mixin.create({\n   },\n \n   findValue(content, item) {\n-    const property = get(this.selectKit, \"valueProperty\");\n+    return this._findInContent(content, item, \"valueProperty\", \"getValue\");\n+  },\n+\n+  findName(content, item) {\n+    return this._findInContent(content, item, \"nameProperty\", \"getName\");\n+  },\n+\n+  _findInContent(content, item, type, getter) {\n+    const property = get(this.selectKit, type);\n \n     if (!property) {\n       if (content.indexOf(item) > -1) {\n         return item;\n       }\n     } else if (typeof property === \"string\") {\n-      return content.findBy(property, this.getValue(item));\n+      return content.findBy(property, this[getter](item));\n     } else {\n-      const value = this.getValue(item);\n+      const name = this[getter](item);\n       return content.find((contentItem) => {\n-        return this.getValue(contentItem) === value;\n+        return this[getter](contentItem) === name;\n       });\n     }\n   },"
    },
    {
      "sha": "d50302e7b29b57dbc17612737bb0b650a43a4b43",
      "filename": "app/assets/javascripts/select-kit/addon/templates/components/select-kit/select-kit-filter.hbs",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/discourse/discourse/blob/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/templates/components/select-kit/select-kit-filter.hbs",
      "raw_url": "https://github.com/discourse/discourse/raw/53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291/app/assets/javascripts/select-kit/addon/templates/components/select-kit/select-kit-filter.hbs",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/addon/templates/components/select-kit/select-kit-filter.hbs?ref=53f9a0883ed8af45bd4f873cf9e4a5c6d31cd291",
      "patch": "@@ -9,6 +9,7 @@\n     spellcheck=false\n     value=(readonly selectKit.filter)\n     input=(action \"onInput\")\n+    paste=(action \"onPaste\")\n     keyDown=(action \"onKeydown\")\n   }}\n "
    }
  ]
}
