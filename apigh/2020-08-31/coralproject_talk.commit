{
  "sha": "5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6NWU1ZjE3YzAzOWM2ZjQwOGM4ZDE1NGM5ZmY0MzUyYjJhNzJlYjRjZQ==",
  "commit": {
    "author": {
      "name": "Wyatt Johnson",
      "email": "wyattjoh@gmail.com",
      "date": "2020-08-28T19:57:46Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-08-28T19:57:46Z"
    },
    "message": "[CORL-1296] New Comment Count (#3149)\n\n* feat: added support for new comment count\n\n* fix: updated snapshots, removed unused deps",
    "tree": {
      "sha": "f21df2d9382475f6d177b4887c6ee97ed67cd8e9",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/f21df2d9382475f6d177b4887c6ee97ed67cd8e9"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfSWG6CRBK7hj4Ov3rIwAAdHIIAH2VEhYph4qvL1r1cZRyZp6A\nqwTZeFydHmvdS1jTbqjLgxgSLDB1V6bygXqVTopESy5DU+ANZbpzmiQIDOhWAt6l\njEEl+YhDNaprF2OAbSVwN0pGR68zrGON1VEiztjZlZMeTSysjpzmaO/+A9gd2tlF\nrnBhHeV0Oh637eds1UHJf+wjtUHxbvuOWPAbNA9jh3rADmNHsyB899UIYAAdtY23\nphiTCAScHPBi8VcduTwoghWNuYjGq2xJBCUi5neXaRqtNiver1uHLhxKPLKMXNvE\nVIAEGgeo6pFBsRUeG3ra57rL0RugGkLfDByVLjoBrpN0zi/JJtf2735pEG4ugoE=\n=gC1z\n-----END PGP SIGNATURE-----\n",
      "payload": "tree f21df2d9382475f6d177b4887c6ee97ed67cd8e9\nparent e0136a9fff1e26aa5e41a59054add1c827e49312\nauthor Wyatt Johnson <wyattjoh@gmail.com> 1598644666 -0600\ncommitter GitHub <noreply@github.com> 1598644666 +0000\n\n[CORL-1296] New Comment Count (#3149)\n\n* feat: added support for new comment count\n\n* fix: updated snapshots, removed unused deps"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
  "html_url": "https://github.com/coralproject/talk/commit/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/comments",
  "author": {
    "login": "wyattjoh",
    "id": 633002,
    "node_id": "MDQ6VXNlcjYzMzAwMg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/633002?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wyattjoh",
    "html_url": "https://github.com/wyattjoh",
    "followers_url": "https://api.github.com/users/wyattjoh/followers",
    "following_url": "https://api.github.com/users/wyattjoh/following{/other_user}",
    "gists_url": "https://api.github.com/users/wyattjoh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wyattjoh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wyattjoh/subscriptions",
    "organizations_url": "https://api.github.com/users/wyattjoh/orgs",
    "repos_url": "https://api.github.com/users/wyattjoh/repos",
    "events_url": "https://api.github.com/users/wyattjoh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wyattjoh/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e0136a9fff1e26aa5e41a59054add1c827e49312",
      "url": "https://api.github.com/repos/coralproject/talk/commits/e0136a9fff1e26aa5e41a59054add1c827e49312",
      "html_url": "https://github.com/coralproject/talk/commit/e0136a9fff1e26aa5e41a59054add1c827e49312"
    }
  ],
  "stats": {
    "total": 671,
    "additions": 427,
    "deletions": 244
  },
  "files": [
    {
      "sha": "99e7f12336e23d9895dcbf370c2abd3e9d294e80",
      "filename": "package-lock.json",
      "status": "modified",
      "additions": 56,
      "deletions": 131,
      "changes": 187,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/package-lock.json",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/package-lock.json",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/package-lock.json?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1955,7 +1955,8 @@\n     \"@babel/helper-validator-identifier\": {\n       \"version\": \"7.9.0\",\n       \"resolved\": \"https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.9.0.tgz\",\n-      \"integrity\": \"sha512-6G8bQKjOh+of4PV/ThDm/rRqlU7+IGoJuofpagU5GlEl29Vv0RGqqt86ZGRV8ZuSOY3o+8yXl5y782SMcG7SHw==\"\n+      \"integrity\": \"sha512-6G8bQKjOh+of4PV/ThDm/rRqlU7+IGoJuofpagU5GlEl29Vv0RGqqt86ZGRV8ZuSOY3o+8yXl5y782SMcG7SHw==\",\n+      \"dev\": true\n     },\n     \"@babel/helper-wrap-function\": {\n       \"version\": \"7.10.1\",\n@@ -5298,6 +5299,7 @@\n       \"version\": \"7.8.3\",\n       \"resolved\": \"https://registry.npmjs.org/@babel/runtime/-/runtime-7.8.3.tgz\",\n       \"integrity\": \"sha512-fVHx1rzEmwB130VTkLnxR+HmxcTjGzH12LYQcFFoBwakMd3aOMD4OsRN7tGG/UOYE2ektgFrS8uACAoRk1CY0w==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"regenerator-runtime\": \"^0.13.2\"\n       }\n@@ -5684,6 +5686,7 @@\n       \"version\": \"10.0.29\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/cache/-/cache-10.0.29.tgz\",\n       \"integrity\": \"sha512-fU2VtSVlHiF27empSbxi1O2JFdNWZO+2NFHfwO0pxgTep6Xa3uGb+3pVKfLww2l/IBGLNEZl5Xf/++A4wAYDYQ==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"@emotion/sheet\": \"0.9.4\",\n         \"@emotion/stylis\": \"0.8.5\",\n@@ -5695,6 +5698,7 @@\n       \"version\": \"10.0.28\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/core/-/core-10.0.28.tgz\",\n       \"integrity\": \"sha512-pH8UueKYO5jgg0Iq+AmCLxBsvuGtvlmiDCOuv8fGNYn3cowFpLN98L8zO56U0H1PjDIyAlXymgL3Wu7u7v6hbA==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"@babel/runtime\": \"^7.5.5\",\n         \"@emotion/cache\": \"^10.0.27\",\n@@ -5708,6 +5712,7 @@\n       \"version\": \"10.0.27\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/css/-/css-10.0.27.tgz\",\n       \"integrity\": \"sha512-6wZjsvYeBhyZQYNrGoR5yPMYbMBNEnanDrqmsqS1mzDm1cOTu12shvl2j4QHNS36UaTE0USIJawCH9C8oW34Zw==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"@emotion/serialize\": \"^0.11.15\",\n         \"@emotion/utils\": \"0.11.3\",\n@@ -5717,7 +5722,8 @@\n     \"@emotion/hash\": {\n       \"version\": \"0.8.0\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/hash/-/hash-0.8.0.tgz\",\n-      \"integrity\": \"sha512-kBJtf7PH6aWwZ6fka3zQ0p6SBYzx4fl1LoZXE2RrnYST9Xljm7WfKJrU4g/Xr3Beg72MLrp1AWNUmuYJTL7Cow==\"\n+      \"integrity\": \"sha512-kBJtf7PH6aWwZ6fka3zQ0p6SBYzx4fl1LoZXE2RrnYST9Xljm7WfKJrU4g/Xr3Beg72MLrp1AWNUmuYJTL7Cow==\",\n+      \"dev\": true\n     },\n     \"@emotion/is-prop-valid\": {\n       \"version\": \"0.8.8\",\n@@ -5731,12 +5737,14 @@\n     \"@emotion/memoize\": {\n       \"version\": \"0.7.4\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/memoize/-/memoize-0.7.4.tgz\",\n-      \"integrity\": \"sha512-Ja/Vfqe3HpuzRsG1oBtWTHk2PGZ7GR+2Vz5iYGelAw8dx32K0y7PjVuxK6z1nMpZOqAFsRUPCkK1YjJ56qJlgw==\"\n+      \"integrity\": \"sha512-Ja/Vfqe3HpuzRsG1oBtWTHk2PGZ7GR+2Vz5iYGelAw8dx32K0y7PjVuxK6z1nMpZOqAFsRUPCkK1YjJ56qJlgw==\",\n+      \"dev\": true\n     },\n     \"@emotion/serialize\": {\n       \"version\": \"0.11.16\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/serialize/-/serialize-0.11.16.tgz\",\n       \"integrity\": \"sha512-G3J4o8by0VRrO+PFeSc3js2myYNOXVJ3Ya+RGVxnshRYgsvErfAOglKAiy1Eo1vhzxqtUvjCyS5gtewzkmvSSg==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"@emotion/hash\": \"0.8.0\",\n         \"@emotion/memoize\": \"0.7.4\",\n@@ -5748,7 +5756,8 @@\n     \"@emotion/sheet\": {\n       \"version\": \"0.9.4\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/sheet/-/sheet-0.9.4.tgz\",\n-      \"integrity\": \"sha512-zM9PFmgVSqBw4zL101Q0HrBVTGmpAxFZH/pYx/cjJT5advXguvcgjHFTCaIO3enL/xr89vK2bh0Mfyj9aa0ANA==\"\n+      \"integrity\": \"sha512-zM9PFmgVSqBw4zL101Q0HrBVTGmpAxFZH/pYx/cjJT5advXguvcgjHFTCaIO3enL/xr89vK2bh0Mfyj9aa0ANA==\",\n+      \"dev\": true\n     },\n     \"@emotion/styled\": {\n       \"version\": \"10.0.27\",\n@@ -5775,22 +5784,26 @@\n     \"@emotion/stylis\": {\n       \"version\": \"0.8.5\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/stylis/-/stylis-0.8.5.tgz\",\n-      \"integrity\": \"sha512-h6KtPihKFn3T9fuIrwvXXUOwlx3rfUvfZIcP5a6rh8Y7zjE3O06hT5Ss4S/YI1AYhuZ1kjaE/5EaOOI2NqSylQ==\"\n+      \"integrity\": \"sha512-h6KtPihKFn3T9fuIrwvXXUOwlx3rfUvfZIcP5a6rh8Y7zjE3O06hT5Ss4S/YI1AYhuZ1kjaE/5EaOOI2NqSylQ==\",\n+      \"dev\": true\n     },\n     \"@emotion/unitless\": {\n       \"version\": \"0.7.5\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/unitless/-/unitless-0.7.5.tgz\",\n-      \"integrity\": \"sha512-OWORNpfjMsSSUBVrRBVGECkhWcULOAJz9ZW8uK9qgxD+87M7jHRcvh/A96XXNhXTLmKcoYSQtBEX7lHMO7YRwg==\"\n+      \"integrity\": \"sha512-OWORNpfjMsSSUBVrRBVGECkhWcULOAJz9ZW8uK9qgxD+87M7jHRcvh/A96XXNhXTLmKcoYSQtBEX7lHMO7YRwg==\",\n+      \"dev\": true\n     },\n     \"@emotion/utils\": {\n       \"version\": \"0.11.3\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/utils/-/utils-0.11.3.tgz\",\n-      \"integrity\": \"sha512-0o4l6pZC+hI88+bzuaX/6BgOvQVhbt2PfmxauVaYOGgbsAw14wdKyvMCZXnsnsHys94iadcF+RG/wZyx6+ZZBw==\"\n+      \"integrity\": \"sha512-0o4l6pZC+hI88+bzuaX/6BgOvQVhbt2PfmxauVaYOGgbsAw14wdKyvMCZXnsnsHys94iadcF+RG/wZyx6+ZZBw==\",\n+      \"dev\": true\n     },\n     \"@emotion/weak-memoize\": {\n       \"version\": \"0.2.5\",\n       \"resolved\": \"https://registry.npmjs.org/@emotion/weak-memoize/-/weak-memoize-0.2.5.tgz\",\n-      \"integrity\": \"sha512-6U71C2Wp7r5XtFtQzYrW5iKFT67OixrSxjI4MptCHzdSVlgabczzqLe0ZSgnub/5Kp4hSbpDB1tMytZY9pwxxA==\"\n+      \"integrity\": \"sha512-6U71C2Wp7r5XtFtQzYrW5iKFT67OixrSxjI4MptCHzdSVlgabczzqLe0ZSgnub/5Kp4hSbpDB1tMytZY9pwxxA==\",\n+      \"dev\": true\n     },\n     \"@fluent/bundle\": {\n       \"version\": \"0.15.0\",\n@@ -8807,21 +8820,6 @@\n         \"@types/node\": \"*\"\n       }\n     },\n-    \"@types/cookie\": {\n-      \"version\": \"0.3.3\",\n-      \"resolved\": \"https://registry.npmjs.org/@types/cookie/-/cookie-0.3.3.tgz\",\n-      \"integrity\": \"sha512-LKVP3cgXBT9RYj+t+9FDKwS5tdI+rPBXaNSkma7hvqy35lc7mAokC2zsqWJH0LaqIt3B962nuYI77hsJoT1gow==\",\n-      \"dev\": true\n-    },\n-    \"@types/cookie-parser\": {\n-      \"version\": \"1.4.2\",\n-      \"resolved\": \"https://registry.npmjs.org/@types/cookie-parser/-/cookie-parser-1.4.2.tgz\",\n-      \"integrity\": \"sha512-uwcY8m6SDQqciHsqcKDGbo10GdasYsPCYkH3hVegj9qAah6pX5HivOnOuI3WYmyQMnOATV39zv/Ybs0bC/6iVg==\",\n-      \"dev\": true,\n-      \"requires\": {\n-        \"@types/express\": \"*\"\n-      }\n-    },\n     \"@types/cookies\": {\n       \"version\": \"0.7.4\",\n       \"resolved\": \"https://registry.npmjs.org/@types/cookies/-/cookies-0.7.4.tgz\",\n@@ -10714,14 +10712,6 @@\n         }\n       }\n     },\n-    \"apollo-engine-reporting-protobuf\": {\n-      \"version\": \"0.4.4\",\n-      \"resolved\": \"https://registry.npmjs.org/apollo-engine-reporting-protobuf/-/apollo-engine-reporting-protobuf-0.4.4.tgz\",\n-      \"integrity\": \"sha512-SGrIkUR7Q/VjU8YG98xcvo340C4DaNUhg/TXOtGsMlfiJDzHwVau/Bv6zifAzBafp2lj0XND6Daj5kyT/eSI/w==\",\n-      \"requires\": {\n-        \"@apollo/protobufjs\": \"^1.0.3\"\n-      }\n-    },\n     \"apollo-env\": {\n       \"version\": \"0.6.2\",\n       \"resolved\": \"https://registry.npmjs.org/apollo-env/-/apollo-env-0.6.2.tgz\",\n@@ -10813,14 +10803,6 @@\n         }\n       }\n     },\n-    \"apollo-server-caching\": {\n-      \"version\": \"0.5.1\",\n-      \"resolved\": \"https://registry.npmjs.org/apollo-server-caching/-/apollo-server-caching-0.5.1.tgz\",\n-      \"integrity\": \"sha512-L7LHZ3k9Ao5OSf2WStvQhxdsNVplRQi7kCAPfqf9Z3GBEnQ2uaL0EgO0hSmtVHfXTbk5CTRziMT1Pe87bXrFIw==\",\n-      \"requires\": {\n-        \"lru-cache\": \"^5.0.0\"\n-      }\n-    },\n     \"apollo-server-core\": {\n       \"version\": \"2.16.1\",\n       \"resolved\": \"https://registry.npmjs.org/apollo-server-core/-/apollo-server-core-2.16.1.tgz\",\n@@ -10905,15 +10887,6 @@\n         }\n       }\n     },\n-    \"apollo-server-env\": {\n-      \"version\": \"2.4.3\",\n-      \"resolved\": \"https://registry.npmjs.org/apollo-server-env/-/apollo-server-env-2.4.3.tgz\",\n-      \"integrity\": \"sha512-23R5Xo9OMYX0iyTu2/qT0EUb+AULCBriA9w8HDfMoChB8M+lFClqUkYtaTTHDfp6eoARLW8kDBhPOBavsvKAjA==\",\n-      \"requires\": {\n-        \"node-fetch\": \"^2.1.2\",\n-        \"util.promisify\": \"^1.0.0\"\n-      }\n-    },\n     \"apollo-server-errors\": {\n       \"version\": \"2.4.2\",\n       \"resolved\": \"https://registry.npmjs.org/apollo-server-errors/-/apollo-server-errors-2.4.2.tgz\",\n@@ -11035,16 +11008,6 @@\n         }\n       }\n     },\n-    \"apollo-server-types\": {\n-      \"version\": \"0.3.0\",\n-      \"resolved\": \"https://registry.npmjs.org/apollo-server-types/-/apollo-server-types-0.3.0.tgz\",\n-      \"integrity\": \"sha512-FMo7kbTkhph9dfIQ3xDbRLObqmdQH9mwSjxhGsX+JxGMRPPXgd3+GZvCeVKOi/udxh//w1otSeAqItjvbj0tfQ==\",\n-      \"requires\": {\n-        \"apollo-engine-reporting-protobuf\": \"^0.4.4\",\n-        \"apollo-server-caching\": \"^0.5.1\",\n-        \"apollo-server-env\": \"^2.4.3\"\n-      }\n-    },\n     \"apollo-tracing\": {\n       \"version\": \"0.11.1\",\n       \"resolved\": \"https://registry.npmjs.org/apollo-tracing/-/apollo-tracing-0.11.1.tgz\",\n@@ -12546,6 +12509,7 @@\n       \"version\": \"10.0.29\",\n       \"resolved\": \"https://registry.npmjs.org/babel-plugin-emotion/-/babel-plugin-emotion-10.0.29.tgz\",\n       \"integrity\": \"sha512-7Jpi1OCxjyz0k163lKtqP+LHMg5z3S6A7vMBfHnF06l2unmtsOmFDzZBpGf0CWo1G4m8UACfVcDJiSiRuu/cSw==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"@babel/helper-module-imports\": \"^7.0.0\",\n         \"@emotion/hash\": \"0.8.0\",\n@@ -12563,6 +12527,7 @@\n           \"version\": \"7.8.3\",\n           \"resolved\": \"https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.8.3.tgz\",\n           \"integrity\": \"sha512-R0Bx3jippsbAEtzkpZ/6FIiuzOURPcMjHp+Z6xPe6DtApDJx+w7UYyOLanZqO8+wKR9G10s/FmHXvxaMd9s6Kg==\",\n+          \"dev\": true,\n           \"requires\": {\n             \"@babel/types\": \"^7.8.3\"\n           }\n@@ -12571,6 +12536,7 @@\n           \"version\": \"7.9.0\",\n           \"resolved\": \"https://registry.npmjs.org/@babel/types/-/types-7.9.0.tgz\",\n           \"integrity\": \"sha512-BS9JKfXkzzJl8RluW4JGknzpiUV7ZrvTayM6yfqLTVBEnFtyowVIOu6rqxRd5cVO6yGoWf4T8u8dgK9oB+GCng==\",\n+          \"dev\": true,\n           \"requires\": {\n             \"@babel/helper-validator-identifier\": \"^7.9.0\",\n             \"lodash\": \"^4.17.13\",\n@@ -12844,6 +12810,7 @@\n       \"version\": \"2.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/babel-plugin-macros/-/babel-plugin-macros-2.0.0.tgz\",\n       \"integrity\": \"sha512-MSsoNjn8yLe3s71m4THcOXn1ZKXVHVpKNoRKCAEUe9mrkECAazW+ON5lJnjMPAuAPllAPh/WaUqoSduMu1//ew==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"cosmiconfig\": \"3.1.0\"\n       }\n@@ -12962,7 +12929,8 @@\n     \"babel-plugin-syntax-jsx\": {\n       \"version\": \"6.18.0\",\n       \"resolved\": \"https://registry.npmjs.org/babel-plugin-syntax-jsx/-/babel-plugin-syntax-jsx-6.18.0.tgz\",\n-      \"integrity\": \"sha1-CvMqmm4Tyno/1QaeYtew9Y0NiUY=\"\n+      \"integrity\": \"sha1-CvMqmm4Tyno/1QaeYtew9Y0NiUY=\",\n+      \"dev\": true\n     },\n     \"babel-plugin-syntax-trailing-function-commas\": {\n       \"version\": \"7.0.0-beta.0\",\n@@ -14274,6 +14242,7 @@\n       \"version\": \"3.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/camel-case/-/camel-case-3.0.0.tgz\",\n       \"integrity\": \"sha1-yjw2iKTpzzpM2nd9xNy8cTJJz3M=\",\n+      \"dev\": true,\n       \"requires\": {\n         \"no-case\": \"^2.2.0\",\n         \"upper-case\": \"^1.1.1\"\n@@ -14691,14 +14660,16 @@\n       \"version\": \"4.2.1\",\n       \"resolved\": \"https://registry.npmjs.org/clean-css/-/clean-css-4.2.1.tgz\",\n       \"integrity\": \"sha512-4ZxI6dy4lrY6FHzfiy1aEOXgu4LIsW2MhwG0VBKdcoGoH/XLFgaHSdLTGr4O8Be6A8r3MOphEiI8Gc1n0ecf3g==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"source-map\": \"~0.6.0\"\n       },\n       \"dependencies\": {\n         \"source-map\": {\n           \"version\": \"0.6.1\",\n           \"resolved\": \"https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz\",\n-          \"integrity\": \"sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\"\n+          \"integrity\": \"sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\",\n+          \"dev\": true\n         }\n       }\n     },\n@@ -15595,7 +15566,8 @@\n     \"convert-source-map\": {\n       \"version\": \"1.5.1\",\n       \"resolved\": \"https://registry.npmjs.org/convert-source-map/-/convert-source-map-1.5.1.tgz\",\n-      \"integrity\": \"sha1-uCeAl7m8IpNl3lxiz1/K7YtVmeU=\"\n+      \"integrity\": \"sha1-uCeAl7m8IpNl3lxiz1/K7YtVmeU=\",\n+      \"dev\": true\n     },\n     \"convict\": {\n       \"version\": \"5.2.0\",\n@@ -15643,15 +15615,6 @@\n       \"resolved\": \"https://registry.npmjs.org/cookie/-/cookie-0.4.0.tgz\",\n       \"integrity\": \"sha512-+Hp8fLp57wnUSt0tY0tHEXh4voZRDnoIrZPqlo3DPiI4y9lwg/jqx+1Om94/W6ZaPDOUbnjOt/99w66zk+l1Xg==\"\n     },\n-    \"cookie-parser\": {\n-      \"version\": \"1.4.5\",\n-      \"resolved\": \"https://registry.npmjs.org/cookie-parser/-/cookie-parser-1.4.5.tgz\",\n-      \"integrity\": \"sha512-f13bPUj/gG/5mDr+xLmSxxDsB9DQiTIfhJS/sqjrmfAWiAN+x2O4i/XguTL9yDZ+/IFDanJ+5x7hC4CXT9Tdzw==\",\n-      \"requires\": {\n-        \"cookie\": \"0.4.0\",\n-        \"cookie-signature\": \"1.0.6\"\n-      }\n-    },\n     \"cookie-signature\": {\n       \"version\": \"1.0.6\",\n       \"resolved\": \"https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.6.tgz\",\n@@ -15777,6 +15740,7 @@\n       \"version\": \"3.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/cosmiconfig/-/cosmiconfig-3.1.0.tgz\",\n       \"integrity\": \"sha512-zedsBhLSbPBms+kE7AH4vHg6JsKDz6epSv2/+5XHs8ILHlgDciSJfSWf8sX9aQ52Jb7KI7VswUTsLpR/G0cr2Q==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"is-directory\": \"^0.3.1\",\n         \"js-yaml\": \"^3.9.0\",\n@@ -17093,7 +17057,8 @@\n     \"csstype\": {\n       \"version\": \"2.6.9\",\n       \"resolved\": \"https://registry.npmjs.org/csstype/-/csstype-2.6.9.tgz\",\n-      \"integrity\": \"sha512-xz39Sb4+OaTsULgUERcCk+TJj8ylkL4aSVDQiX/ksxbELSqwkgt4d4RD7fovIdgJGSuNYqwZEiVjYY5l0ask+Q==\"\n+      \"integrity\": \"sha512-xz39Sb4+OaTsULgUERcCk+TJj8ylkL4aSVDQiX/ksxbELSqwkgt4d4RD7fovIdgJGSuNYqwZEiVjYY5l0ask+Q==\",\n+      \"dev\": true\n     },\n     \"csv-stringify\": {\n       \"version\": \"5.3.6\",\n@@ -20002,6 +19967,7 @@\n       \"version\": \"1.3.2\",\n       \"resolved\": \"https://registry.npmjs.org/error-ex/-/error-ex-1.3.2.tgz\",\n       \"integrity\": \"sha512-7dFHNmqeFSEt2ZBsCriorKnn3Z2pj+fd9kmI6QoWw4//DL+icEBfc0U7qJCisqrTsKTjw4fNFy2pW9OqStD84g==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"is-arrayish\": \"^0.2.1\"\n       }\n@@ -22240,7 +22206,8 @@\n     \"find-root\": {\n       \"version\": \"1.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/find-root/-/find-root-1.1.0.tgz\",\n-      \"integrity\": \"sha512-NKfW6bec6GfKc0SGx1e07QZY9PE99u0Bft/0rzSD5k3sO/vwkVUpDUKVm5Gpp5Ue3YfShPFTX2070tDs5kB9Ng==\"\n+      \"integrity\": \"sha512-NKfW6bec6GfKc0SGx1e07QZY9PE99u0Bft/0rzSD5k3sO/vwkVUpDUKVm5Gpp5Ue3YfShPFTX2070tDs5kB9Ng==\",\n+      \"dev\": true\n     },\n     \"find-up\": {\n       \"version\": \"2.1.0\",\n@@ -30098,16 +30065,6 @@\n         \"minimatch\": \"^3.0.4\"\n       }\n     },\n-    \"graphql-extensions\": {\n-      \"version\": \"0.11.0\",\n-      \"resolved\": \"https://registry.npmjs.org/graphql-extensions/-/graphql-extensions-0.11.0.tgz\",\n-      \"integrity\": \"sha512-zd4qfUiJoYBx2MwJusM36SEJ+YmJ1ki8YF8nlm9mgaPDUzsnmFq4lxULxUfhLAXFwZw7MbEN2vV4V6WiNgSJLg==\",\n-      \"requires\": {\n-        \"@apollographql/apollo-tools\": \"^0.4.3\",\n-        \"apollo-server-env\": \"^2.4.3\",\n-        \"apollo-server-types\": \"^0.3.0\"\n-      }\n-    },\n     \"graphql-fields\": {\n       \"version\": \"2.0.3\",\n       \"resolved\": \"https://registry.npmjs.org/graphql-fields/-/graphql-fields-2.0.3.tgz\",\n@@ -31289,48 +31246,6 @@\n       \"integrity\": \"sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==\",\n       \"dev\": true\n     },\n-    \"html-minifier\": {\n-      \"version\": \"4.0.0\",\n-      \"resolved\": \"https://registry.npmjs.org/html-minifier/-/html-minifier-4.0.0.tgz\",\n-      \"integrity\": \"sha512-aoGxanpFPLg7MkIl/DDFYtb0iWz7jMFGqFhvEDZga6/4QTjneiD8I/NXL1x5aaoCp7FSIT6h/OhykDdPsbtMig==\",\n-      \"requires\": {\n-        \"camel-case\": \"^3.0.0\",\n-        \"clean-css\": \"^4.2.1\",\n-        \"commander\": \"^2.19.0\",\n-        \"he\": \"^1.2.0\",\n-        \"param-case\": \"^2.1.1\",\n-        \"relateurl\": \"^0.2.7\",\n-        \"uglify-js\": \"^3.5.1\"\n-      },\n-      \"dependencies\": {\n-        \"commander\": {\n-          \"version\": \"2.20.3\",\n-          \"resolved\": \"https://registry.npmjs.org/commander/-/commander-2.20.3.tgz\",\n-          \"integrity\": \"sha512-GpVkmM8vF2vQUkj2LvZmD35JxeJOLCwJ9cUkugyk2nuhbv3+mJvpLYYt+0+USMxE+oj+ey/lJEnhZw75x/OMcQ==\"\n-        },\n-        \"source-map\": {\n-          \"version\": \"0.6.1\",\n-          \"resolved\": \"https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz\",\n-          \"integrity\": \"sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\"\n-        },\n-        \"uglify-js\": {\n-          \"version\": \"3.8.0\",\n-          \"resolved\": \"https://registry.npmjs.org/uglify-js/-/uglify-js-3.8.0.tgz\",\n-          \"integrity\": \"sha512-ugNSTT8ierCsDHso2jkBHXYrU8Y5/fY2ZUprfrJUiD7YpuFvV4jODLFmb3h4btQjqr5Nh4TX4XtgDfCU1WdioQ==\",\n-          \"requires\": {\n-            \"commander\": \"~2.20.3\",\n-            \"source-map\": \"~0.6.1\"\n-          },\n-          \"dependencies\": {\n-            \"commander\": {\n-              \"version\": \"2.20.3\",\n-              \"resolved\": \"https://registry.npmjs.org/commander/-/commander-2.20.3.tgz\",\n-              \"integrity\": \"sha512-GpVkmM8vF2vQUkj2LvZmD35JxeJOLCwJ9cUkugyk2nuhbv3+mJvpLYYt+0+USMxE+oj+ey/lJEnhZw75x/OMcQ==\"\n-            }\n-          }\n-        }\n-      }\n-    },\n     \"html-minifier-terser\": {\n       \"version\": \"5.0.5\",\n       \"resolved\": \"https://registry.npmjs.org/html-minifier-terser/-/html-minifier-terser-5.0.5.tgz\",\n@@ -32901,7 +32816,8 @@\n     \"is-arrayish\": {\n       \"version\": \"0.2.1\",\n       \"resolved\": \"https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.2.1.tgz\",\n-      \"integrity\": \"sha1-d8mYQFJ6qOyxqLppe4BkWnqSap0=\"\n+      \"integrity\": \"sha1-d8mYQFJ6qOyxqLppe4BkWnqSap0=\",\n+      \"dev\": true\n     },\n     \"is-binary-path\": {\n       \"version\": \"1.0.1\",\n@@ -33019,7 +32935,8 @@\n     \"is-directory\": {\n       \"version\": \"0.3.1\",\n       \"resolved\": \"https://registry.npmjs.org/is-directory/-/is-directory-0.3.1.tgz\",\n-      \"integrity\": \"sha1-YTObbyR1/Hcv2cnYP1yFddwVSuE=\"\n+      \"integrity\": \"sha1-YTObbyR1/Hcv2cnYP1yFddwVSuE=\",\n+      \"dev\": true\n     },\n     \"is-docker\": {\n       \"version\": \"2.0.0\",\n@@ -38431,7 +38348,8 @@\n     \"lower-case\": {\n       \"version\": \"1.1.4\",\n       \"resolved\": \"https://registry.npmjs.org/lower-case/-/lower-case-1.1.4.tgz\",\n-      \"integrity\": \"sha1-miyr0bno4K6ZOkv31YdcOcQujqw=\"\n+      \"integrity\": \"sha1-miyr0bno4K6ZOkv31YdcOcQujqw=\",\n+      \"dev\": true\n     },\n     \"lower-case-first\": {\n       \"version\": \"1.0.2\",\n@@ -39633,6 +39551,7 @@\n       \"version\": \"2.3.2\",\n       \"resolved\": \"https://registry.npmjs.org/no-case/-/no-case-2.3.2.tgz\",\n       \"integrity\": \"sha512-rmTZ9kz+f3rCvK2TD1Ue/oZlns7OGoIWP4fc3llxxRXlOkHKoWPPWJOfFYpITabSow43QJbRIoHQXtt10VldyQ==\",\n+      \"dev\": true,\n       \"requires\": {\n         \"lower-case\": \"^1.1.1\"\n       }\n@@ -40895,6 +40814,7 @@\n       \"version\": \"2.1.1\",\n       \"resolved\": \"https://registry.npmjs.org/param-case/-/param-case-2.1.1.tgz\",\n       \"integrity\": \"sha1-35T9jPZTHs915r75oIWPvHK+Ikc=\",\n+      \"dev\": true,\n       \"requires\": {\n         \"no-case\": \"^2.2.0\"\n       }\n@@ -40976,6 +40896,7 @@\n       \"version\": \"3.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/parse-json/-/parse-json-3.0.0.tgz\",\n       \"integrity\": \"sha1-+m9HsY4jgm6tMvJj50TQ4ehH+xM=\",\n+      \"dev\": true,\n       \"requires\": {\n         \"error-ex\": \"^1.3.1\"\n       }\n@@ -47555,7 +47476,8 @@\n     \"relateurl\": {\n       \"version\": \"0.2.7\",\n       \"resolved\": \"https://registry.npmjs.org/relateurl/-/relateurl-0.2.7.tgz\",\n-      \"integrity\": \"sha1-VNvzd+UUQKypCkzSdGANP/LYiKk=\"\n+      \"integrity\": \"sha1-VNvzd+UUQKypCkzSdGANP/LYiKk=\",\n+      \"dev\": true\n     },\n     \"relay-compiler\": {\n       \"version\": \"10.0.1\",\n@@ -48525,7 +48447,8 @@\n     \"require-from-string\": {\n       \"version\": \"2.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/require-from-string/-/require-from-string-2.0.2.tgz\",\n-      \"integrity\": \"sha512-Xf0nWe6RseziFMu+Ap9biiUbmplq6S9/p+7w7YXP/JBHhrUDDUhwa+vANyubuqfZWTveU//DYVGsDG7RKL/vEw==\"\n+      \"integrity\": \"sha512-Xf0nWe6RseziFMu+Ap9biiUbmplq6S9/p+7w7YXP/JBHhrUDDUhwa+vANyubuqfZWTveU//DYVGsDG7RKL/vEw==\",\n+      \"dev\": true\n     },\n     \"require-like\": {\n       \"version\": \"0.1.2\",\n@@ -52134,7 +52057,8 @@\n     \"to-fast-properties\": {\n       \"version\": \"2.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/to-fast-properties/-/to-fast-properties-2.0.0.tgz\",\n-      \"integrity\": \"sha1-3F5pjL0HkmW8c+A3doGk5Og/YW4=\"\n+      \"integrity\": \"sha1-3F5pjL0HkmW8c+A3doGk5Og/YW4=\",\n+      \"dev\": true\n     },\n     \"to-object-path\": {\n       \"version\": \"0.3.0\",\n@@ -54038,7 +53962,8 @@\n     \"upper-case\": {\n       \"version\": \"1.1.3\",\n       \"resolved\": \"https://registry.npmjs.org/upper-case/-/upper-case-1.1.3.tgz\",\n-      \"integrity\": \"sha1-9rRQHC7EzdJrp4vnIilh3ndiFZg=\"\n+      \"integrity\": \"sha1-9rRQHC7EzdJrp4vnIilh3ndiFZg=\",\n+      \"dev\": true\n     },\n     \"upper-case-first\": {\n       \"version\": \"1.1.2\","
    },
    {
      "sha": "816ec1ffd175debd60429c1ec640618180a55913",
      "filename": "package.json",
      "status": "modified",
      "additions": 0,
      "deletions": 9,
      "changes": 9,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/package.json",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/package.json",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/package.json?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -61,7 +61,6 @@\n   \"license\": \"Apache-2.0\",\n   \"dependencies\": {\n     \"@coralproject/bunyan-prettystream\": \"^0.1.4\",\n-    \"@emotion/core\": \"^10.0.28\",\n     \"@fluent/bundle\": \"^0.15.0\",\n     \"@fluent/dom\": \"^0.6.0\",\n     \"@hapi/joi\": \"^17.1.1\",\n@@ -83,8 +82,6 @@\n     \"consolidate\": \"0.14.0\",\n     \"content-security-policy-builder\": \"^2.1.0\",\n     \"convict\": \"^5.2.0\",\n-    \"cookie\": \"^0.4.0\",\n-    \"cookie-parser\": \"^1.4.5\",\n     \"cors\": \"^2.8.5\",\n     \"cron\": \"^1.8.2\",\n     \"csv-stringify\": \"^5.3.6\",\n@@ -99,14 +96,12 @@\n     \"fs-extra\": \"^8.1.0\",\n     \"graphql\": \"^14.6.0\",\n     \"graphql-config\": \"^2.2.2\",\n-    \"graphql-extensions\": \"^0.11.0\",\n     \"graphql-fields\": \"2.0.3\",\n     \"graphql-playground-html\": \"1.6.13\",\n     \"graphql-redis-subscriptions\": \"^2.2.1\",\n     \"graphql-subscriptions\": \"^1.1.0\",\n     \"graphql-tools\": \"^4.0.7\",\n     \"helmet\": \"^3.22.0\",\n-    \"html-minifier\": \"^4.0.0\",\n     \"html-to-text\": \"^5.1.1\",\n     \"ioredis\": \"^4.16.1\",\n     \"jsdom\": \"^16.2.2\",\n@@ -171,8 +166,6 @@\n     \"@types/compression-webpack-plugin\": \"^2.0.1\",\n     \"@types/consolidate\": \"0.14.0\",\n     \"@types/convict\": \"^5.2.1\",\n-    \"@types/cookie\": \"^0.3.3\",\n-    \"@types/cookie-parser\": \"^1.4.2\",\n     \"@types/cors\": \"^2.8.6\",\n     \"@types/cron\": \"^1.7.2\",\n     \"@types/cross-spawn\": \"^6.0.1\",\n@@ -187,8 +180,6 @@\n     \"@types/fs-extra\": \"^8.1.0\",\n     \"@types/hapi__joi\": \"^16.0.12\",\n     \"@types/helmet\": \"^0.0.45\",\n-    \"@types/html-minifier\": \"^3.5.3\",\n-    \"@types/html-minifier-terser\": \"^5.0.0\",\n     \"@types/html-to-text\": \"^1.4.31\",\n     \"@types/html-webpack-plugin\": \"^3.2.3\",\n     \"@types/ioredis\": \"^4.14.9\","
    },
    {
      "sha": "56a91111fcf916cde945afde990d4bba9a4f95d7",
      "filename": "src/core/client/admin/routes/Dashboard/sections/CommentActivity.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/CommentActivity.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/CommentActivity.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Dashboard/sections/CommentActivity.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -12,7 +12,7 @@ import {\n   YAxis,\n } from \"recharts\";\n \n-import { TimeSeriesMetricsJSON } from \"coral-common/rest/dashboard/types\";\n+import { TimeSeriesMetricsJSON } from \"coral-common/types/dashboard\";\n import { useDateTimeFormatter } from \"coral-framework/hooks\";\n import { useImmediateFetch } from \"coral-framework/lib/relay/fetch\";\n import { Flex } from \"coral-ui/components/v2\";"
    },
    {
      "sha": "a8c65833752a4a6dc2934a8da4e0c82538ed7644",
      "filename": "src/core/client/admin/routes/Dashboard/sections/SignupActivity.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/SignupActivity.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/SignupActivity.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Dashboard/sections/SignupActivity.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -10,7 +10,7 @@ import {\n   YAxis,\n } from \"recharts\";\n \n-import { TimeSeriesMetricsJSON } from \"coral-common/rest/dashboard/types\";\n+import { TimeSeriesMetricsJSON } from \"coral-common/types/dashboard\";\n import { useImmediateFetch } from \"coral-framework/lib/relay/fetch\";\n \n import { DashboardBox, DashboardComponentHeading, Loader } from \"../components\";"
    },
    {
      "sha": "827260ee74cec8828d4649f6345bc118f9b34551",
      "filename": "src/core/client/admin/routes/Dashboard/sections/Today.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/Today.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/Today.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Dashboard/sections/Today.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,7 +1,7 @@\n import { Localized } from \"@fluent/react/compat\";\n import React, { FunctionComponent } from \"react\";\n \n-import { TodayMetricsJSON } from \"coral-common/rest/dashboard/types\";\n+import { TodayMetricsJSON } from \"coral-common/types/dashboard\";\n import { useImmediateFetch } from \"coral-framework/lib/relay/fetch\";\n import { Flex } from \"coral-ui/components/v2\";\n "
    },
    {
      "sha": "2403af175fd5a3e99f23d8caca0d7fd680aa6df4",
      "filename": "src/core/client/admin/routes/Dashboard/sections/TopStories.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/TopStories.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/admin/routes/Dashboard/sections/TopStories.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Dashboard/sections/TopStories.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -3,7 +3,7 @@ import { Link } from \"found\";\n import React, { FunctionComponent } from \"react\";\n \n import NotAvailable from \"coral-admin/components/NotAvailable\";\n-import { TodayStoriesMetricsJSON } from \"coral-common/rest/dashboard/types\";\n+import { TodayStoriesMetricsJSON } from \"coral-common/types/dashboard\";\n import { getModerationLink } from \"coral-framework/helpers\";\n import { useImmediateFetch } from \"coral-framework/lib/relay/fetch\";\n import {"
    },
    {
      "sha": "7bebc29d119b1c2705f7703caba176b1943c6577",
      "filename": "src/core/client/count/injectJSONPCallback.ts",
      "status": "modified",
      "additions": 118,
      "deletions": 12,
      "changes": 130,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/count/injectJSONPCallback.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/count/injectJSONPCallback.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/count/injectJSONPCallback.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,25 +1,131 @@\n+import { CountJSONPData } from \"coral-common/types/count\";\n import { COUNT_SELECTOR } from \"coral-framework/constants\";\n+import getPreviousCountStorageKey from \"coral-framework/helpers/getPreviousCountStorageKey\";\n \n type GetCountFunction = (opts?: { reset?: boolean }) => void;\n \n-/** Injects a global CoralCount callback into the window object to be used in JSONP */\n+/**\n+ * getPreviousCount will return the previous count if we can find it in storage.\n+ *\n+ * @param storyID the ID of the Story that we're referencing\n+ */\n+function getPreviousCount(storyID: string): number | null {\n+  // Calculate the key for this value used in storage. We have to prefix this\n+  // with `coral:` because inside the framework we automatically prefix it.\n+  const key = \"coral:\" + getPreviousCountStorageKey(storyID);\n+\n+  let previousCount: number;\n+  try {\n+    // Try to get the storage entry for this. If it isn't available then\n+    // either\n+    const item = localStorage.getItem(key);\n+    if (!item) {\n+      return null;\n+    }\n+\n+    // Parse the previous count.\n+    previousCount = parseInt(item, 10);\n+  } catch (err) {\n+    // Looks like we encountered an error parsing the previous count data,\n+    // we should remove the storage entry.\n+    localStorage.removeItem(key);\n+    return null;\n+  }\n+\n+  return previousCount;\n+}\n+\n+interface CountElementDataset {\n+  coralCount: string;\n+  coralPreviousCount?: string;\n+  coralNewCount?: string;\n+}\n+\n+function createCountElementEnhancer({\n+  html,\n+  count: currentCount,\n+  id: storyID,\n+}: CountJSONPData) {\n+  // Get the dataset together for setting properties on the enhancer.\n+  const dataset: CountElementDataset = {\n+    coralCount: currentCount.toString(),\n+  };\n+\n+  // Create the root element we're using for this.\n+  const element = document.createElement(\"span\");\n+\n+  // Update the innerHTML which contains the count and new value..\n+  element.innerHTML = html;\n+\n+  if (storyID) {\n+    const previousCount = getPreviousCount(storyID);\n+    if (previousCount !== null && previousCount < currentCount) {\n+      // The new count is just the current count subtracting from the previous\n+      // count.\n+      const newCount = currentCount - previousCount;\n+\n+      // Add the counts to the dataset so it can be targeted by CSS if you want.\n+      dataset.coralPreviousCount = previousCount.toString();\n+      dataset.coralNewCount = newCount.toString();\n+\n+      // Insert the divider \" / \"\n+      const dividerElement = document.createElement(\"span\");\n+      dividerElement.className = \"coral-new-count-divider\";\n+      dividerElement.innerText = \" / \";\n+      element.appendChild(dividerElement);\n+\n+      // Add the number of new comments to that.\n+      const newCountNumber = document.createElement(\"span\");\n+      newCountNumber.className = \"coral-new-count-number\";\n+      newCountNumber.innerText = newCount.toString();\n+      element.appendChild(newCountNumber);\n+\n+      // Add the number of new comments to that.\n+      const newCountText = document.createElement(\"span\");\n+      newCountText.className = \"coral-new-count-text\";\n+      newCountText.innerText = \" New\";\n+      element.appendChild(newCountText);\n+    }\n+  }\n+\n+  return (target: HTMLElement) => {\n+    // Add the innerHTML from the element to the target element. This will\n+    // include any optional children that were appended related to new comment\n+    // counts.\n+    target.innerHTML = element.innerHTML;\n+\n+    // For each of the dataset elements, add it to the target.\n+    target.dataset.coralCount = dataset.coralCount;\n+\n+    // If these are available, then set them as well.\n+    if (dataset.coralNewCount && dataset.coralPreviousCount) {\n+      target.dataset.coralNewCount = dataset.coralNewCount;\n+      target.dataset.coralPreviousCount = dataset.coralPreviousCount;\n+    }\n+  };\n+}\n+\n+/**\n+ * injectJSONPCallback will register the `CoralCount` on the window.\n+ *\n+ * @param getCount a function that when executed will allow you to reset the count\n+ */\n function injectJSONPCallback(getCount: GetCountFunction) {\n   (window as any).CoralCount = {\n-    setCount: (data: { ref: string; html: string; count?: number }) => {\n-      // Find all the elements with ref.\n+    setCount: (data: CountJSONPData) => {\n+      // Find all the elements with ref. These are the ones that should be\n+      // updated with this enhanced value.\n       const elements = document.querySelectorAll(\n         `${COUNT_SELECTOR}[data-coral-ref='${data.ref}']`\n       );\n+\n+      // Create the element enhancer. This helps when we\n+      const enhance = createCountElementEnhancer(data);\n+\n+      // For each of the found elements, enhance the element with the count\n+      // data.\n       Array.prototype.forEach.call(elements, (element: HTMLElement) => {\n-        element.innerHTML = data.html;\n-\n-        // Because this involves a new field being added to the JSONP response,\n-        // we check that the field is available and is a number before we add\n-        // it.\n-        // TODO: (wyattjoh) remove after 6.3.1\n-        if (data.count !== undefined && typeof data.count === \"number\") {\n-          element.dataset.coralCount = data.count.toString();\n-        }\n+        enhance(element);\n       });\n     },\n     getCount,"
    },
    {
      "sha": "bc9c8786465426ec8e5abee75a905933c640b1cb",
      "filename": "src/core/client/embed/story.html",
      "status": "modified",
      "additions": 4,
      "deletions": 5,
      "changes": 9,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/embed/story.html",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/embed/story.html",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/embed/story.html?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -12,15 +12,14 @@\n       }\n     </style>\n   </head>\n-\n   <body>\n-    <p style=\"text-align: center\">\n+    <p style=\"text-align: center;\">\n       <a href=\"/admin\">Admin</a> | <a href=\"/\">Default</a> |\n       <a href=\"/storyButton.html\">Story With Button</a>\n     </p>\n-    <h1 style=\"text-align: center\">Coral 5.0 – Story</h1>\n+    <h1 style=\"text-align: center;\">Coral 5.0 – Story</h1>\n     <p>\n-      <a href=\"#coralStreamEmbed\"><span class=\"coral-count\"></span></a>&nbsp;\n+      <a href=\"#coralStreamEmbed\" class=\"coral-count\">Comments</a>\n     </p>\n     <p>\n       Dismember a mouse and then regurgitate parts of it on the family room\n@@ -119,7 +118,7 @@ <h1 style=\"text-align: center\">Coral 5.0 – Story</h1>\n       check on human, have not seen in an hour might be dead oh look, human is\n       alive, hiss at human, feed me.\n     </p>\n-    <div id=\"coralStreamEmbed\" style=\"max-width: 640px; margin: 0 auto\"></div>\n+    <div id=\"coralStreamEmbed\" style=\"max-width: 640px; margin: 0 auto;\"></div>\n     <script>\n       const CoralStreamEmbed = Coral.createStreamEmbed({\n         id: \"coralStreamEmbed\","
    },
    {
      "sha": "48ee1de42191fb40055fbcdf6567992ad203751d",
      "filename": "src/core/client/embed/storyButton.html",
      "status": "modified",
      "additions": 25,
      "deletions": 7,
      "changes": 32,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/embed/storyButton.html",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/embed/storyButton.html",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/embed/storyButton.html?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -10,17 +10,35 @@\n         margin: 0;\n         padding: 0 100px 50px 100px;\n       }\n+\n+      .coral-count {\n+        background-color: coral;\n+        color: white;\n+        padding: 5px;\n+        text-decoration: none;\n+        margin: 0;\n+        font-family: sans-serif;\n+        font-size: 0.75em;\n+      }\n+\n+      .coral-new-count-number,\n+      .coral-new-count-text {\n+        font-weight: bold;\n+      }\n+\n+      .coral-count[data-coral-count=\"0\"] .coral-count-number {\n+        display: none;\n+      }\n     </style>\n   </head>\n-\n   <body>\n-    <p style=\"text-align: center\">\n+    <p style=\"text-align: center;\">\n       <a href=\"/admin\">Admin</a> | <a href=\"/\">Default</a> |\n       <a href=\"/story.html\">Story</a>\n     </p>\n-    <h1 style=\"text-align: center\">Coral 5.0 – Story with Button</h1>\n+    <h1 style=\"text-align: center;\">Coral 5.0 – Story with Button</h1>\n     <p>\n-      <a href=\"#coralStreamEmbed\"><span class=\"coral-count\"></span></a>&nbsp;\n+      <a href=\"#coralStreamEmbed\" class=\"coral-count\">Comments</a>\n     </p>\n     <p>\n       Dismember a mouse and then regurgitate parts of it on the family room\n@@ -119,8 +137,8 @@ <h1 style=\"text-align: center\">Coral 5.0 – Story with Button</h1>\n       check on human, have not seen in an hour might be dead oh look, human is\n       alive, hiss at human, feed me.\n     </p>\n-    <div id=\"coralStreamEmbed\" style=\"max-width: 640px; margin: 0 auto\"></div>\n-    <div style=\"text-align: center\">\n+    <div id=\"coralStreamEmbed\" style=\"max-width: 640px; margin: 0 auto;\"></div>\n+    <div style=\"text-align: center;\">\n       <button id=\"showComments\">Show Comments</button>\n     </div>\n     <script>\n@@ -131,7 +149,7 @@ <h1 style=\"text-align: center\">Coral 5.0 – Story with Button</h1>\n \n       const button = document.getElementById(\"showComments\");\n \n-      const showStreamEmbed = function() {\n+      const showStreamEmbed = function () {\n         CoralStreamEmbed.render();\n         button.parentElement.removeChild(button);\n       };"
    },
    {
      "sha": "3b2adcc074db86375cc4594ae7895332f54b8094",
      "filename": "src/core/client/framework/helpers/getPreviousCountStorageKey.ts",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/framework/helpers/getPreviousCountStorageKey.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/framework/helpers/getPreviousCountStorageKey.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/framework/helpers/getPreviousCountStorageKey.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -0,0 +1,3 @@\n+export default function getPreviousCountStorageKey(storyID: string): string {\n+  return `v1:previousCount:${storyID}`;\n+}"
    },
    {
      "sha": "fb0c3c02420286f7211fbb2ef52ad9a2fd6e9fbd",
      "filename": "src/core/client/stream/tabs/Comments/GiphyInput/GifSearchFetch.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/GiphyInput/GifSearchFetch.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/GiphyInput/GifSearchFetch.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/GiphyInput/GifSearchFetch.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,6 +1,6 @@\n import { Environment } from \"relay-runtime\";\n \n-import { GiphyGifSearchResponse } from \"coral-common/rest/external/giphy\";\n+import { GiphyGifSearchResponse } from \"coral-common/types/giphy\";\n import { createFetch, FetchVariables } from \"coral-framework/lib/relay\";\n \n export const GIF_RESULTS_LIMIT = 10;"
    },
    {
      "sha": "b8b09c1f8a2f6f81d0e9b3e7e774ff104727d03c",
      "filename": "src/core/client/stream/tabs/Comments/GiphyInput/GiphyInput.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/GiphyInput/GiphyInput.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/GiphyInput/GiphyInput.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/GiphyInput/GiphyInput.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -8,7 +8,7 @@ import React, {\n   useState,\n } from \"react\";\n \n-import { GiphyGif } from \"coral-common/rest/external/giphy\";\n+import { GiphyGif } from \"coral-common/types/giphy\";\n import { useFetch } from \"coral-framework/lib/relay\";\n import {\n   BaseButton,"
    },
    {
      "sha": "f1008ef6c93bb7d74b4f833f38cd9f3b2d997e05",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/CommentReplyCreatedSubscription.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/CommentReplyCreatedSubscription.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/CommentReplyCreatedSubscription.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/CommentReplyCreatedSubscription.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -81,8 +81,9 @@ const CommentReplyCreatedSubscription = createSubscription(\n           // could not trace back to ancestor, discard.\n           return;\n         }\n+\n         // Comment is just outside our visible depth.\n-        if (depth === 4) {\n+        if (depth >= 4) {\n           // Inform last comment in visible tree about the available replies.\n           // This will trigger to show the `Read More of this Conversation` link.\n           const replyCount = parentProxy.getValue(\"replyCount\") || 0;"
    },
    {
      "sha": "fcc7db2ae12809b8652c09775ace7047f7cf318a",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/ReplyList.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyList.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyList.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/ReplyList.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -112,7 +112,7 @@ const ReplyList: FunctionComponent<ReplyListProps> = (props) => {\n           </Localized>\n         </Indent>\n       )}\n-      {Boolean(props.viewNewCount && props.viewNewCount > 0) && (\n+      {!!props.viewNewCount && (\n         <Indent level={props.indentLevel} noBorder>\n           <Localized id=\"comments-replyList-showMoreReplies\">\n             <Button"
    },
    {
      "sha": "570cf41f6f8c61e34da73c52634e0ee2ad07ef60",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.spec.tsx",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.spec.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -19,6 +19,7 @@ jest.spyOn(React, \"useContext\").mockImplementation(() => context);\n it(\"renders correctly\", () => {\n   const props: PropTypesOf<typeof ReplyListContainerN> = {\n     story: {\n+      id: \"story-id\",\n       closedAt: null,\n       isClosed: false,\n       settings: { live: { enabled: true } },\n@@ -57,6 +58,7 @@ it(\"renders correctly\", () => {\n it(\"renders correctly when replies are empty\", () => {\n   const props: PropTypesOf<typeof ReplyListContainerN> = {\n     story: {\n+      id: \"story-id\",\n       isClosed: false,\n       closedAt: null,\n       settings: {\n@@ -94,6 +96,7 @@ describe(\"when has more replies\", () => {\n   let finishLoading: ((error?: Error) => void) | null = null;\n   const props: PropTypesOf<typeof ReplyListContainerN> = {\n     story: {\n+      id: \"story-id\",\n       isClosed: false,\n       closedAt: null,\n       settings: {"
    },
    {
      "sha": "4eaf6d9ec322f927e9187089c4b47e9a8201e4dd",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.tsx",
      "status": "modified",
      "additions": 13,
      "deletions": 9,
      "changes": 22,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/ReplyListContainer.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -76,12 +76,16 @@ export const ReplyListContainer: React.FunctionComponent<Props> = (props) => {\n     }\n   }, [showAll, beginShowAllEvent, props.comment.id]);\n \n-  const subcribeToCommentReplyCreated = useSubscription(\n+  const subscribeToCommentReplyCreated = useSubscription(\n     CommentReplyCreatedSubscription\n   );\n \n   const live = useLive(props);\n   useEffect(() => {\n+    if (props.indentLevel !== 1) {\n+      return;\n+    }\n+\n     // If the comment is pending, no need to subscribe the comment!\n     if (props.comment.pending) {\n       return;\n@@ -92,11 +96,7 @@ export const ReplyListContainer: React.FunctionComponent<Props> = (props) => {\n       return;\n     }\n \n-    if (props.indentLevel !== 1) {\n-      return;\n-    }\n-\n-    const disposable = subcribeToCommentReplyCreated({\n+    const disposable = subscribeToCommentReplyCreated({\n       ancestorID: props.comment.id,\n       liveDirectRepliesInsertion: props.liveDirectRepliesInsertion,\n     });\n@@ -106,7 +106,7 @@ export const ReplyListContainer: React.FunctionComponent<Props> = (props) => {\n     };\n   }, [\n     live,\n-    subcribeToCommentReplyCreated,\n+    subscribeToCommentReplyCreated,\n     props.comment.id,\n     props.indentLevel,\n     props.comment.pending,\n@@ -115,8 +115,8 @@ export const ReplyListContainer: React.FunctionComponent<Props> = (props) => {\n \n   const viewNew = useMutation(ReplyListViewNewMutation);\n   const onViewNew = useCallback(() => {\n-    void viewNew({ commentID: props.comment.id });\n-  }, [props.comment.id, viewNew]);\n+    void viewNew({ commentID: props.comment.id, storyID: props.story.id });\n+  }, [props.comment.id, props.story.id, viewNew]);\n \n   const viewNewCount =\n     (props.comment.replies.viewNewEdges &&\n@@ -237,6 +237,7 @@ const ReplyListContainer3 = createReplyListContainer(\n     `,\n     story: graphql`\n       fragment ReplyListContainer3_story on Story {\n+        id\n         isClosed\n         closedAt\n         settings {\n@@ -304,6 +305,7 @@ const ReplyListContainer3 = createReplyListContainer(\n   LastReplyList,\n   true\n );\n+\n const ReplyListContainer2 = createReplyListContainer(\n   2,\n   {\n@@ -325,6 +327,7 @@ const ReplyListContainer2 = createReplyListContainer(\n     `,\n     story: graphql`\n       fragment ReplyListContainer2_story on Story {\n+        id\n         isClosed\n         closedAt\n         settings {\n@@ -411,6 +414,7 @@ const ReplyListContainer1 = createReplyListContainer(\n     `,\n     story: graphql`\n       fragment ReplyListContainer1_story on Story {\n+        id\n         isClosed\n         closedAt\n         settings {"
    },
    {
      "sha": "d9eb6c69597b33b091bf242b46475b0896339591",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/ReplyListViewNewMutation.tsx",
      "status": "modified",
      "additions": 10,
      "deletions": 4,
      "changes": 14,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListViewNewMutation.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/ReplyListViewNewMutation.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/ReplyListViewNewMutation.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -6,16 +6,18 @@ import {\n   createMutation,\n } from \"coral-framework/lib/relay\";\n import { ShowMoreRepliesEvent } from \"coral-stream/events\";\n+import { incrementStoryCommentCounts } from \"../helpers\";\n \n-interface ReplyListViewNewInput {\n+interface ReplyListViewNewMutationInput {\n+  storyID: string;\n   commentID: string;\n }\n \n-const QueueViewNewMutation = createMutation(\n+const ReplyListViewNewMutation = createMutation(\n   \"viewNew\",\n   async (\n     environment: Environment,\n-    input: ReplyListViewNewInput,\n+    input: ReplyListViewNewMutationInput,\n     { eventEmitter }: CoralContext\n   ) => {\n     await commitLocalUpdatePromisified(environment, async (store) => {\n@@ -42,6 +44,10 @@ const QueueViewNewMutation = createMutation(\n       viewNewEdges.forEach((edge) => {\n         ConnectionHandler.insertEdgeAfter(connection, edge);\n       });\n+\n+      // Increment the count.\n+      incrementStoryCommentCounts(store, input.storyID, viewNewEdges.length);\n+\n       connection.setLinkedRecords([], \"viewNewEdges\");\n       ShowMoreRepliesEvent.emit(eventEmitter, {\n         commentID: input.commentID,\n@@ -51,4 +57,4 @@ const QueueViewNewMutation = createMutation(\n   }\n );\n \n-export default QueueViewNewMutation;\n+export default ReplyListViewNewMutation;"
    },
    {
      "sha": "d4509ed01acd9436a1706a62c8695af48cedd016",
      "filename": "src/core/client/stream/tabs/Comments/ReplyList/__snapshots__/ReplyListContainer.spec.tsx.snap",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/__snapshots__/ReplyListContainer.spec.tsx.snap",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/ReplyList/__snapshots__/ReplyListContainer.spec.tsx.snap",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/ReplyList/__snapshots__/ReplyListContainer.spec.tsx.snap?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -49,6 +49,7 @@ exports[`renders correctly 1`] = `\n           story={\n             Object {\n               \"closedAt\": null,\n+              \"id\": \"story-id\",\n               \"isClosed\": false,\n               \"settings\": Object {\n                 \"live\": Object {\n@@ -81,6 +82,7 @@ exports[`renders correctly 1`] = `\n           story={\n             Object {\n               \"closedAt\": null,\n+              \"id\": \"story-id\",\n               \"isClosed\": false,\n               \"settings\": Object {\n                 \"live\": Object {\n@@ -110,6 +112,7 @@ exports[`renders correctly 1`] = `\n   story={\n     Object {\n       \"closedAt\": null,\n+      \"id\": \"story-id\",\n       \"isClosed\": false,\n       \"settings\": Object {\n         \"live\": Object {\n@@ -184,6 +187,7 @@ exports[`when has more replies renders hasMore 1`] = `\n   story={\n     Object {\n       \"closedAt\": null,\n+      \"id\": \"story-id\",\n       \"isClosed\": false,\n       \"settings\": Object {\n         \"live\": Object {\n@@ -256,6 +260,7 @@ exports[`when has more replies when showing all disables show all button 1`] = `\n   story={\n     Object {\n       \"closedAt\": null,\n+      \"id\": \"story-id\",\n       \"isClosed\": false,\n       \"settings\": Object {\n         \"live\": Object {\n@@ -328,6 +333,7 @@ exports[`when has more replies when showing all enable show all button after loa\n   story={\n     Object {\n       \"closedAt\": null,\n+      \"id\": \"story-id\",\n       \"isClosed\": false,\n       \"settings\": Object {\n         \"live\": Object {"
    },
    {
      "sha": "bff577722f8bee70002651bc7c19abd729bd7d2f",
      "filename": "src/core/client/stream/tabs/Comments/Stream/AllCommentsTab/AllCommentsTabViewNewMutation.tsx",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/AllCommentsTab/AllCommentsTabViewNewMutation.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/AllCommentsTab/AllCommentsTabViewNewMutation.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/AllCommentsTab/AllCommentsTabViewNewMutation.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -7,6 +7,7 @@ import {\n } from \"coral-framework/lib/relay\";\n import { GQLCOMMENT_SORT } from \"coral-framework/schema\";\n import { ViewNewCommentsEvent } from \"coral-stream/events\";\n+import { incrementStoryCommentCounts } from \"../../helpers\";\n \n interface Input {\n   storyID: string;\n@@ -34,9 +35,15 @@ const AllCommentsTabViewNewMutation = createMutation(\n       if (!viewNewEdges || viewNewEdges.length === 0) {\n         return;\n       }\n+\n+      // Insert new edges into the view.\n       viewNewEdges.forEach((edge) => {\n         ConnectionHandler.insertEdgeBefore(connection, edge);\n       });\n+\n+      // Increment the count.\n+      incrementStoryCommentCounts(store, input.storyID, viewNewEdges.length);\n+\n       ViewNewCommentsEvent.emit(eventEmitter, {\n         storyID: input.storyID,\n         count: viewNewEdges.length,"
    },
    {
      "sha": "6ca2d3863379090ff520e40ba55dcdbfa1485cfd",
      "filename": "src/core/client/stream/tabs/Comments/Stream/CommentForm/MediaField.tsx",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/CommentForm/MediaField.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/CommentForm/MediaField.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/CommentForm/MediaField.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -2,7 +2,7 @@ import React, { FunctionComponent, useCallback, useEffect } from \"react\";\n import { useField } from \"react-final-form\";\n \n import { isMediaLink, MediaLink } from \"coral-common/helpers/findMediaLinks\";\n-import { GiphyGif } from \"coral-common/rest/external/giphy\";\n+import { GiphyGif } from \"coral-common/types/giphy\";\n import { Icon } from \"coral-ui/components/v2\";\n import { CallOut } from \"coral-ui/components/v3\";\n "
    },
    {
      "sha": "b060ebb2f902dcfcf0aafefbb079987d35f5672d",
      "filename": "src/core/client/stream/tabs/Comments/Stream/PreviousCountSpyContainer.tsx",
      "status": "added",
      "additions": 99,
      "deletions": 0,
      "changes": 99,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/PreviousCountSpyContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/PreviousCountSpyContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/PreviousCountSpyContainer.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -0,0 +1,99 @@\n+import { FunctionComponent, useEffect } from \"react\";\n+import { graphql } from \"react-relay\";\n+\n+import getPreviousCountStorageKey from \"coral-framework/helpers/getPreviousCountStorageKey\";\n+import { useCoralContext } from \"coral-framework/lib/bootstrap\";\n+import { withFragmentContainer } from \"coral-framework/lib/relay\";\n+import { GQLFEATURE_FLAG } from \"coral-framework/schema\";\n+\n+import { PreviousCountSpyContainer_settings } from \"coral-stream/__generated__/PreviousCountSpyContainer_settings.graphql\";\n+import { PreviousCountSpyContainer_story } from \"coral-stream/__generated__/PreviousCountSpyContainer_story.graphql\";\n+\n+interface Props {\n+  story: PreviousCountSpyContainer_story;\n+  settings: PreviousCountSpyContainer_settings;\n+}\n+\n+const PreviousCountSpyContainer: FunctionComponent<Props> = ({\n+  story,\n+  settings: { featureFlags },\n+}) => {\n+  const { localStorage } = useCoralContext();\n+\n+  // Whenever the all comments count changes, update the value in local storage.\n+  useEffect(() => {\n+    // If the feature is not enabled, then do nothing!\n+    if (!featureFlags.includes(GQLFEATURE_FLAG.NEW_COMMENT_COUNT)) {\n+      return;\n+    }\n+\n+    // key is the key used to store the count in storage.\n+    const key = getPreviousCountStorageKey(story.id);\n+\n+    /**\n+     * remove will remove the item from localStorage.\n+     */\n+    async function remove() {\n+      try {\n+        // Remove the published count from localStorage.\n+        await localStorage.removeItem(key);\n+      } catch (err) {\n+        // eslint-disable-next-line no-console\n+        console.error(err);\n+      }\n+    }\n+\n+    // If the story is closed, then we can't have new comments, so remove the\n+    // entry!\n+    if (story.isClosed) {\n+      void remove();\n+      return;\n+    }\n+\n+    // value is the current comment count as a string to be stored in storage.\n+    const value = story.commentCounts.totalPublished.toString();\n+\n+    /**\n+     * update will take the current published comment count and update it in\n+     * storage.\n+     */\n+    async function update() {\n+      try {\n+        // Set the published count in localStorage.\n+        await localStorage.setItem(key, value);\n+      } catch (err) {\n+        // eslint-disable-next-line no-console\n+        console.error(err);\n+      }\n+    }\n+\n+    void update();\n+  }, [\n+    featureFlags,\n+    localStorage,\n+    story.commentCounts.totalPublished,\n+    story.id,\n+    story.isClosed,\n+  ]);\n+\n+  return null;\n+};\n+\n+const enhanced = withFragmentContainer<Props>({\n+  story: graphql`\n+    fragment PreviousCountSpyContainer_story on Story {\n+      id\n+      isClosed\n+      commentCounts {\n+        totalPublished\n+      }\n+    }\n+  `,\n+  settings: graphql`\n+    fragment PreviousCountSpyContainer_settings on Settings {\n+      featureFlags\n+    }\n+  `,\n+})(PreviousCountSpyContainer);\n+\n+export default enhanced;"
    },
    {
      "sha": "73e8bcf3d20ac5c30b4ec9f62997f374e1411162",
      "filename": "src/core/client/stream/tabs/Comments/Stream/StreamContainer.tsx",
      "status": "modified",
      "additions": 41,
      "deletions": 41,
      "changes": 82,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/StreamContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/Stream/StreamContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/Stream/StreamContainer.tsx?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,11 +1,6 @@\n import { Localized } from \"@fluent/react/compat\";\n import cn from \"classnames\";\n-import React, {\n-  FunctionComponent,\n-  useCallback,\n-  useEffect,\n-  useMemo,\n-} from \"react\";\n+import React, { FunctionComponent, useCallback, useEffect } from \"react\";\n import { graphql } from \"react-relay\";\n \n import { useCoralContext } from \"coral-framework/lib/bootstrap\";\n@@ -53,6 +48,7 @@ import StreamDeletionRequestCalloutContainer from \"./DeleteAccount/StreamDeletio\n import FeaturedComments from \"./FeaturedComments\";\n import FeaturedCommentTooltip from \"./FeaturedCommentTooltip\";\n import { PostCommentFormContainer } from \"./PostCommentForm\";\n+import PreviousCountSpyContainer from \"./PreviousCountSpyContainer\";\n import SortMenu from \"./SortMenu\";\n import StoryClosedTimeoutContainer from \"./StoryClosedTimeout\";\n import { SuspendedInfoContainer } from \"./SuspendedInfo/index\";\n@@ -142,25 +138,23 @@ export const StreamContainer: FunctionComponent<Props> = (props) => {\n     },\n     [local.commentsTab, setLocal, emitSetCommentsTabEvent]\n   );\n-  const banned = Boolean(\n-    props.viewer && props.viewer.status.current.includes(GQLUSER_STATUS.BANNED)\n+\n+  const isBanned = !!props.viewer?.status.current.includes(\n+    GQLUSER_STATUS.BANNED\n   );\n-  const suspended = Boolean(\n-    props.viewer &&\n-      props.viewer.status.current.includes(GQLUSER_STATUS.SUSPENDED)\n+\n+  const isSuspended = !!props.viewer?.status.current.includes(\n+    GQLUSER_STATUS.SUSPENDED\n   );\n \n-  const warned = useMemo(() => {\n-    return Boolean(\n-      props.viewer &&\n-        props.viewer.status.current.includes(GQLUSER_STATUS.WARNED)\n-    );\n-  }, [props.viewer]);\n+  const isWarned = !!props.viewer?.status.current.includes(\n+    GQLUSER_STATUS.WARNED\n+  );\n \n   const allCommentsCount = props.story.commentCounts.totalPublished;\n   const featuredCommentsCount = props.story.commentCounts.tags.FEATURED;\n   const unansweredCommentsCount = props.story.commentCounts.tags.UNANSWERED;\n-  const isQA = Boolean(props.story.settings.mode === GQLSTORY_MODE.QA);\n+  const isQA = props.story.settings.mode === GQLSTORY_MODE.QA;\n \n   // Emit comment count event.\n   useCommentCountEvent(props.story.id, props.story.url, allCommentsCount);\n@@ -189,9 +183,13 @@ export const StreamContainer: FunctionComponent<Props> = (props) => {\n   return (\n     <>\n       <StoryClosedTimeoutContainer story={props.story} />\n+      <PreviousCountSpyContainer\n+        story={props.story}\n+        settings={props.settings}\n+      />\n       <HorizontalGutter\n         className={cn(styles.root, {\n-          [CLASSES.commentsTabPane.authenticated]: Boolean(props.viewer),\n+          [CLASSES.commentsTabPane.authenticated]: !!props.viewer,\n           [CLASSES.commentsTabPane.unauthenticated]: !props.viewer,\n         })}\n         size=\"double\"\n@@ -212,7 +210,7 @@ export const StreamContainer: FunctionComponent<Props> = (props) => {\n           <StreamDeletionRequestCalloutContainer viewer={props.viewer} />\n         )}\n         <CommunityGuidelinesContainer settings={props.settings} />\n-        {!banned && !suspended && !warned && (\n+        {!isBanned && !isSuspended && !isWarned && (\n           <PostCommentFormContainer\n             settings={props.settings}\n             story={props.story}\n@@ -222,16 +220,16 @@ export const StreamContainer: FunctionComponent<Props> = (props) => {\n             commentsOrderBy={local.commentsOrderBy}\n           />\n         )}\n-        {(banned || warned || suspended) && (\n+        {(isBanned || isWarned || isSuspended) && (\n           <div id={VIEWER_STATUS_CONTAINER_ID}>\n-            {banned && <BannedInfo />}\n-            {suspended && (\n+            {isBanned && <BannedInfo />}\n+            {isSuspended && (\n               <SuspendedInfoContainer\n                 viewer={props.viewer}\n                 settings={props.settings}\n               />\n             )}\n-            {warned && <WarningContainer viewer={props.viewer} />}\n+            {isWarned && <WarningContainer viewer={props.viewer} />}\n           </div>\n         )}\n         <IntersectionProvider>\n@@ -424,12 +422,6 @@ export const StreamContainer: FunctionComponent<Props> = (props) => {\n const enhanced = withFragmentContainer<Props>({\n   story: graphql`\n     fragment StreamContainer_story on Story {\n-      ...PostCommentFormContainer_story\n-      ...StoryClosedTimeoutContainer_story\n-      ...CreateCommentReplyMutation_story\n-      ...CreateCommentMutation_story\n-      ...ModerateStreamContainer_story\n-      ...ViewersWatchingContainer_story\n       id\n       url\n       settings {\n@@ -442,34 +434,42 @@ const enhanced = withFragmentContainer<Props>({\n           UNANSWERED\n         }\n       }\n+      ...CreateCommentMutation_story\n+      ...CreateCommentReplyMutation_story\n+      ...ModerateStreamContainer_story\n+      ...PostCommentFormContainer_story\n+      ...PreviousCountSpyContainer_story\n+      ...StoryClosedTimeoutContainer_story\n+      ...ViewersWatchingContainer_story\n     }\n   `,\n   viewer: graphql`\n     fragment StreamContainer_viewer on User {\n-      ...UserBoxContainer_viewer\n-      ...CreateCommentReplyMutation_viewer\n+      status {\n+        current\n+      }\n       ...CreateCommentMutation_viewer\n+      ...CreateCommentReplyMutation_viewer\n+      ...ModerateStreamContainer_viewer\n       ...PostCommentFormContainer_viewer\n-      ...SuspendedInfoContainer_viewer\n       ...StreamDeletionRequestCalloutContainer_viewer\n-      ...ModerateStreamContainer_viewer\n+      ...SuspendedInfoContainer_viewer\n+      ...UserBoxContainer_viewer\n       ...WarningContainer_viewer\n-      status {\n-        current\n-      }\n     }\n   `,\n   settings: graphql`\n     fragment StreamContainer_settings on Settings {\n       reaction {\n         sortLabel\n       }\n-      ...PostCommentFormContainer_settings\n-      ...UserBoxContainer_settings\n-      ...CommunityGuidelinesContainer_settings\n-      ...SuspendedInfoContainer_settings\n       ...AnnouncementContainer_settings\n+      ...CommunityGuidelinesContainer_settings\n       ...ModerateStreamContainer_settings\n+      ...PostCommentFormContainer_settings\n+      ...PreviousCountSpyContainer_settings\n+      ...SuspendedInfoContainer_settings\n+      ...UserBoxContainer_settings\n       ...ViewersWatchingContainer_settings\n     }\n   `,"
    },
    {
      "sha": "045b0037db43f1c706cb06b36872295e543f9adc",
      "filename": "src/core/client/stream/tabs/Comments/helpers/incrementStoryCommentCounts.ts",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/helpers/incrementStoryCommentCounts.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/client/stream/tabs/Comments/helpers/incrementStoryCommentCounts.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/stream/tabs/Comments/helpers/incrementStoryCommentCounts.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,8 +1,9 @@\n-import { RecordSourceSelectorProxy } from \"relay-runtime\";\n+import { RecordSourceProxy } from \"relay-runtime\";\n \n export default function incrementStoryCommentCounts(\n-  store: RecordSourceSelectorProxy,\n-  storyID: string\n+  store: RecordSourceProxy,\n+  storyID: string,\n+  increment = 1\n ) {\n   // Updating Comment Count\n   const story = store.get(storyID);\n@@ -11,7 +12,7 @@ export default function incrementStoryCommentCounts(\n     if (record) {\n       // TODO: when we have moderation, we'll need to be careful here.\n       const currentCount = record.getValue(\"totalPublished\");\n-      record.setValue((currentCount as number) + 1, \"totalPublished\");\n+      record.setValue((currentCount as number) + increment, \"totalPublished\");\n     }\n   }\n }"
    },
    {
      "sha": "bfabbbb38ea75153e22af552d461d01a0d7fc6e6",
      "filename": "src/core/common/types/count.ts",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/count.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/count.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/types/count.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -0,0 +1,11 @@\n+export interface CountJSONPData {\n+  ref: string;\n+  html: string;\n+  count: number;\n+  id?: string | null;\n+}\n+\n+export interface PreviousCountData {\n+  count: number;\n+  expiresAt: number;\n+}"
    },
    {
      "sha": "cb2c6ef958409b9faed02705d2fa723a2cb0298b",
      "filename": "src/core/common/types/dashboard.ts",
      "status": "renamed",
      "additions": 0,
      "deletions": 0,
      "changes": 0,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/dashboard.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/dashboard.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/types/dashboard.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "previous_filename": "src/core/common/rest/dashboard/types.ts"
    },
    {
      "sha": "e052b3de570478f87e6b1e2705e6b36b09e9d418",
      "filename": "src/core/common/types/giphy.ts",
      "status": "renamed",
      "additions": 0,
      "deletions": 0,
      "changes": 0,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/giphy.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/giphy.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/types/giphy.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "previous_filename": "src/core/common/rest/external/giphy.ts"
    },
    {
      "sha": "30f2c48821687390ad1b990fa6c793b7ed8f6d3d",
      "filename": "src/core/common/types/index.ts",
      "status": "renamed",
      "additions": 0,
      "deletions": 0,
      "changes": 0,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/index.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/common/types/index.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/common/types/index.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "previous_filename": "src/core/common/types.ts"
    },
    {
      "sha": "bd71115ca975388b80a3e72197f1eed7d68add7a",
      "filename": "src/core/server/app/handlers/api/dashboard/index.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/app/handlers/api/dashboard/index.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/app/handlers/api/dashboard/index.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/app/handlers/api/dashboard/index.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -2,7 +2,7 @@ import {\n   TimeSeriesMetricsJSON,\n   TodayMetricsJSON,\n   TodayStoriesMetricsJSON,\n-} from \"coral-common/rest/dashboard/types\";\n+} from \"coral-common/types/dashboard\";\n import { AppOptions } from \"coral-server/app\";\n import { calculateTotalCommentCount } from \"coral-server/models/comment\";\n import {"
    },
    {
      "sha": "51a9844df709993a206a945d310c7693ff146beb",
      "filename": "src/core/server/app/handlers/api/story/count.ts",
      "status": "modified",
      "additions": 7,
      "deletions": 4,
      "changes": 11,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/app/handlers/api/story/count.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/app/handlers/api/story/count.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/app/handlers/api/story/count.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -1,5 +1,6 @@\n import Joi from \"@hapi/joi\";\n \n+import { CountJSONPData } from \"coral-common/types/count\";\n import { AppOptions } from \"coral-server/app\";\n import { validate } from \"coral-server/app/request/body\";\n import { calculateTotalPublishedCommentCount } from \"coral-server/models/comment\";\n@@ -78,13 +79,15 @@ export const countHandler = ({\n       );\n     }\n \n-    // Respond using jsonp.\n-    res.jsonp({\n-      // Reference from the client that we'll just send back as it is.\n+    const data: CountJSONPData = {\n       ref,\n       html,\n       count,\n-    });\n+      id: story?.id || null,\n+    };\n+\n+    // Respond using jsonp.\n+    res.jsonp(data);\n   } catch (err) {\n     return next(err);\n   }"
    },
    {
      "sha": "3fd05924fe37854af1fc6ef7a2e789e21601bbc1",
      "filename": "src/core/server/graph/resolvers/Settings.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/graph/resolvers/Settings.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/graph/resolvers/Settings.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/graph/resolvers/Settings.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -27,6 +27,7 @@ const PUBLIC_FEATURE_FLAGS = [\n   GQLFEATURE_FLAG.DISCUSSIONS,\n   GQLFEATURE_FLAG.READ_MORE_NEW_TAB,\n   GQLFEATURE_FLAG.AVATARS,\n+  GQLFEATURE_FLAG.NEW_COMMENT_COUNT,\n ];\n \n type FlagFilter = (flag: GQLFEATURE_FLAG | string) => boolean;"
    },
    {
      "sha": "69312c77ad8d7a6bbf9048911e7513696efed0fc",
      "filename": "src/core/server/graph/schema/schema.graphql",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/graph/schema/schema.graphql",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/graph/schema/schema.graphql",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/graph/schema/schema.graphql?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -425,6 +425,11 @@ enum FEATURE_FLAG {\n   \"\"\"\n   AVATARS\n \n+  \"\"\"\n+  NEW_COMMENT_COUNT enables the comment count update feature.\n+  \"\"\"\n+  NEW_COMMENT_COUNT\n+\n   \"\"\"\n   EXTERNAL_MEDIA enables embedding external images\n   \"\"\""
    },
    {
      "sha": "b3c8e179008a3bdbd405547cb1451f691b4ccf4b",
      "filename": "src/core/server/queue/tasks/mailer/processor.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 7,
      "changes": 8,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/queue/tasks/mailer/processor.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/queue/tasks/mailer/processor.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/queue/tasks/mailer/processor.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -9,7 +9,6 @@ import {\n   SMTPClient,\n   SMTPConnectionOptions,\n } from \"emailjs\";\n-import { minify } from \"html-minifier\";\n import htmlToText from \"html-to-text\";\n import { JSDOM } from \"jsdom\";\n import { juiceResources } from \"juice\";\n@@ -82,12 +81,7 @@ export function juiceHTML(input: string) {\n           return reject(err);\n         }\n \n-        return resolve(\n-          minify(html, {\n-            removeComments: true,\n-            collapseWhitespace: true,\n-          })\n-        );\n+        return resolve(html);\n       }\n     );\n   });"
    },
    {
      "sha": "6132dcb6cf5fc3d798263bdab760c0bb15477add",
      "filename": "src/core/server/services/giphy/giphy.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/services/giphy/giphy.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce/src/core/server/services/giphy/giphy.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/services/giphy/giphy.ts?ref=5e5f17c039c6f408c8d154c9ff4352b2a72eb4ce",
      "patch": "@@ -6,7 +6,7 @@ import { LanguageCode } from \"coral-common/helpers\";\n import {\n   GiphyGifRetrieveResponse,\n   GiphyGifSearchResponse,\n-} from \"coral-common/rest/external/giphy\";\n+} from \"coral-common/types/giphy\";\n import { InternalError } from \"coral-server/errors\";\n import { validateSchema } from \"coral-server/helpers\";\n import { supportsMediaType, Tenant } from \"coral-server/models/tenant\";"
    }
  ]
}
