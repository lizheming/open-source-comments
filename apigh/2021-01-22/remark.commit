{
  "sha": "be2f6d0a20e48e8f11c054d7539f969cac261791",
  "node_id": "MDY6Q29tbWl0MTE0ODI5NTAzOmJlMmY2ZDBhMjBlNDhlOGYxMWMwNTRkNzUzOWY5NjljYWMyNjE3OTE=",
  "commit": {
    "author": {
      "name": "Umputun",
      "email": "umputun@gmail.com",
      "date": "2021-01-20T19:12:09Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2021-01-20T19:12:09Z"
    },
    "message": "Fix admin names (#858)\n\n* fix admin name check for anon login #605\r\n\r\n* update readme with admin names info\r\n\r\n* lint: list of static site params\r\n\r\n* typo\r\n\r\n* don't allow email users to reuse admin names\r\n\r\n* move admin.names to restricted-names\r\n\r\n* forgotten names member\r\n\r\n* remove names from example admin\r\n\r\n* remove names from prepTestStore",
    "tree": {
      "sha": "2aab93f7eae26b925b1a197e5d3a82bf02f2a4b7",
      "url": "https://api.github.com/repos/umputun/remark42/git/trees/2aab93f7eae26b925b1a197e5d3a82bf02f2a4b7"
    },
    "url": "https://api.github.com/repos/umputun/remark42/git/commits/be2f6d0a20e48e8f11c054d7539f969cac261791",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgCICJCRBK7hj4Ov3rIwAAdHIIAGDVDwIJUF1keiO8t+t1ruNu\nxLIp+3bH8aiXSGCBVfPpYymUZdIUZzMhDSTG4g5KlQa+9b2ZPGYd+No/H+tn+ftP\niocJqjGQ+bTcy5crSbqf7OyKZN64RAX+8pRiu+cD7MQ+i06mSaxlrI/ATXxC3z46\nEfngzvm2TFpCSflIVOvYtPHKWBqAlvkeEMuH/RjR2JQuF5NgqjEMh1UaiG3JxMiZ\nY+GEWQuHnPPvxf3wn8wWIwtqFR2l0heLBmZXMVvNGMq570adXlrZ+DbBVo+9DzJQ\nVIA0IemK+yhxzuuIKrSeOnOwKjHHANqUoOL0sdEsyqn47MePA4IyHWl2iqZKSFw=\n=Sbwu\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 2aab93f7eae26b925b1a197e5d3a82bf02f2a4b7\nparent d40e3542655c183c6cc618721303cad0a9a3259b\nauthor Umputun <umputun@gmail.com> 1611169929 -0600\ncommitter GitHub <noreply@github.com> 1611169929 -0600\n\nFix admin names (#858)\n\n* fix admin name check for anon login #605\r\n\r\n* update readme with admin names info\r\n\r\n* lint: list of static site params\r\n\r\n* typo\r\n\r\n* don't allow email users to reuse admin names\r\n\r\n* move admin.names to restricted-names\r\n\r\n* forgotten names member\r\n\r\n* remove names from example admin\r\n\r\n* remove names from prepTestStore"
    }
  },
  "url": "https://api.github.com/repos/umputun/remark42/commits/be2f6d0a20e48e8f11c054d7539f969cac261791",
  "html_url": "https://github.com/umputun/remark42/commit/be2f6d0a20e48e8f11c054d7539f969cac261791",
  "comments_url": "https://api.github.com/repos/umputun/remark42/commits/be2f6d0a20e48e8f11c054d7539f969cac261791/comments",
  "author": {
    "login": "umputun",
    "id": 535880,
    "node_id": "MDQ6VXNlcjUzNTg4MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/535880?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/umputun",
    "html_url": "https://github.com/umputun",
    "followers_url": "https://api.github.com/users/umputun/followers",
    "following_url": "https://api.github.com/users/umputun/following{/other_user}",
    "gists_url": "https://api.github.com/users/umputun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/umputun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/umputun/subscriptions",
    "organizations_url": "https://api.github.com/users/umputun/orgs",
    "repos_url": "https://api.github.com/users/umputun/repos",
    "events_url": "https://api.github.com/users/umputun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/umputun/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d40e3542655c183c6cc618721303cad0a9a3259b",
      "url": "https://api.github.com/repos/umputun/remark42/commits/d40e3542655c183c6cc618721303cad0a9a3259b",
      "html_url": "https://github.com/umputun/remark42/commit/d40e3542655c183c6cc618721303cad0a9a3259b"
    }
  ],
  "stats": {
    "total": 60,
    "additions": 42,
    "deletions": 18
  },
  "files": [
    {
      "sha": "4f239662bbce993e27621e1adaf7fb523d33ba6a",
      "filename": "README.md",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/README.md",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/README.md",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/README.md?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -110,7 +110,7 @@ _this is the recommended way to run remark42_\n | store.type              | STORE_TYPE              | `bolt`                   | type of storage, `bolt` or `rpc`                |\n | store.bolt.path         | STORE_BOLT_PATH         | `./var`                  | path to data directory                          |\n | store.bolt.timeout      | STORE_BOLT_TIMEOUT      | `30s`                    | boltdb access timeout                           |\n-| admin.shared.id         | ADMIN_SHARED_ID         |                          | admin names (list of user ids), _multi_         |\n+| admin.shared.id         | ADMIN_SHARED_ID         |                          | admin ids (list of user ids), _multi_           |\n | admin.shared.email      | ADMIN_SHARED_EMAIL      | `admin@${REMARK_URL}`    | admin emails, _multi_                           |\n | backup                  | BACKUP_PATH             | `./var/backup`           | backups location                                |\n | max-back                | MAX_BACKUP_FILES        | `10`                     | max backup files to keep                        |\n@@ -184,6 +184,7 @@ _this is the recommended way to run remark42_\n | critical-score          | CRITICAL_SCORE          | `-10`                    | critical score threshold                        |\n | positive-score          | POSITIVE_SCORE          | `false`                  | restricts comment's score to be only positive   |\n | restricted-words        | RESTRICTED_WORDS        |                          | words banned in comments (can use `*`), _multi_ |\n+| restricted-names        | RESTRICTED_NAMES        |                          | names prohibited to use by the user, _multi_    |\n | edit-time               | EDIT_TIME               | `5m`                     | edit window                                     |\n | read-age                | READONLY_AGE            |                          | read-only age of comments, days                 |\n | image-proxy.http2https  |  IMAGE_PROXY_HTTP2HTTPS | `false`                  | enable http->https proxy for images             |"
    },
    {
      "sha": "2014a67f114da1c323f6cebc6c505bc03ac6df67",
      "filename": "backend/_example/memory_store/go.mod",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/_example/memory_store/go.mod",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/_example/memory_store/go.mod",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/_example/memory_store/go.mod?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -4,9 +4,9 @@ go 1.14\n \n require (\n \tgithub.com/go-pkgz/jrpc v0.2.0\n-\tgithub.com/go-pkgz/lgr v0.7.0\n+\tgithub.com/go-pkgz/lgr v0.10.4\n \tgithub.com/pkg/errors v0.9.1\n-\tgithub.com/stretchr/testify v1.5.1\n+\tgithub.com/stretchr/testify v1.6.1\n \tgithub.com/umputun/go-flags v1.5.1\n \tgithub.com/umputun/remark42/backend v1.6.0\n )"
    },
    {
      "sha": "ba1da07cddd1d606497bb403a0b7057a324d9f2a",
      "filename": "backend/_example/memory_store/go.sum",
      "status": "modified",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/_example/memory_store/go.sum",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/_example/memory_store/go.sum",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/_example/memory_store/go.sum?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -20,6 +20,7 @@ github.com/alicebob/gopher-json v0.0.0-20180125190556-5a6b3ba71ee6/go.mod h1:SGn\n github.com/alicebob/miniredis/v2 v2.11.4/go.mod h1:VL3UDEfAH59bSa7MuHMuFToxkqyHh69s/WUbYlOAuyg=\n github.com/andybalholm/cascadia v1.1.0 h1:BuuO6sSfQNFRu1LppgbD25Hr2vLYW25JvxHs5zzsLTo=\n github.com/andybalholm/cascadia v1.1.0/go.mod h1:GsXiBklL0woXo1j/WYWtSYYC4ouU9PqHO0sqidkEA4Y=\n+github.com/aws/aws-sdk-go v1.34.28/go.mod h1:H7NKnBqNVzoTJpGfLrQkkD+ytBA93eiDYi/+8rV9s48=\n github.com/chzyer/logex v1.1.10/go.mod h1:+Ywpsq7O8HXn0nuIou7OrIPyXbp3wmkHB+jjWRnGsAI=\n github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e/go.mod h1:nSuG5e5PlCu98SY8svDHJxuZscDgtXS6KTTbou5AhLI=\n github.com/chzyer/test v0.0.0-20180213035817-a1ea475d72b1/go.mod h1:Q3SI9o4m/ZMnBNeIyt5eFwwo7qiLfzFZmjNmxjkiQlU=\n@@ -46,19 +47,25 @@ github.com/go-chi/cors v1.1.1/go.mod h1:K2Yje0VW/SJzxiyMYu6iPQYa7hMjQX2i/F491VCh\n github.com/go-chi/render v1.0.1 h1:4/5tis2cKaNdnv9zFLfXzcquC9HbeZgCnxGnKrltBS8=\n github.com/go-chi/render v1.0.1/go.mod h1:pq4Rr7HbnsdaeHagklXub+p6Wd16Af5l9koip1OvJns=\n github.com/go-pkgz/auth v0.11.0/go.mod h1:NzVqlTW0E9JXVdAaWRq81XZjICgHnNaNdUfE3CbS2T4=\n+github.com/go-pkgz/auth v1.14.0/go.mod h1:1GVd61pXZcuJ0ZnOUdCTY08V8SreO7MJtsvEd5/WEWA=\n github.com/go-pkgz/expirable-cache v0.0.3 h1:rTh6qNPp78z0bQE6HDhXBHUwqnV9i09Vm6dksJLXQDc=\n github.com/go-pkgz/expirable-cache v0.0.3/go.mod h1:+IauqN00R2FqNRLCLA+X5YljQJrwB179PfiAoMPlTlQ=\n github.com/go-pkgz/jrpc v0.2.0 h1:CLy/eZyekjraVrxZV18N2R1mYLMJ/nWrgdfyIOGPY/E=\n github.com/go-pkgz/jrpc v0.2.0/go.mod h1:wd8vtQ4CgtCnuqua6x2b1SKIgv0VSOh5Dn0uUITbiUE=\n github.com/go-pkgz/lcw v0.7.1/go.mod h1:3P6g9QrJsDePXEMe42ywO+tW08L17tBJGwIDdI7lZ6g=\n+github.com/go-pkgz/lcw v0.8.1/go.mod h1:Xw0/ZfApATgbjVPYRZO4XHdWyxAjErDWDWJ7TLlw1Vc=\n github.com/go-pkgz/lgr v0.7.0 h1:S/AAPwt/RE9a5mNJskA7dGVp+Dq6SMIW6LYjG3ITxY8=\n github.com/go-pkgz/lgr v0.7.0/go.mod h1:yMgxU+GobMRJgIEbSzDKy/67W18S7qmGx/7BVL5AB8Q=\n+github.com/go-pkgz/lgr v0.10.4 h1:l7qyFjqEZgwRgaQQSEp6tve4A3OU80VrfzpvtEX8ngw=\n+github.com/go-pkgz/lgr v0.10.4/go.mod h1:CD0s1z6EFpIUplV067gitF77tn25JItzwHNKAPqeCF0=\n github.com/go-pkgz/repeater v1.1.3/go.mod h1:hVTavuO5x3Gxnu8zW7d6sQBfAneKV8X2FjU48kGfpKw=\n github.com/go-pkgz/rest v1.5.0 h1:C8SxXcXza4GiUUAn/95iCkvoIrGbS30qpwK19iqlrWQ=\n github.com/go-pkgz/rest v1.5.0/go.mod h1:nQaM3RhSTUAmbBZWY4hfe4buyeC9VckvhoCktiQXJxI=\n github.com/go-pkgz/syncs v1.1.1/go.mod h1:bt9lxWRRJ9vOCMGc8Big8ttjYHLKP88ofj1y38UlaHE=\n github.com/go-redis/redis/v7 v7.2.0/go.mod h1:JDNMw23GTyLNC4GZu9njt15ctBQVn7xjRfnwdHj/Dcg=\n+github.com/go-redis/redis/v7 v7.4.0/go.mod h1:JDNMw23GTyLNC4GZu9njt15ctBQVn7xjRfnwdHj/Dcg=\n github.com/go-session/session v3.1.2+incompatible/go.mod h1:8B3iivBQjrz/JtC68Np2T1yBBLxTan3mn/3OM0CyRt0=\n+github.com/go-sql-driver/mysql v1.5.0/go.mod h1:DCzpHaOWr8IXmIStZouvnhqoel9Qv2LBy8hT2VhHyBg=\n github.com/go-stack/stack v1.8.0/go.mod h1:v0f6uXyyMGvRgIKkXu+yp6POWl0qKG85gN/melR3HDY=\n github.com/gobuffalo/attrs v0.0.0-20190224210810-a9411de4debd/go.mod h1:4duuawTqi2wkkpB4ePgWMaai6/Kc6WEz83bhFwpHzj0=\n github.com/gobuffalo/depgen v0.0.0-20190329151759-d478694a28d3/go.mod h1:3STtPUQYuzV0gBVOY3vy6CfMm/ljR4pABfrTeHNLHUY=\n@@ -89,8 +96,10 @@ github.com/golang/protobuf v1.3.2/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5y\n github.com/golang/snappy v0.0.1/go.mod h1:/XxbfmMg8lxefKM7IXC3fBNl/7bRcc72aCRzEWrmP2Q=\n github.com/gomodule/redigo v1.7.1-0.20190322064113-39e2c31b7ca3/go.mod h1:B4C85qUVwatsJoIUNIfCRsp7qO0iAmpGFZ4EELWSbC4=\n github.com/google/go-cmp v0.2.0/go.mod h1:oXzfMopK8JAjlY9xF4vHSVASa0yLyX7SntLO5aqRK0M=\n+github.com/google/go-cmp v0.5.2/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\n github.com/google/go-querystring v1.0.0/go.mod h1:odCYkC5MyYFN7vkCjXpyrEuKhc/BUO6wN/zVPAxq5ck=\n github.com/google/uuid v1.1.1/go.mod h1:TIyPZe4MgqvfeYDBFedMoGGpEw/LqOeaOT+nhxU+yHo=\n+github.com/google/uuid v1.1.2/go.mod h1:TIyPZe4MgqvfeYDBFedMoGGpEw/LqOeaOT+nhxU+yHo=\n github.com/gopherjs/gopherjs v0.0.0-20181017120253-0766667cb4d1/go.mod h1:wJfORRmW1u3UXTncJ5qlYoELFm8eSnnEO6hX4iZ3EWY=\n github.com/gorilla/feeds v1.1.1/go.mod h1:Nk0jZrvPFZX1OBe5NPiddPw7CfwF6Q9eqzaBbaightA=\n github.com/gorilla/websocket v1.4.1/go.mod h1:YR8l580nyteQvAITg2hZ9XVh4b55+EU/adAjf1fMHhE=\n@@ -102,6 +111,8 @@ github.com/hashicorp/golang-lru v0.5.4/go.mod h1:iADmTwqILo4mZ8BN3D2Q6+9jd8WM5uG\n github.com/hpcloud/tail v1.0.0/go.mod h1:ab1qPbhIpdTxEkNHXyeSf5vhxWSCs/tWer42PpOxQnU=\n github.com/imkira/go-interpol v1.1.0/go.mod h1:z0h2/2T3XF8kyEPpRgJ3kmNv+C43p+I/CoI+jC3w2iA=\n github.com/inconshreveable/mousetrap v1.0.0/go.mod h1:PxqpIevigyE2G7u3NXJIT2ANytuPF1OarO4DADm73n8=\n+github.com/jmespath/go-jmespath v0.4.0/go.mod h1:T8mJZnbsbmF+m6zOOFylbeCJqk5+pHWvzYPziyZiYoo=\n+github.com/jmespath/go-jmespath/internal/testify v1.5.1/go.mod h1:L3OGu8Wl2/fWfCI6z80xFu9LTZmf1ZRjMHUOPmWr69U=\n github.com/joho/godotenv v1.3.0/go.mod h1:7hK45KPybAkOC6peb+G5yklZfMxEjkZhHbwpqxOKXbg=\n github.com/jtolds/gls v4.20.0+incompatible/go.mod h1:QJZ7F/aHp+rZTRtaJ1ow/lLfFfVYBRgL+9YlvaHOwJU=\n github.com/k0kubun/colorstring v0.0.0-20150214042306-9440f1994b88/go.mod h1:3w7q1U84EfirKl04SVQ/s7nPm1ZPhiXd34z40TNz36k=\n@@ -137,6 +148,7 @@ github.com/onsi/ginkgo v1.10.1/go.mod h1:lLunBs/Ym6LB5Z9jYTR76FiuTmxDTDusOGeTQH+\n github.com/onsi/ginkgo v1.10.2/go.mod h1:lLunBs/Ym6LB5Z9jYTR76FiuTmxDTDusOGeTQH+WWjE=\n github.com/onsi/gomega v1.7.0/go.mod h1:ex+gbHU/CVuBBDIJjb2X0qEXbFg53c61hWP/1CpauHY=\n github.com/pelletier/go-toml v1.4.0/go.mod h1:PN7xzY2wHTK0K9p34ErDQMlFxa51Fk0OUruD3k1mMwo=\n+github.com/pelletier/go-toml v1.7.0/go.mod h1:vwGMzjaWMwyfHwgIBhI2YUM4fB6nL6lVAvS1LBMMhTE=\n github.com/pkg/errors v0.8.0/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\n github.com/pkg/errors v0.8.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\n github.com/pkg/errors v0.9.1 h1:FEBLx1zS214owpjy7qsBeixbURkuhQAwrK5UwLGTwt4=\n@@ -151,6 +163,8 @@ github.com/rs/xid v1.2.1 h1:mhH9Nq+C1fY2l1XIpgxIiUOfNpRBYH1kKcr+qfKgjRc=\n github.com/rs/xid v1.2.1/go.mod h1:+uKXf+4Djp6Md1KODXJxgGQPKngRmWyn10oCKFzNHOQ=\n github.com/russross/blackfriday/v2 v2.0.1 h1:lPqVAte+HuHNfhJ/0LC98ESWRz8afy9tM/0RK8m9o+Q=\n github.com/russross/blackfriday/v2 v2.0.1/go.mod h1:+Rmxgy9KzJVeS9/2gXHxylqXiyQDYRxCVz55jmeOWTM=\n+github.com/russross/blackfriday/v2 v2.1.0 h1:JIOH55/0cWyOuilr9/qlrm0BSXldqnqwMsf35Ld67mk=\n+github.com/russross/blackfriday/v2 v2.1.0/go.mod h1:+Rmxgy9KzJVeS9/2gXHxylqXiyQDYRxCVz55jmeOWTM=\n github.com/sergi/go-diff v1.0.0 h1:Kpca3qRNrduNnOQeazBd0ysaKrUJiIuISHxogkT9RPQ=\n github.com/sergi/go-diff v1.0.0/go.mod h1:0CfEIISq7TuYL3j771MWULgwwjU+GofnZX9QAmXWZgo=\n github.com/shurcooL/sanitized_anchor_name v1.0.0 h1:PdmoCO6wvbs+7yrJyMORt4/BmY5IYyJwS/kOiWx8mHo=\n@@ -170,6 +184,8 @@ github.com/stretchr/testify v1.3.0/go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UV\n github.com/stretchr/testify v1.4.0/go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4=\n github.com/stretchr/testify v1.5.1 h1:nOGnQDM7FYENwehXlg/kFVnos3rEvtKTjRvOWSzb6H4=\n github.com/stretchr/testify v1.5.1/go.mod h1:5W2xD1RspED5o8YsWQXVCued0rvSQ+mT+I5cxcmMvtA=\n+github.com/stretchr/testify v1.6.1 h1:hDPOHmpOpP40lSULcqw7IrRb/u7w6RpDC9399XyoNd0=\n+github.com/stretchr/testify v1.6.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\n github.com/tidwall/btree v0.0.0-20170113224114-9876f1454cf0/go.mod h1:huei1BkDWJ3/sLXmO+bsCNELL+Bp2Kks9OLyQFkzvA8=\n github.com/tidwall/buntdb v1.1.0/go.mod h1:Y39xhcDW10WlyYXeLgGftXVbjtM0QP+/kpz8xl9cbzE=\n github.com/tidwall/gjson v1.3.2/go.mod h1:P256ACg0Mn+j1RXIDXoss50DeIABTYK1PULOJHhxOls=\n@@ -195,7 +211,10 @@ github.com/yudai/pp v2.0.1+incompatible/go.mod h1:PuxR/8QJ7cyCkFp/aUDS+JY727OFEZ\n github.com/yuin/gopher-lua v0.0.0-20191220021717-ab39c6098bdb/go.mod h1:gqRgreBUhTSL0GeU64rtZ3Uq3wtjOa/TB2YfrtkCbVQ=\n go.etcd.io/bbolt v1.3.4 h1:hi1bXHMVrlQh6WwxAy+qZCV/SYIlqo+Ushwdpa4tAKg=\n go.etcd.io/bbolt v1.3.4/go.mod h1:G5EMThwa9y8QZGBClrRx5EY+Yw9kAhnjy3bSjsnlVTQ=\n+go.etcd.io/bbolt v1.3.5 h1:XAzx9gjCb0Rxj7EoqcClPD1d5ZBxZJk0jbuoPHenBt0=\n+go.etcd.io/bbolt v1.3.5/go.mod h1:G5EMThwa9y8QZGBClrRx5EY+Yw9kAhnjy3bSjsnlVTQ=\n go.mongodb.org/mongo-driver v1.3.2/go.mod h1:MSWZXKOynuguX+JSvwP8i+58jYCXxbia8HS3gZBapIE=\n+go.mongodb.org/mongo-driver v1.4.4/go.mod h1:WcMNYLx/IlOxLe6JRJiv2uXuCz6zBLndR4SoGjYphSc=\n go.uber.org/goleak v1.0.0/go.mod h1:8a7PlsEVH3e/a/GLqe5IIrQx6GzcnRmZEufDUTk4A7A=\n golang.org/x/crypto v0.0.0-20180904163835-0709b304e793/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4=\n golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w=\n@@ -225,6 +244,7 @@ golang.org/x/sync v0.0.0-20181221193216-37e7f081c4d4/go.mod h1:RxMgew5VJxzue5/jJ\n golang.org/x/sync v0.0.0-20190227155943-e225da77a7e6/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sync v0.0.0-20190412183630-56d357773e84/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n+golang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sys v0.0.0-20180905080454-ebe1bf3edb33/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n golang.org/x/sys v0.0.0-20180909124046-d0be0721c37e/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n golang.org/x/sys v0.0.0-20181107165924-66b7b1311ac8/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n@@ -244,6 +264,7 @@ golang.org/x/sys v0.0.0-20200323222414-85ca7c5b95cd/go.mod h1:h1NjWce9XRLGQEsW7w\n golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\n golang.org/x/text v0.3.2 h1:tW2bmiBqwgJj/UpqtC8EpXEZVYOwU0yG4iWbprSVAcs=\n golang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=\n+golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\n golang.org/x/time v0.0.0-20200416051211-89c76fbcd5d1 h1:NusfzzA6yGQ+ua51ck7E3omNUX/JuqbFSaRGqU8CcLI=\n golang.org/x/time v0.0.0-20200416051211-89c76fbcd5d1/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=\n golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\n@@ -256,6 +277,7 @@ golang.org/x/tools v0.0.0-20190420181800-aa740d480789/go.mod h1:LCzVGOaR6xXOjkQ3\n golang.org/x/tools v0.0.0-20190531172133-b3315ee88b7d/go.mod h1:/rFqwRUd4F7ZHNgwSSTFct+R/Kf4OFW1sUzUTQQTgfc=\n golang.org/x/tools v0.0.0-20191108193012-7d206e10da11/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\n golang.org/x/xerrors v0.0.0-20190717185122-a985d3407aa7/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\n+golang.org/x/xerrors v0.0.0-20191204190536-9bdfabe68543/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\n google.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=\n gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\n gopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\n@@ -269,3 +291,6 @@ gopkg.in/yaml.v2 v2.2.1/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\n gopkg.in/yaml.v2 v2.2.2/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\n gopkg.in/yaml.v2 v2.2.4 h1:/eiJrUcujPVeJ3xlSWaiNi3uSVmDGBK1pDHUHAnao1I=\n gopkg.in/yaml.v2 v2.2.4/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\n+gopkg.in/yaml.v2 v2.2.8/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\n+gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c h1:dUUwHk2QECo/6vqA44rthZ8ie2QXMNeKRTHCNY2nXvo=\n+gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM="
    },
    {
      "sha": "0e233a6fd07a8f613503339f9d5f5a7c578184c4",
      "filename": "backend/app/cmd/server.go",
      "status": "modified",
      "additions": 5,
      "deletions": 8,
      "changes": 13,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/cmd/server.go",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/cmd/server.go",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/app/cmd/server.go?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -72,6 +72,7 @@ type ServerCommand struct {\n \tWebRoot          string        `long:\"web-root\" env:\"REMARK_WEB_ROOT\" default:\"./web\" description:\"web root directory\"`\n \tUpdateLimit      float64       `long:\"update-limit\" env:\"UPDATE_LIMIT\" default:\"0.5\" description:\"updates/sec limit\"`\n \tRestrictedWords  []string      `long:\"restricted-words\" env:\"RESTRICTED_WORDS\" description:\"words prohibited to use in comments\" env-delim:\",\"`\n+\tRestrictedNames  []string      `long:\"restricted-names\" env:\"RESTRICTED_NAMES\" description:\"names prohibited to use by user\" env-delim:\",\"`\n \tEnableEmoji      bool          `long:\"emoji\" env:\"EMOJI\" description:\"enable emoji\"`\n \tSimpleView       bool          `long:\"simpler-view\" env:\"SIMPLE_VIEW\" description:\"minimal comment editor mode\"`\n \tProxyCORS        bool          `long:\"proxy-cors\" env:\"PROXY_CORS\" description:\"disable internal CORS and delegate it to proxy\"`\n@@ -921,16 +922,12 @@ func (s *ServerCommand) makeAuthenticator(ds *service.DataStore, avas avatar.Sto\n \t\t\t\tlog.Printf(\"[WARN] can't read email for %s, %v\", c.User.ID, err)\n \t\t\t}\n \n-\t\t\t// don't allow anonymous with admin's name\n-\t\t\tif strings.HasPrefix(c.User.ID, \"anonymous_\") {\n-\t\t\t\tadmins, err := admns.Admins(c.Audience)\n-\t\t\t\tif err != nil {\n-\t\t\t\t\tlog.Printf(\"[WARN] can't get admins for %s, %v\", c.Audience, err)\n-\t\t\t\t}\n-\t\t\t\tfor _, a := range admins {\n+\t\t\t// don't allow anonymous and email with admin's name\n+\t\t\tif strings.HasPrefix(c.User.ID, \"anonymous_\") || strings.HasPrefix(c.User.ID, \"email_\") {\n+\t\t\t\tfor _, a := range s.RestrictedNames {\n \t\t\t\t\tif strings.EqualFold(strings.TrimSpace(c.User.Name), a) {\n \t\t\t\t\t\tc.User.SetBoolAttr(\"blocked\", true)\n-\t\t\t\t\t\tlog.Printf(\"[INFO] blocked %+v, attempt to impersonate admin\", c.User)\n+\t\t\t\t\t\tlog.Printf(\"[INFO] blocked %+v, attempt to impersonate (restricted names)\", c.User)\n \t\t\t\t\t\tbreak\n \t\t\t\t\t}\n \t\t\t\t}"
    },
    {
      "sha": "931a40cbc03093e690b376b8460ed529e1bfec69",
      "filename": "backend/app/cmd/server_test.go",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/cmd/server_test.go",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/cmd/server_test.go",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/app/cmd/server_test.go?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -672,7 +672,8 @@ func prepServerApp(t *testing.T, fn func(o ServerCommand) ServerCommand) (*serve\n \tcmd.SMTP.TimeOut = time.Second\n \tcmd.UpdateLimit = 10\n \tcmd.Admin.Type = \"shared\"\n-\tcmd.Admin.Shared.Admins = []string{\"umputun\", \"bobuk\"}\n+\tcmd.Admin.Shared.Admins = []string{\"id1\", \"id2\"}\n+\tcmd.RestrictedNames = []string{\"umputun\", \"bobuk\"}\n \tcmd = fn(cmd)\n \n \tos.Remove(cmd.Store.Bolt.Path + \"/remark.db\")"
    },
    {
      "sha": "88ed38ce1303bb5cdacd989476e90f64b547fd88",
      "filename": "backend/app/store/admin/admin.go",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/admin/admin.go",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/admin/admin.go",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/app/store/admin/admin.go?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -37,9 +37,9 @@ type StaticStore struct {\n }\n \n // NewStaticStore makes StaticStore instance with given key\n-func NewStaticStore(key string, sites, admins []string, email string) *StaticStore {\n-\tlog.Printf(\"[DEBUG] admin users %+v, email %s\", admins, email)\n-\treturn &StaticStore{key: key, sites: sites, admins: admins, email: email}\n+func NewStaticStore(key string, sites, adminIDs []string, email string) *StaticStore {\n+\tlog.Printf(\"[DEBUG] admin users %+v, email %s\", adminIDs, email)\n+\treturn &StaticStore{key: key, sites: sites, admins: adminIDs, email: email}\n }\n \n // NewStaticKeyStore is a shortcut for making StaticStore for key consumers only\n@@ -55,7 +55,7 @@ func (s *StaticStore) Key() (key string, err error) {\n \treturn s.key, nil\n }\n \n-// Admins returns static list of admin's ids, the same for all sites\n+// Admins returns static list of admin ids, the same for all sites\n func (s *StaticStore) Admins(string) (ids []string, err error) {\n \treturn s.admins, nil\n }"
    },
    {
      "sha": "ef7f697a2f0f6536921b02620aa9966fb7ab7365",
      "filename": "backend/app/store/admin/admin_test.go",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/admin/admin_test.go",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/admin/admin_test.go",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/app/store/admin/admin_test.go?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -7,7 +7,8 @@ import (\n )\n \n func TestStaticStore_Get(t *testing.T) {\n-\tvar ks Store = NewStaticStore(\"key123\", []string{\"s1\", \"s2\", \"s3\"}, []string{\"123\", \"xyz\"}, \"aa@example.com\")\n+\tvar ks Store = NewStaticStore(\"key123\", []string{\"s1\", \"s2\", \"s3\"},\n+\t\t[]string{\"123\", \"xyz\"}, \"aa@example.com\")\n \n \tk, err := ks.Key()\n \tassert.NoError(t, err, \"valid store\")"
    },
    {
      "sha": "86abd9688cc387f2693ec5341f60145f04d8a249",
      "filename": "backend/app/store/service/service_test.go",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/umputun/remark42/blob/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/service/service_test.go",
      "raw_url": "https://github.com/umputun/remark42/raw/be2f6d0a20e48e8f11c054d7539f969cac261791/backend/app/store/service/service_test.go",
      "contents_url": "https://api.github.com/repos/umputun/remark42/contents/backend/app/store/service/service_test.go?ref=be2f6d0a20e48e8f11c054d7539f969cac261791",
      "patch": "@@ -922,7 +922,6 @@ func TestService_IsAdmin(t *testing.T) {\n \tassert.False(t, b.IsAdmin(\"radio-t\", \"user1\"))\n \tassert.True(t, b.IsAdmin(\"radio-t\", \"user2\"))\n \tassert.False(t, b.IsAdmin(\"radio-t-bad\", \"user1\"))\n-\n }\n \n func TestService_HasReplies(t *testing.T) {"
    }
  ]
}
